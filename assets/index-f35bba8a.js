(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const l of i)if(l.type==="childList")for(const o of l.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function s(i){const l={};return i.integrity&&(l.integrity=i.integrity),i.referrerPolicy&&(l.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?l.credentials="include":i.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function n(i){if(i.ep)return;i.ep=!0;const l=s(i);fetch(i.href,l)}})();/**
* @vue/shared v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function Ao(t){const e=Object.create(null);for(const s of t.split(","))e[s]=1;return s=>s in e}const Le={},xt=[],ct=()=>{},Qr=()=>!1,Gs=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&(t.charCodeAt(2)>122||t.charCodeAt(2)<97),Io=t=>t.startsWith("onUpdate:"),Re=Object.assign,Mo=(t,e)=>{const s=t.indexOf(e);s>-1&&t.splice(s,1)},Zr=Object.prototype.hasOwnProperty,we=(t,e)=>Zr.call(t,e),oe=Array.isArray,es=t=>Ls(t)==="[object Map]",is=t=>Ls(t)==="[object Set]",qo=t=>Ls(t)==="[object Date]",ce=t=>typeof t=="function",Pe=t=>typeof t=="string",ht=t=>typeof t=="symbol",Oe=t=>t!==null&&typeof t=="object",Nn=t=>(Oe(t)||ce(t))&&ce(t.then)&&ce(t.catch),jn=Object.prototype.toString,Ls=t=>jn.call(t),Xr=t=>Ls(t).slice(8,-1),Fn=t=>Ls(t)==="[object Object]",Oo=t=>Pe(t)&&t!=="NaN"&&t[0]!=="-"&&""+parseInt(t,10)===t,gs=Ao(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Ys=t=>{const e=Object.create(null);return s=>e[s]||(e[s]=t(s))},xr=/-(\w)/g,lt=Ys(t=>t.replace(xr,(e,s)=>s?s.toUpperCase():"")),ei=/\B([A-Z])/g,Ht=Ys(t=>t.replace(ei,"-$1").toLowerCase()),qs=Ys(t=>t.charAt(0).toUpperCase()+t.slice(1)),oo=Ys(t=>t?`on${qs(t)}`:""),At=(t,e)=>!Object.is(t,e),Ds=(t,...e)=>{for(let s=0;s<t.length;s++)t[s](...e)},Un=(t,e,s,n=!1)=>{Object.defineProperty(t,e,{configurable:!0,enumerable:!1,writable:n,value:s})},js=t=>{const e=parseFloat(t);return isNaN(e)?t:e},ti=t=>{const e=Pe(t)?Number(t):NaN;return isNaN(e)?t:e};let Qo;const Qs=()=>Qo||(Qo=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function Ot(t){if(oe(t)){const e={};for(let s=0;s<t.length;s++){const n=t[s],i=Pe(n)?ri(n):Ot(n);if(i)for(const l in i)e[l]=i[l]}return e}else if(Pe(t)||Oe(t))return t}const si=/;(?![^(]*\))/g,oi=/:([^]+)/,ni=/\/\*[^]*?\*\//g;function ri(t){const e={};return t.replace(ni,"").split(si).forEach(s=>{if(s){const n=s.split(oi);n.length>1&&(e[n[0].trim()]=n[1].trim())}}),e}function ae(t){let e="";if(Pe(t))e=t;else if(oe(t))for(let s=0;s<t.length;s++){const n=ae(t[s]);n&&(e+=n+" ")}else if(Oe(t))for(const s in t)t[s]&&(e+=s+" ");return e.trim()}const ii="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",li=Ao(ii);function Bn(t){return!!t||t===""}function ai(t,e){if(t.length!==e.length)return!1;let s=!0;for(let n=0;s&&n<t.length;n++)s=zt(t[n],e[n]);return s}function zt(t,e){if(t===e)return!0;let s=qo(t),n=qo(e);if(s||n)return s&&n?t.getTime()===e.getTime():!1;if(s=ht(t),n=ht(e),s||n)return t===e;if(s=oe(t),n=oe(e),s||n)return s&&n?ai(t,e):!1;if(s=Oe(t),n=Oe(e),s||n){if(!s||!n)return!1;const i=Object.keys(t).length,l=Object.keys(e).length;if(i!==l)return!1;for(const o in t){const a=t.hasOwnProperty(o),c=e.hasOwnProperty(o);if(a&&!c||!a&&c||!zt(t[o],e[o]))return!1}}return String(t)===String(e)}function Do(t,e){return t.findIndex(s=>zt(s,e))}const Vn=t=>!!(t&&t.__v_isRef===!0),_=t=>Pe(t)?t:t==null?"":oe(t)||Oe(t)&&(t.toString===jn||!ce(t.toString))?Vn(t)?_(t.value):JSON.stringify(t,Jn,2):String(t),Jn=(t,e)=>Vn(e)?Jn(t,e.value):es(e)?{[`Map(${e.size})`]:[...e.entries()].reduce((s,[n,i],l)=>(s[no(n,l)+" =>"]=i,s),{})}:is(e)?{[`Set(${e.size})`]:[...e.values()].map(s=>no(s))}:ht(e)?no(e):Oe(e)&&!oe(e)&&!Fn(e)?String(e):e,no=(t,e="")=>{var s;return ht(t)?`Symbol(${(s=t.description)!=null?s:e})`:t};/**
* @vue/reactivity v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let st;class ci{constructor(e=!1){this.detached=e,this._active=!0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=st,!e&&st&&(this.index=(st.scopes||(st.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let e,s;if(this.scopes)for(e=0,s=this.scopes.length;e<s;e++)this.scopes[e].pause();for(e=0,s=this.effects.length;e<s;e++)this.effects[e].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let e,s;if(this.scopes)for(e=0,s=this.scopes.length;e<s;e++)this.scopes[e].resume();for(e=0,s=this.effects.length;e<s;e++)this.effects[e].resume()}}run(e){if(this._active){const s=st;try{return st=this,e()}finally{st=s}}}on(){st=this}off(){st=this.parent}stop(e){if(this._active){this._active=!1;let s,n;for(s=0,n=this.effects.length;s<n;s++)this.effects[s].stop();for(this.effects.length=0,s=0,n=this.cleanups.length;s<n;s++)this.cleanups[s]();if(this.cleanups.length=0,this.scopes){for(s=0,n=this.scopes.length;s<n;s++)this.scopes[s].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!e){const i=this.parent.scopes.pop();i&&i!==this&&(this.parent.scopes[this.index]=i,i.index=this.index)}this.parent=void 0}}}function ui(){return st}let Me;const ro=new WeakSet;class Kn{constructor(e){this.fn=e,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,st&&st.active&&st.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,ro.has(this)&&(ro.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||Wn(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,Zo(this),Gn(this);const e=Me,s=ut;Me=this,ut=!0;try{return this.fn()}finally{Yn(this),Me=e,ut=s,this.flags&=-3}}stop(){if(this.flags&1){for(let e=this.deps;e;e=e.nextDep)Ro(e);this.deps=this.depsTail=void 0,Zo(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?ro.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){vo(this)&&this.run()}get dirty(){return vo(this)}}let zn=0,ps,vs;function Wn(t,e=!1){if(t.flags|=8,e){t.next=vs,vs=t;return}t.next=ps,ps=t}function Po(){zn++}function Ho(){if(--zn>0)return;if(vs){let e=vs;for(vs=void 0;e;){const s=e.next;e.next=void 0,e.flags&=-9,e=s}}let t;for(;ps;){let e=ps;for(ps=void 0;e;){const s=e.next;if(e.next=void 0,e.flags&=-9,e.flags&1)try{e.trigger()}catch(n){t||(t=n)}e=s}}if(t)throw t}function Gn(t){for(let e=t.deps;e;e=e.nextDep)e.version=-1,e.prevActiveLink=e.dep.activeLink,e.dep.activeLink=e}function Yn(t){let e,s=t.depsTail,n=s;for(;n;){const i=n.prevDep;n.version===-1?(n===s&&(s=i),Ro(n),di(n)):e=n,n.dep.activeLink=n.prevActiveLink,n.prevActiveLink=void 0,n=i}t.deps=e,t.depsTail=s}function vo(t){for(let e=t.deps;e;e=e.nextDep)if(e.dep.version!==e.version||e.dep.computed&&(qn(e.dep.computed)||e.dep.version!==e.version))return!0;return!!t._dirty}function qn(t){if(t.flags&4&&!(t.flags&16)||(t.flags&=-17,t.globalVersion===bs))return;t.globalVersion=bs;const e=t.dep;if(t.flags|=2,e.version>0&&!t.isSSR&&t.deps&&!vo(t)){t.flags&=-3;return}const s=Me,n=ut;Me=t,ut=!0;try{Gn(t);const i=t.fn(t._value);(e.version===0||At(i,t._value))&&(t._value=i,e.version++)}catch(i){throw e.version++,i}finally{Me=s,ut=n,Yn(t),t.flags&=-3}}function Ro(t,e=!1){const{dep:s,prevSub:n,nextSub:i}=t;if(n&&(n.nextSub=i,t.prevSub=void 0),i&&(i.prevSub=n,t.nextSub=void 0),s.subs===t&&(s.subs=n,!n&&s.computed)){s.computed.flags&=-5;for(let l=s.computed.deps;l;l=l.nextDep)Ro(l,!0)}!e&&!--s.sc&&s.map&&s.map.delete(s.key)}function di(t){const{prevDep:e,nextDep:s}=t;e&&(e.nextDep=s,t.prevDep=void 0),s&&(s.prevDep=e,t.nextDep=void 0)}let ut=!0;const Qn=[];function Rt(){Qn.push(ut),ut=!1}function Nt(){const t=Qn.pop();ut=t===void 0?!0:t}function Zo(t){const{cleanup:e}=t;if(t.cleanup=void 0,e){const s=Me;Me=void 0;try{e()}finally{Me=s}}}let bs=0;class fi{constructor(e,s){this.sub=e,this.dep=s,this.version=s.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class No{constructor(e){this.computed=e,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0}track(e){if(!Me||!ut||Me===this.computed)return;let s=this.activeLink;if(s===void 0||s.sub!==Me)s=this.activeLink=new fi(Me,this),Me.deps?(s.prevDep=Me.depsTail,Me.depsTail.nextDep=s,Me.depsTail=s):Me.deps=Me.depsTail=s,Zn(s);else if(s.version===-1&&(s.version=this.version,s.nextDep)){const n=s.nextDep;n.prevDep=s.prevDep,s.prevDep&&(s.prevDep.nextDep=n),s.prevDep=Me.depsTail,s.nextDep=void 0,Me.depsTail.nextDep=s,Me.depsTail=s,Me.deps===s&&(Me.deps=n)}return s}trigger(e){this.version++,bs++,this.notify(e)}notify(e){Po();try{for(let s=this.subs;s;s=s.prevSub)s.sub.notify()&&s.sub.dep.notify()}finally{Ho()}}}function Zn(t){if(t.dep.sc++,t.sub.flags&4){const e=t.dep.computed;if(e&&!t.dep.subs){e.flags|=20;for(let n=e.deps;n;n=n.nextDep)Zn(n)}const s=t.dep.subs;s!==t&&(t.prevSub=s,s&&(s.nextSub=t)),t.dep.subs=t}}const yo=new WeakMap,Kt=Symbol(""),ho=Symbol(""),$s=Symbol("");function Be(t,e,s){if(ut&&Me){let n=yo.get(t);n||yo.set(t,n=new Map);let i=n.get(s);i||(n.set(s,i=new No),i.map=n,i.key=s),i.track()}}function $t(t,e,s,n,i,l){const o=yo.get(t);if(!o){bs++;return}const a=c=>{c&&c.trigger()};if(Po(),e==="clear")o.forEach(a);else{const c=oe(t),u=c&&Oo(s);if(c&&s==="length"){const d=Number(n);o.forEach((g,p)=>{(p==="length"||p===$s||!ht(p)&&p>=d)&&a(g)})}else switch((s!==void 0||o.has(void 0))&&a(o.get(s)),u&&a(o.get($s)),e){case"add":c?u&&a(o.get("length")):(a(o.get(Kt)),es(t)&&a(o.get(ho)));break;case"delete":c||(a(o.get(Kt)),es(t)&&a(o.get(ho)));break;case"set":es(t)&&a(o.get(Kt));break}}Ho()}function qt(t){const e=$e(t);return e===t?e:(Be(e,"iterate",$s),rt(t)?e:e.map(Ve))}function Zs(t){return Be(t=$e(t),"iterate",$s),t}const gi={__proto__:null,[Symbol.iterator](){return io(this,Symbol.iterator,Ve)},concat(...t){return qt(this).concat(...t.map(e=>oe(e)?qt(e):e))},entries(){return io(this,"entries",t=>(t[1]=Ve(t[1]),t))},every(t,e){return mt(this,"every",t,e,void 0,arguments)},filter(t,e){return mt(this,"filter",t,e,s=>s.map(Ve),arguments)},find(t,e){return mt(this,"find",t,e,Ve,arguments)},findIndex(t,e){return mt(this,"findIndex",t,e,void 0,arguments)},findLast(t,e){return mt(this,"findLast",t,e,Ve,arguments)},findLastIndex(t,e){return mt(this,"findLastIndex",t,e,void 0,arguments)},forEach(t,e){return mt(this,"forEach",t,e,void 0,arguments)},includes(...t){return lo(this,"includes",t)},indexOf(...t){return lo(this,"indexOf",t)},join(t){return qt(this).join(t)},lastIndexOf(...t){return lo(this,"lastIndexOf",t)},map(t,e){return mt(this,"map",t,e,void 0,arguments)},pop(){return as(this,"pop")},push(...t){return as(this,"push",t)},reduce(t,...e){return Xo(this,"reduce",t,e)},reduceRight(t,...e){return Xo(this,"reduceRight",t,e)},shift(){return as(this,"shift")},some(t,e){return mt(this,"some",t,e,void 0,arguments)},splice(...t){return as(this,"splice",t)},toReversed(){return qt(this).toReversed()},toSorted(t){return qt(this).toSorted(t)},toSpliced(...t){return qt(this).toSpliced(...t)},unshift(...t){return as(this,"unshift",t)},values(){return io(this,"values",Ve)}};function io(t,e,s){const n=Zs(t),i=n[e]();return n!==t&&!rt(t)&&(i._next=i.next,i.next=()=>{const l=i._next();return l.value&&(l.value=s(l.value)),l}),i}const pi=Array.prototype;function mt(t,e,s,n,i,l){const o=Zs(t),a=o!==t&&!rt(t),c=o[e];if(c!==pi[e]){const g=c.apply(t,l);return a?Ve(g):g}let u=s;o!==t&&(a?u=function(g,p){return s.call(this,Ve(g),p,t)}:s.length>2&&(u=function(g,p){return s.call(this,g,p,t)}));const d=c.call(o,u,n);return a&&i?i(d):d}function Xo(t,e,s,n){const i=Zs(t);let l=s;return i!==t&&(rt(t)?s.length>3&&(l=function(o,a,c){return s.call(this,o,a,c,t)}):l=function(o,a,c){return s.call(this,o,Ve(a),c,t)}),i[e](l,...n)}function lo(t,e,s){const n=$e(t);Be(n,"iterate",$s);const i=n[e](...s);return(i===-1||i===!1)&&Bo(s[0])?(s[0]=$e(s[0]),n[e](...s)):i}function as(t,e,s=[]){Rt(),Po();const n=$e(t)[e].apply(t,s);return Ho(),Nt(),n}const vi=Ao("__proto__,__v_isRef,__isVue"),Xn=new Set(Object.getOwnPropertyNames(Symbol).filter(t=>t!=="arguments"&&t!=="caller").map(t=>Symbol[t]).filter(ht));function yi(t){ht(t)||(t=String(t));const e=$e(this);return Be(e,"has",t),e.hasOwnProperty(t)}class xn{constructor(e=!1,s=!1){this._isReadonly=e,this._isShallow=s}get(e,s,n){if(s==="__v_skip")return e.__v_skip;const i=this._isReadonly,l=this._isShallow;if(s==="__v_isReactive")return!i;if(s==="__v_isReadonly")return i;if(s==="__v_isShallow")return l;if(s==="__v_raw")return n===(i?l?Si:or:l?sr:tr).get(e)||Object.getPrototypeOf(e)===Object.getPrototypeOf(n)?e:void 0;const o=oe(e);if(!i){let c;if(o&&(c=gi[s]))return c;if(s==="hasOwnProperty")return yi}const a=Reflect.get(e,s,Je(e)?e:n);return(ht(s)?Xn.has(s):vi(s))||(i||Be(e,"get",s),l)?a:Je(a)?o&&Oo(s)?a:a.value:Oe(a)?i?nr(a):Fo(a):a}}class er extends xn{constructor(e=!1){super(!1,e)}set(e,s,n,i){let l=e[s];if(!this._isShallow){const c=Wt(l);if(!rt(n)&&!Wt(n)&&(l=$e(l),n=$e(n)),!oe(e)&&Je(l)&&!Je(n))return c?!1:(l.value=n,!0)}const o=oe(e)&&Oo(s)?Number(s)<e.length:we(e,s),a=Reflect.set(e,s,n,Je(e)?e:i);return e===$e(i)&&(o?At(n,l)&&$t(e,"set",s,n):$t(e,"add",s,n)),a}deleteProperty(e,s){const n=we(e,s);e[s];const i=Reflect.deleteProperty(e,s);return i&&n&&$t(e,"delete",s,void 0),i}has(e,s){const n=Reflect.has(e,s);return(!ht(s)||!Xn.has(s))&&Be(e,"has",s),n}ownKeys(e){return Be(e,"iterate",oe(e)?"length":Kt),Reflect.ownKeys(e)}}class hi extends xn{constructor(e=!1){super(!0,e)}set(e,s){return!0}deleteProperty(e,s){return!0}}const mi=new er,bi=new hi,$i=new er(!0);const mo=t=>t,As=t=>Reflect.getPrototypeOf(t);function wi(t,e,s){return function(...n){const i=this.__v_raw,l=$e(i),o=es(l),a=t==="entries"||t===Symbol.iterator&&o,c=t==="keys"&&o,u=i[t](...n),d=s?mo:e?bo:Ve;return!e&&Be(l,"iterate",c?ho:Kt),{next(){const{value:g,done:p}=u.next();return p?{value:g,done:p}:{value:a?[d(g[0]),d(g[1])]:d(g),done:p}},[Symbol.iterator](){return this}}}}function Is(t){return function(...e){return t==="delete"?!1:t==="clear"?void 0:this}}function Ci(t,e){const s={get(i){const l=this.__v_raw,o=$e(l),a=$e(i);t||(At(i,a)&&Be(o,"get",i),Be(o,"get",a));const{has:c}=As(o),u=e?mo:t?bo:Ve;if(c.call(o,i))return u(l.get(i));if(c.call(o,a))return u(l.get(a));l!==o&&l.get(i)},get size(){const i=this.__v_raw;return!t&&Be($e(i),"iterate",Kt),Reflect.get(i,"size",i)},has(i){const l=this.__v_raw,o=$e(l),a=$e(i);return t||(At(i,a)&&Be(o,"has",i),Be(o,"has",a)),i===a?l.has(i):l.has(i)||l.has(a)},forEach(i,l){const o=this,a=o.__v_raw,c=$e(a),u=e?mo:t?bo:Ve;return!t&&Be(c,"iterate",Kt),a.forEach((d,g)=>i.call(l,u(d),u(g),o))}};return Re(s,t?{add:Is("add"),set:Is("set"),delete:Is("delete"),clear:Is("clear")}:{add(i){!e&&!rt(i)&&!Wt(i)&&(i=$e(i));const l=$e(this);return As(l).has.call(l,i)||(l.add(i),$t(l,"add",i,i)),this},set(i,l){!e&&!rt(l)&&!Wt(l)&&(l=$e(l));const o=$e(this),{has:a,get:c}=As(o);let u=a.call(o,i);u||(i=$e(i),u=a.call(o,i));const d=c.call(o,i);return o.set(i,l),u?At(l,d)&&$t(o,"set",i,l):$t(o,"add",i,l),this},delete(i){const l=$e(this),{has:o,get:a}=As(l);let c=o.call(l,i);c||(i=$e(i),c=o.call(l,i)),a&&a.call(l,i);const u=l.delete(i);return c&&$t(l,"delete",i,void 0),u},clear(){const i=$e(this),l=i.size!==0,o=i.clear();return l&&$t(i,"clear",void 0,void 0),o}}),["keys","values","entries",Symbol.iterator].forEach(i=>{s[i]=wi(i,t,e)}),s}function jo(t,e){const s=Ci(t,e);return(n,i,l)=>i==="__v_isReactive"?!t:i==="__v_isReadonly"?t:i==="__v_raw"?n:Reflect.get(we(s,i)&&i in n?s:n,i,l)}const Ti={get:jo(!1,!1)},_i={get:jo(!1,!0)},Li={get:jo(!0,!1)};const tr=new WeakMap,sr=new WeakMap,or=new WeakMap,Si=new WeakMap;function ki(t){switch(t){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function Ei(t){return t.__v_skip||!Object.isExtensible(t)?0:ki(Xr(t))}function Fo(t){return Wt(t)?t:Uo(t,!1,mi,Ti,tr)}function Ai(t){return Uo(t,!1,$i,_i,sr)}function nr(t){return Uo(t,!0,bi,Li,or)}function Uo(t,e,s,n,i){if(!Oe(t)||t.__v_raw&&!(e&&t.__v_isReactive))return t;const l=i.get(t);if(l)return l;const o=Ei(t);if(o===0)return t;const a=new Proxy(t,o===2?n:s);return i.set(t,a),a}function ts(t){return Wt(t)?ts(t.__v_raw):!!(t&&t.__v_isReactive)}function Wt(t){return!!(t&&t.__v_isReadonly)}function rt(t){return!!(t&&t.__v_isShallow)}function Bo(t){return t?!!t.__v_raw:!1}function $e(t){const e=t&&t.__v_raw;return e?$e(e):t}function rr(t){return!we(t,"__v_skip")&&Object.isExtensible(t)&&Un(t,"__v_skip",!0),t}const Ve=t=>Oe(t)?Fo(t):t,bo=t=>Oe(t)?nr(t):t;function Je(t){return t?t.__v_isRef===!0:!1}function $(t){return Ii(t,!1)}function Ii(t,e){return Je(t)?t:new Mi(t,e)}class Mi{constructor(e,s){this.dep=new No,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=s?e:$e(e),this._value=s?e:Ve(e),this.__v_isShallow=s}get value(){return this.dep.track(),this._value}set value(e){const s=this._rawValue,n=this.__v_isShallow||rt(e)||Wt(e);e=n?e:$e(e),At(e,s)&&(this._rawValue=e,this._value=n?e:Ve(e),this.dep.trigger())}}function Oi(t){return Je(t)?t.value:t}const Di={get:(t,e,s)=>e==="__v_raw"?t:Oi(Reflect.get(t,e,s)),set:(t,e,s,n)=>{const i=t[e];return Je(i)&&!Je(s)?(i.value=s,!0):Reflect.set(t,e,s,n)}};function ir(t){return ts(t)?t:new Proxy(t,Di)}class Pi{constructor(e,s,n){this.fn=e,this.setter=s,this._value=void 0,this.dep=new No(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=bs-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!s,this.isSSR=n}notify(){if(this.flags|=16,!(this.flags&8)&&Me!==this)return Wn(this,!0),!0}get value(){const e=this.dep.track();return qn(this),e&&(e.version=this.dep.version),this._value}set value(e){this.setter&&this.setter(e)}}function Hi(t,e,s=!1){let n,i;return ce(t)?n=t:(n=t.get,i=t.set),new Pi(n,i,s)}const Ms={},Fs=new WeakMap;let Jt;function Ri(t,e=!1,s=Jt){if(s){let n=Fs.get(s);n||Fs.set(s,n=[]),n.push(t)}}function Ni(t,e,s=Le){const{immediate:n,deep:i,once:l,scheduler:o,augmentJob:a,call:c}=s,u=b=>i?b:rt(b)||i===!1||i===0?wt(b,1):wt(b);let d,g,p,m,T=!1,k=!1;if(Je(t)?(g=()=>t.value,T=rt(t)):ts(t)?(g=()=>u(t),T=!0):oe(t)?(k=!0,T=t.some(b=>ts(b)||rt(b)),g=()=>t.map(b=>{if(Je(b))return b.value;if(ts(b))return u(b);if(ce(b))return c?c(b,2):b()})):ce(t)?e?g=c?()=>c(t,2):t:g=()=>{if(p){Rt();try{p()}finally{Nt()}}const b=Jt;Jt=d;try{return c?c(t,3,[m]):t(m)}finally{Jt=b}}:g=ct,e&&i){const b=g,D=i===!0?1/0:i;g=()=>wt(b(),D)}const Z=ui(),V=()=>{d.stop(),Z&&Z.active&&Mo(Z.effects,d)};if(l&&e){const b=e;e=(...D)=>{b(...D),V()}}let F=k?new Array(t.length).fill(Ms):Ms;const H=b=>{if(!(!(d.flags&1)||!d.dirty&&!b))if(e){const D=d.run();if(i||T||(k?D.some((te,q)=>At(te,F[q])):At(D,F))){p&&p();const te=Jt;Jt=d;try{const q=[D,F===Ms?void 0:k&&F[0]===Ms?[]:F,m];c?c(e,3,q):e(...q),F=D}finally{Jt=te}}}else d.run()};return a&&a(H),d=new Kn(g),d.scheduler=o?()=>o(H,!1):H,m=b=>Ri(b,!1,d),p=d.onStop=()=>{const b=Fs.get(d);if(b){if(c)c(b,4);else for(const D of b)D();Fs.delete(d)}},e?n?H(!0):F=d.run():o?o(H.bind(null,!0),!0):d.run(),V.pause=d.pause.bind(d),V.resume=d.resume.bind(d),V.stop=V,V}function wt(t,e=1/0,s){if(e<=0||!Oe(t)||t.__v_skip||(s=s||new Set,s.has(t)))return t;if(s.add(t),e--,Je(t))wt(t.value,e,s);else if(oe(t))for(let n=0;n<t.length;n++)wt(t[n],e,s);else if(is(t)||es(t))t.forEach(n=>{wt(n,e,s)});else if(Fn(t)){for(const n in t)wt(t[n],e,s);for(const n of Object.getOwnPropertySymbols(t))Object.prototype.propertyIsEnumerable.call(t,n)&&wt(t[n],e,s)}return t}/**
* @vue/runtime-core v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function Ss(t,e,s,n){try{return n?t(...n):t()}catch(i){Xs(i,e,s)}}function dt(t,e,s,n){if(ce(t)){const i=Ss(t,e,s,n);return i&&Nn(i)&&i.catch(l=>{Xs(l,e,s)}),i}if(oe(t)){const i=[];for(let l=0;l<t.length;l++)i.push(dt(t[l],e,s,n));return i}}function Xs(t,e,s,n=!0){const i=e?e.vnode:null,{errorHandler:l,throwUnhandledErrorInProduction:o}=e&&e.appContext.config||Le;if(e){let a=e.parent;const c=e.proxy,u=`https://vuejs.org/error-reference/#runtime-${s}`;for(;a;){const d=a.ec;if(d){for(let g=0;g<d.length;g++)if(d[g](t,c,u)===!1)return}a=a.parent}if(l){Rt(),Ss(l,null,10,[t,c,u]),Nt();return}}ji(t,s,i,n,o)}function ji(t,e,s,n=!0,i=!1){if(i)throw t;console.error(t)}const We=[];let vt=-1;const ss=[];let kt=null,Zt=0;const lr=Promise.resolve();let Us=null;function Tt(t){const e=Us||lr;return t?e.then(this?t.bind(this):t):e}function Fi(t){let e=vt+1,s=We.length;for(;e<s;){const n=e+s>>>1,i=We[n],l=ws(i);l<t||l===t&&i.flags&2?e=n+1:s=n}return e}function Vo(t){if(!(t.flags&1)){const e=ws(t),s=We[We.length-1];!s||!(t.flags&2)&&e>=ws(s)?We.push(t):We.splice(Fi(e),0,t),t.flags|=1,ar()}}function ar(){Us||(Us=lr.then(ur))}function Ui(t){oe(t)?ss.push(...t):kt&&t.id===-1?kt.splice(Zt+1,0,t):t.flags&1||(ss.push(t),t.flags|=1),ar()}function xo(t,e,s=vt+1){for(;s<We.length;s++){const n=We[s];if(n&&n.flags&2){if(t&&n.id!==t.uid)continue;We.splice(s,1),s--,n.flags&4&&(n.flags&=-2),n(),n.flags&4||(n.flags&=-2)}}}function cr(t){if(ss.length){const e=[...new Set(ss)].sort((s,n)=>ws(s)-ws(n));if(ss.length=0,kt){kt.push(...e);return}for(kt=e,Zt=0;Zt<kt.length;Zt++){const s=kt[Zt];s.flags&4&&(s.flags&=-2),s.flags&8||s(),s.flags&=-2}kt=null,Zt=0}}const ws=t=>t.id==null?t.flags&2?-1:1/0:t.id;function ur(t){const e=ct;try{for(vt=0;vt<We.length;vt++){const s=We[vt];s&&!(s.flags&8)&&(s.flags&4&&(s.flags&=-2),Ss(s,s.i,s.i?15:14),s.flags&4||(s.flags&=-2))}}finally{for(;vt<We.length;vt++){const s=We[vt];s&&(s.flags&=-2)}vt=-1,We.length=0,cr(),Us=null,(We.length||ss.length)&&ur()}}let qe=null,dr=null;function Bs(t){const e=qe;return qe=t,dr=t&&t.type.__scopeId||null,e}function fr(t,e=qe,s){if(!e||t._n)return t;const n=(...i)=>{n._d&&cn(-1);const l=Bs(e);let o;try{o=t(...i)}finally{Bs(l),n._d&&cn(1)}return o};return n._n=!0,n._c=!0,n._d=!0,n}function B(t,e){if(qe===null)return t;const s=so(qe),n=t.dirs||(t.dirs=[]);for(let i=0;i<e.length;i++){let[l,o,a,c=Le]=e[i];l&&(ce(l)&&(l={mounted:l,updated:l}),l.deep&&wt(o),n.push({dir:l,instance:s,value:o,oldValue:void 0,arg:a,modifiers:c}))}return t}function jt(t,e,s,n){const i=t.dirs,l=e&&e.dirs;for(let o=0;o<i.length;o++){const a=i[o];l&&(a.oldValue=l[o].value);let c=a.dir[n];c&&(Rt(),dt(c,s,8,[t.el,a,t,e]),Nt())}}const Bi=Symbol("_vte"),Vi=t=>t.__isTeleport,Qt=Symbol("_leaveCb"),Os=Symbol("_enterCb");function Ji(){const t={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return Ke(()=>{t.isMounted=!0}),Yt(()=>{t.isUnmounting=!0}),t}const nt=[Function,Array],Ki={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:nt,onEnter:nt,onAfterEnter:nt,onEnterCancelled:nt,onBeforeLeave:nt,onLeave:nt,onAfterLeave:nt,onLeaveCancelled:nt,onBeforeAppear:nt,onAppear:nt,onAfterAppear:nt,onAppearCancelled:nt};function zi(t,e){const{leavingVNodes:s}=t;let n=s.get(e.type);return n||(n=Object.create(null),s.set(e.type,n)),n}function $o(t,e,s,n,i){const{appear:l,mode:o,persisted:a=!1,onBeforeEnter:c,onEnter:u,onAfterEnter:d,onEnterCancelled:g,onBeforeLeave:p,onLeave:m,onAfterLeave:T,onLeaveCancelled:k,onBeforeAppear:Z,onAppear:V,onAfterAppear:F,onAppearCancelled:H}=e,b=String(t.key),D=zi(s,t),te=(se,W)=>{se&&dt(se,n,9,W)},q=(se,W)=>{const re=W[1];te(se,W),oe(se)?se.every(C=>C.length<=1)&&re():se.length<=1&&re()},Te={mode:o,persisted:a,beforeEnter(se){let W=c;if(!s.isMounted)if(l)W=Z||c;else return;se[Qt]&&se[Qt](!0);const re=D[b];re&&Xt(t,re)&&re.el[Qt]&&re.el[Qt](),te(W,[se])},enter(se){let W=u,re=d,C=g;if(!s.isMounted)if(l)W=V||u,re=F||d,C=H||g;else return;let G=!1;const ue=se[Os]=pe=>{G||(G=!0,pe?te(C,[se]):te(re,[se]),Te.delayedLeave&&Te.delayedLeave(),se[Os]=void 0)};W?q(W,[se,ue]):ue()},leave(se,W){const re=String(t.key);if(se[Os]&&se[Os](!0),s.isUnmounting)return W();te(p,[se]);let C=!1;const G=se[Qt]=ue=>{C||(C=!0,W(),ue?te(k,[se]):te(T,[se]),se[Qt]=void 0,D[re]===t&&delete D[re])};D[re]=t,m?q(m,[se,G]):G()},clone(se){const W=$o(se,e,s,n,i);return i&&i(W),W}};return Te}function Cs(t,e){t.shapeFlag&6&&t.component?(t.transition=e,Cs(t.component.subTree,e)):t.shapeFlag&128?(t.ssContent.transition=e.clone(t.ssContent),t.ssFallback.transition=e.clone(t.ssFallback)):t.transition=e}function gr(t,e=!1,s){let n=[],i=0;for(let l=0;l<t.length;l++){let o=t[l];const a=s==null?o.key:String(s)+String(o.key!=null?o.key:l);o.type===Q?(o.patchFlag&128&&i++,n=n.concat(gr(o.children,e,a))):(e||o.type!==Dt)&&n.push(a!=null?Gt(o,{key:a}):o)}if(i>1)for(let l=0;l<n.length;l++)n[l].patchFlag=-2;return n}/*! #__NO_SIDE_EFFECTS__ */function He(t,e){return ce(t)?(()=>Re({name:t.name},e,{setup:t}))():t}function pr(t){t.ids=[t.ids[0]+t.ids[2]+++"-",0,0]}function Vs(t,e,s,n,i=!1){if(oe(t)){t.forEach((T,k)=>Vs(T,e&&(oe(e)?e[k]:e),s,n,i));return}if(ys(n)&&!i){n.shapeFlag&512&&n.type.__asyncResolved&&n.component.subTree.component&&Vs(t,e,s,n.component.subTree);return}const l=n.shapeFlag&4?so(n.component):n.el,o=i?null:l,{i:a,r:c}=t,u=e&&e.r,d=a.refs===Le?a.refs={}:a.refs,g=a.setupState,p=$e(g),m=g===Le?()=>!1:T=>we(p,T);if(u!=null&&u!==c&&(Pe(u)?(d[u]=null,m(u)&&(g[u]=null)):Je(u)&&(u.value=null)),ce(c))Ss(c,a,12,[o,d]);else{const T=Pe(c),k=Je(c);if(T||k){const Z=()=>{if(t.f){const V=T?m(c)?g[c]:d[c]:c.value;i?oe(V)&&Mo(V,l):oe(V)?V.includes(l)||V.push(l):T?(d[c]=[l],m(c)&&(g[c]=d[c])):(c.value=[l],t.k&&(d[t.k]=c.value))}else T?(d[c]=o,m(c)&&(g[c]=o)):k&&(c.value=o,t.k&&(d[t.k]=o))};o?(Z.id=-1,tt(Z,s)):Z()}}}Qs().requestIdleCallback;Qs().cancelIdleCallback;const ys=t=>!!t.type.__asyncLoader,vr=t=>t.type.__isKeepAlive;function Wi(t,e){yr(t,"a",e)}function Gi(t,e){yr(t,"da",e)}function yr(t,e,s=Fe){const n=t.__wdc||(t.__wdc=()=>{let i=s;for(;i;){if(i.isDeactivated)return;i=i.parent}return t()});if(xs(e,n,s),s){let i=s.parent;for(;i&&i.parent;)vr(i.parent.vnode)&&Yi(n,e,s,i),i=i.parent}}function Yi(t,e,s,n){const i=xs(e,t,n,!0);ks(()=>{Mo(n[e],i)},s)}function xs(t,e,s=Fe,n=!1){if(s){const i=s[t]||(s[t]=[]),l=e.__weh||(e.__weh=(...o)=>{Rt();const a=Es(s),c=dt(e,s,t,o);return a(),Nt(),c});return n?i.unshift(l):i.push(l),l}}const _t=t=>(e,s=Fe)=>{(!_s||t==="sp")&&xs(t,(...n)=>e(...n),s)},qi=_t("bm"),Ke=_t("m"),Qi=_t("bu"),hr=_t("u"),Yt=_t("bum"),ks=_t("um"),Zi=_t("sp"),Xi=_t("rtg"),xi=_t("rtc");function el(t,e=Fe){xs("ec",t,e)}const Jo="components";function ke(t,e){return br(Jo,t,!0,e)||t}const mr=Symbol.for("v-ndc");function tl(t){return Pe(t)?br(Jo,t,!1)||t:t||mr}function br(t,e,s=!0,n=!1){const i=qe||Fe;if(i){const l=i.type;if(t===Jo){const a=Jl(l,!1);if(a&&(a===e||a===lt(e)||a===qs(lt(e))))return l}const o=en(i[t]||l[t],e)||en(i.appContext[t],e);return!o&&n?l:o}}function en(t,e){return t&&(t[e]||t[lt(e)]||t[qs(lt(e))])}function ge(t,e,s,n){let i;const l=s&&s[n],o=oe(t);if(o||Pe(t)){const a=o&&ts(t);let c=!1;a&&(c=!rt(t),t=Zs(t)),i=new Array(t.length);for(let u=0,d=t.length;u<d;u++)i[u]=e(c?Ve(t[u]):t[u],u,void 0,l&&l[u])}else if(typeof t=="number"){i=new Array(t);for(let a=0;a<t;a++)i[a]=e(a+1,a,void 0,l&&l[a])}else if(Oe(t))if(t[Symbol.iterator])i=Array.from(t,(a,c)=>e(a,c,void 0,l&&l[c]));else{const a=Object.keys(t);i=new Array(a.length);for(let c=0,u=a.length;c<u;c++){const d=a[c];i[c]=e(t[d],d,c,l&&l[c])}}else i=[];return s&&(s[n]=i),i}const wo=t=>t?Ur(t)?so(t):wo(t.parent):null,hs=Re(Object.create(null),{$:t=>t,$el:t=>t.vnode.el,$data:t=>t.data,$props:t=>t.props,$attrs:t=>t.attrs,$slots:t=>t.slots,$refs:t=>t.refs,$parent:t=>wo(t.parent),$root:t=>wo(t.root),$host:t=>t.ce,$emit:t=>t.emit,$options:t=>Ko(t),$forceUpdate:t=>t.f||(t.f=()=>{Vo(t.update)}),$nextTick:t=>t.n||(t.n=Tt.bind(t.proxy)),$watch:t=>Tl.bind(t)}),ao=(t,e)=>t!==Le&&!t.__isScriptSetup&&we(t,e),sl={get({_:t},e){if(e==="__v_skip")return!0;const{ctx:s,setupState:n,data:i,props:l,accessCache:o,type:a,appContext:c}=t;let u;if(e[0]!=="$"){const m=o[e];if(m!==void 0)switch(m){case 1:return n[e];case 2:return i[e];case 4:return s[e];case 3:return l[e]}else{if(ao(n,e))return o[e]=1,n[e];if(i!==Le&&we(i,e))return o[e]=2,i[e];if((u=t.propsOptions[0])&&we(u,e))return o[e]=3,l[e];if(s!==Le&&we(s,e))return o[e]=4,s[e];Co&&(o[e]=0)}}const d=hs[e];let g,p;if(d)return e==="$attrs"&&Be(t.attrs,"get",""),d(t);if((g=a.__cssModules)&&(g=g[e]))return g;if(s!==Le&&we(s,e))return o[e]=4,s[e];if(p=c.config.globalProperties,we(p,e))return p[e]},set({_:t},e,s){const{data:n,setupState:i,ctx:l}=t;return ao(i,e)?(i[e]=s,!0):n!==Le&&we(n,e)?(n[e]=s,!0):we(t.props,e)||e[0]==="$"&&e.slice(1)in t?!1:(l[e]=s,!0)},has({_:{data:t,setupState:e,accessCache:s,ctx:n,appContext:i,propsOptions:l}},o){let a;return!!s[o]||t!==Le&&we(t,o)||ao(e,o)||(a=l[0])&&we(a,o)||we(n,o)||we(hs,o)||we(i.config.globalProperties,o)},defineProperty(t,e,s){return s.get!=null?t._.accessCache[e]=0:we(s,"value")&&this.set(t,e,s.value,null),Reflect.defineProperty(t,e,s)}};function tn(t){return oe(t)?t.reduce((e,s)=>(e[s]=null,e),{}):t}let Co=!0;function ol(t){const e=Ko(t),s=t.proxy,n=t.ctx;Co=!1,e.beforeCreate&&sn(e.beforeCreate,t,"bc");const{data:i,computed:l,methods:o,watch:a,provide:c,inject:u,created:d,beforeMount:g,mounted:p,beforeUpdate:m,updated:T,activated:k,deactivated:Z,beforeDestroy:V,beforeUnmount:F,destroyed:H,unmounted:b,render:D,renderTracked:te,renderTriggered:q,errorCaptured:Te,serverPrefetch:se,expose:W,inheritAttrs:re,components:C,directives:G,filters:ue}=e;if(u&&nl(u,n,null),o)for(const J in o){const ie=o[J];ce(ie)&&(n[J]=ie.bind(s))}if(i){const J=i.call(s,s);Oe(J)&&(t.data=Fo(J))}if(Co=!0,l)for(const J in l){const ie=l[J],ve=ce(ie)?ie.bind(s,s):ce(ie.get)?ie.get.bind(s,s):ct,je=!ce(ie)&&ce(ie.set)?ie.set.bind(s):ct,De=Se({get:ve,set:je});Object.defineProperty(n,J,{enumerable:!0,configurable:!0,get:()=>De.value,set:M=>De.value=M})}if(a)for(const J in a)$r(a[J],n,s,J);if(c){const J=ce(c)?c.call(s):c;Reflect.ownKeys(J).forEach(ie=>{ul(ie,J[ie])})}d&&sn(d,t,"c");function U(J,ie){oe(ie)?ie.forEach(ve=>J(ve.bind(s))):ie&&J(ie.bind(s))}if(U(qi,g),U(Ke,p),U(Qi,m),U(hr,T),U(Wi,k),U(Gi,Z),U(el,Te),U(xi,te),U(Xi,q),U(Yt,F),U(ks,b),U(Zi,se),oe(W))if(W.length){const J=t.exposed||(t.exposed={});W.forEach(ie=>{Object.defineProperty(J,ie,{get:()=>s[ie],set:ve=>s[ie]=ve})})}else t.exposed||(t.exposed={});D&&t.render===ct&&(t.render=D),re!=null&&(t.inheritAttrs=re),C&&(t.components=C),G&&(t.directives=G),se&&pr(t)}function nl(t,e,s=ct){oe(t)&&(t=To(t));for(const n in t){const i=t[n];let l;Oe(i)?"default"in i?l=ye(i.from||n,i.default,!0):l=ye(i.from||n):l=ye(i),Je(l)?Object.defineProperty(e,n,{enumerable:!0,configurable:!0,get:()=>l.value,set:o=>l.value=o}):e[n]=l}}function sn(t,e,s){dt(oe(t)?t.map(n=>n.bind(e.proxy)):t.bind(e.proxy),e,s)}function $r(t,e,s,n){let i=n.includes(".")?Pr(s,n):()=>s[n];if(Pe(t)){const l=e[t];ce(l)&&Qe(i,l)}else if(ce(t))Qe(i,t.bind(s));else if(Oe(t))if(oe(t))t.forEach(l=>$r(l,e,s,n));else{const l=ce(t.handler)?t.handler.bind(s):e[t.handler];ce(l)&&Qe(i,l,t)}}function Ko(t){const e=t.type,{mixins:s,extends:n}=e,{mixins:i,optionsCache:l,config:{optionMergeStrategies:o}}=t.appContext,a=l.get(e);let c;return a?c=a:!i.length&&!s&&!n?c=e:(c={},i.length&&i.forEach(u=>Js(c,u,o,!0)),Js(c,e,o)),Oe(e)&&l.set(e,c),c}function Js(t,e,s,n=!1){const{mixins:i,extends:l}=e;l&&Js(t,l,s,!0),i&&i.forEach(o=>Js(t,o,s,!0));for(const o in e)if(!(n&&o==="expose")){const a=rl[o]||s&&s[o];t[o]=a?a(t[o],e[o]):e[o]}return t}const rl={data:on,props:nn,emits:nn,methods:fs,computed:fs,beforeCreate:ze,created:ze,beforeMount:ze,mounted:ze,beforeUpdate:ze,updated:ze,beforeDestroy:ze,beforeUnmount:ze,destroyed:ze,unmounted:ze,activated:ze,deactivated:ze,errorCaptured:ze,serverPrefetch:ze,components:fs,directives:fs,watch:ll,provide:on,inject:il};function on(t,e){return e?t?function(){return Re(ce(t)?t.call(this,this):t,ce(e)?e.call(this,this):e)}:e:t}function il(t,e){return fs(To(t),To(e))}function To(t){if(oe(t)){const e={};for(let s=0;s<t.length;s++)e[t[s]]=t[s];return e}return t}function ze(t,e){return t?[...new Set([].concat(t,e))]:e}function fs(t,e){return t?Re(Object.create(null),t,e):e}function nn(t,e){return t?oe(t)&&oe(e)?[...new Set([...t,...e])]:Re(Object.create(null),tn(t),tn(e??{})):e}function ll(t,e){if(!t)return e;if(!e)return t;const s=Re(Object.create(null),t);for(const n in e)s[n]=ze(t[n],e[n]);return s}function wr(){return{app:null,config:{isNativeTag:Qr,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let al=0;function cl(t,e){return function(n,i=null){ce(n)||(n=Re({},n)),i!=null&&!Oe(i)&&(i=null);const l=wr(),o=new WeakSet,a=[];let c=!1;const u=l.app={_uid:al++,_component:n,_props:i,_container:null,_context:l,_instance:null,version:zl,get config(){return l.config},set config(d){},use(d,...g){return o.has(d)||(d&&ce(d.install)?(o.add(d),d.install(u,...g)):ce(d)&&(o.add(d),d(u,...g))),u},mixin(d){return l.mixins.includes(d)||l.mixins.push(d),u},component(d,g){return g?(l.components[d]=g,u):l.components[d]},directive(d,g){return g?(l.directives[d]=g,u):l.directives[d]},mount(d,g,p){if(!c){const m=u._ceVNode||be(n,i);return m.appContext=l,p===!0?p="svg":p===!1&&(p=void 0),g&&e?e(m,d):t(m,d,p),c=!0,u._container=d,d.__vue_app__=u,so(m.component)}},onUnmount(d){a.push(d)},unmount(){c&&(dt(a,u._instance,16),t(null,u._container),delete u._container.__vue_app__)},provide(d,g){return l.provides[d]=g,u},runWithContext(d){const g=os;os=u;try{return d()}finally{os=g}}};return u}}let os=null;function ul(t,e){if(Fe){let s=Fe.provides;const n=Fe.parent&&Fe.parent.provides;n===s&&(s=Fe.provides=Object.create(n)),s[t]=e}}function ye(t,e,s=!1){const n=Fe||qe;if(n||os){const i=os?os._context.provides:n?n.parent==null?n.vnode.appContext&&n.vnode.appContext.provides:n.parent.provides:void 0;if(i&&t in i)return i[t];if(arguments.length>1)return s&&ce(e)?e.call(n&&n.proxy):e}}const Cr={},Tr=()=>Object.create(Cr),_r=t=>Object.getPrototypeOf(t)===Cr;function dl(t,e,s,n=!1){const i={},l=Tr();t.propsDefaults=Object.create(null),Lr(t,e,i,l);for(const o in t.propsOptions[0])o in i||(i[o]=void 0);s?t.props=n?i:Ai(i):t.type.props?t.props=i:t.props=l,t.attrs=l}function fl(t,e,s,n){const{props:i,attrs:l,vnode:{patchFlag:o}}=t,a=$e(i),[c]=t.propsOptions;let u=!1;if((n||o>0)&&!(o&16)){if(o&8){const d=t.vnode.dynamicProps;for(let g=0;g<d.length;g++){let p=d[g];if(eo(t.emitsOptions,p))continue;const m=e[p];if(c)if(we(l,p))m!==l[p]&&(l[p]=m,u=!0);else{const T=lt(p);i[T]=_o(c,a,T,m,t,!1)}else m!==l[p]&&(l[p]=m,u=!0)}}}else{Lr(t,e,i,l)&&(u=!0);let d;for(const g in a)(!e||!we(e,g)&&((d=Ht(g))===g||!we(e,d)))&&(c?s&&(s[g]!==void 0||s[d]!==void 0)&&(i[g]=_o(c,a,g,void 0,t,!0)):delete i[g]);if(l!==a)for(const g in l)(!e||!we(e,g))&&(delete l[g],u=!0)}u&&$t(t.attrs,"set","")}function Lr(t,e,s,n){const[i,l]=t.propsOptions;let o=!1,a;if(e)for(let c in e){if(gs(c))continue;const u=e[c];let d;i&&we(i,d=lt(c))?!l||!l.includes(d)?s[d]=u:(a||(a={}))[d]=u:eo(t.emitsOptions,c)||(!(c in n)||u!==n[c])&&(n[c]=u,o=!0)}if(l){const c=$e(s),u=a||Le;for(let d=0;d<l.length;d++){const g=l[d];s[g]=_o(i,c,g,u[g],t,!we(u,g))}}return o}function _o(t,e,s,n,i,l){const o=t[s];if(o!=null){const a=we(o,"default");if(a&&n===void 0){const c=o.default;if(o.type!==Function&&!o.skipFactory&&ce(c)){const{propsDefaults:u}=i;if(s in u)n=u[s];else{const d=Es(i);n=u[s]=c.call(null,e),d()}}else n=c;i.ce&&i.ce._setProp(s,n)}o[0]&&(l&&!a?n=!1:o[1]&&(n===""||n===Ht(s))&&(n=!0))}return n}const gl=new WeakMap;function Sr(t,e,s=!1){const n=s?gl:e.propsCache,i=n.get(t);if(i)return i;const l=t.props,o={},a=[];let c=!1;if(!ce(t)){const d=g=>{c=!0;const[p,m]=Sr(g,e,!0);Re(o,p),m&&a.push(...m)};!s&&e.mixins.length&&e.mixins.forEach(d),t.extends&&d(t.extends),t.mixins&&t.mixins.forEach(d)}if(!l&&!c)return Oe(t)&&n.set(t,xt),xt;if(oe(l))for(let d=0;d<l.length;d++){const g=lt(l[d]);rn(g)&&(o[g]=Le)}else if(l)for(const d in l){const g=lt(d);if(rn(g)){const p=l[d],m=o[g]=oe(p)||ce(p)?{type:p}:Re({},p),T=m.type;let k=!1,Z=!0;if(oe(T))for(let V=0;V<T.length;++V){const F=T[V],H=ce(F)&&F.name;if(H==="Boolean"){k=!0;break}else H==="String"&&(Z=!1)}else k=ce(T)&&T.name==="Boolean";m[0]=k,m[1]=Z,(k||we(m,"default"))&&a.push(g)}}const u=[o,a];return Oe(t)&&n.set(t,u),u}function rn(t){return t[0]!=="$"&&!gs(t)}const kr=t=>t[0]==="_"||t==="$stable",zo=t=>oe(t)?t.map(yt):[yt(t)],pl=(t,e,s)=>{if(e._n)return e;const n=fr((...i)=>zo(e(...i)),s);return n._c=!1,n},Er=(t,e,s)=>{const n=t._ctx;for(const i in t){if(kr(i))continue;const l=t[i];if(ce(l))e[i]=pl(i,l,n);else if(l!=null){const o=zo(l);e[i]=()=>o}}},Ar=(t,e)=>{const s=zo(e);t.slots.default=()=>s},Ir=(t,e,s)=>{for(const n in e)(s||n!=="_")&&(t[n]=e[n])},vl=(t,e,s)=>{const n=t.slots=Tr();if(t.vnode.shapeFlag&32){const i=e._;i?(Ir(n,e,s),s&&Un(n,"_",i,!0)):Er(e,n)}else e&&Ar(t,e)},yl=(t,e,s)=>{const{vnode:n,slots:i}=t;let l=!0,o=Le;if(n.shapeFlag&32){const a=e._;a?s&&a===1?l=!1:Ir(i,e,s):(l=!e.$stable,Er(e,i)),o=e}else e&&(Ar(t,e),o={default:1});if(l)for(const a in i)!kr(a)&&o[a]==null&&delete i[a]},tt=Il;function hl(t){return ml(t)}function ml(t,e){const s=Qs();s.__VUE__=!0;const{insert:n,remove:i,patchProp:l,createElement:o,createText:a,createComment:c,setText:u,setElementText:d,parentNode:g,nextSibling:p,setScopeId:m=ct,insertStaticContent:T}=t,k=(f,y,w,S=null,L=null,E=null,N=void 0,O=null,j=!!y.dynamicChildren)=>{if(f===y)return;f&&!Xt(f,y)&&(S=de(f),M(f,L,E,!0),f=null),y.patchFlag===-2&&(j=!1,y.dynamicChildren=null);const{type:I,ref:ne,shapeFlag:K}=y;switch(I){case to:Z(f,y,w,S);break;case Dt:V(f,y,w,S);break;case Ps:f==null&&F(y,w,S,N);break;case Q:C(f,y,w,S,L,E,N,O,j);break;default:K&1?D(f,y,w,S,L,E,N,O,j):K&6?G(f,y,w,S,L,E,N,O,j):(K&64||K&128)&&I.process(f,y,w,S,L,E,N,O,j,X)}ne!=null&&L&&Vs(ne,f&&f.ref,E,y||f,!y)},Z=(f,y,w,S)=>{if(f==null)n(y.el=a(y.children),w,S);else{const L=y.el=f.el;y.children!==f.children&&u(L,y.children)}},V=(f,y,w,S)=>{f==null?n(y.el=c(y.children||""),w,S):y.el=f.el},F=(f,y,w,S)=>{[f.el,f.anchor]=T(f.children,y,w,S,f.el,f.anchor)},H=({el:f,anchor:y},w,S)=>{let L;for(;f&&f!==y;)L=p(f),n(f,w,S),f=L;n(y,w,S)},b=({el:f,anchor:y})=>{let w;for(;f&&f!==y;)w=p(f),i(f),f=w;i(y)},D=(f,y,w,S,L,E,N,O,j)=>{y.type==="svg"?N="svg":y.type==="math"&&(N="mathml"),f==null?te(y,w,S,L,E,N,O,j):se(f,y,L,E,N,O,j)},te=(f,y,w,S,L,E,N,O)=>{let j,I;const{props:ne,shapeFlag:K,transition:ee,dirs:le}=f;if(j=f.el=o(f.type,E,ne&&ne.is,ne),K&8?d(j,f.children):K&16&&Te(f.children,j,null,S,L,co(f,E),N,O),le&&jt(f,null,S,"created"),q(j,f,f.scopeId,N,S),ne){for(const Ie in ne)Ie!=="value"&&!gs(Ie)&&l(j,Ie,null,ne[Ie],E,S);"value"in ne&&l(j,"value",null,ne.value,E),(I=ne.onVnodeBeforeMount)&&gt(I,S,f)}le&&jt(f,null,S,"beforeMount");const me=bl(L,ee);me&&ee.beforeEnter(j),n(j,y,w),((I=ne&&ne.onVnodeMounted)||me||le)&&tt(()=>{I&&gt(I,S,f),me&&ee.enter(j),le&&jt(f,null,S,"mounted")},L)},q=(f,y,w,S,L)=>{if(w&&m(f,w),S)for(let E=0;E<S.length;E++)m(f,S[E]);if(L){let E=L.subTree;if(y===E||Rr(E.type)&&(E.ssContent===y||E.ssFallback===y)){const N=L.vnode;q(f,N,N.scopeId,N.slotScopeIds,L.parent)}}},Te=(f,y,w,S,L,E,N,O,j=0)=>{for(let I=j;I<f.length;I++){const ne=f[I]=O?Et(f[I]):yt(f[I]);k(null,ne,y,w,S,L,E,N,O)}},se=(f,y,w,S,L,E,N)=>{const O=y.el=f.el;let{patchFlag:j,dynamicChildren:I,dirs:ne}=y;j|=f.patchFlag&16;const K=f.props||Le,ee=y.props||Le;let le;if(w&&Ft(w,!1),(le=ee.onVnodeBeforeUpdate)&&gt(le,w,y,f),ne&&jt(y,f,w,"beforeUpdate"),w&&Ft(w,!0),(K.innerHTML&&ee.innerHTML==null||K.textContent&&ee.textContent==null)&&d(O,""),I?W(f.dynamicChildren,I,O,w,S,co(y,L),E):N||ie(f,y,O,null,w,S,co(y,L),E,!1),j>0){if(j&16)re(O,K,ee,w,L);else if(j&2&&K.class!==ee.class&&l(O,"class",null,ee.class,L),j&4&&l(O,"style",K.style,ee.style,L),j&8){const me=y.dynamicProps;for(let Ie=0;Ie<me.length;Ie++){const Ce=me[Ie],Xe=K[Ce],Ue=ee[Ce];(Ue!==Xe||Ce==="value")&&l(O,Ce,Xe,Ue,L,w)}}j&1&&f.children!==y.children&&d(O,y.children)}else!N&&I==null&&re(O,K,ee,w,L);((le=ee.onVnodeUpdated)||ne)&&tt(()=>{le&&gt(le,w,y,f),ne&&jt(y,f,w,"updated")},S)},W=(f,y,w,S,L,E,N)=>{for(let O=0;O<y.length;O++){const j=f[O],I=y[O],ne=j.el&&(j.type===Q||!Xt(j,I)||j.shapeFlag&70)?g(j.el):w;k(j,I,ne,null,S,L,E,N,!0)}},re=(f,y,w,S,L)=>{if(y!==w){if(y!==Le)for(const E in y)!gs(E)&&!(E in w)&&l(f,E,y[E],null,L,S);for(const E in w){if(gs(E))continue;const N=w[E],O=y[E];N!==O&&E!=="value"&&l(f,E,O,N,L,S)}"value"in w&&l(f,"value",y.value,w.value,L)}},C=(f,y,w,S,L,E,N,O,j)=>{const I=y.el=f?f.el:a(""),ne=y.anchor=f?f.anchor:a("");let{patchFlag:K,dynamicChildren:ee,slotScopeIds:le}=y;le&&(O=O?O.concat(le):le),f==null?(n(I,w,S),n(ne,w,S),Te(y.children||[],w,ne,L,E,N,O,j)):K>0&&K&64&&ee&&f.dynamicChildren?(W(f.dynamicChildren,ee,w,L,E,N,O),(y.key!=null||L&&y===L.subTree)&&Mr(f,y,!0)):ie(f,y,w,ne,L,E,N,O,j)},G=(f,y,w,S,L,E,N,O,j)=>{y.slotScopeIds=O,f==null?y.shapeFlag&512?L.ctx.activate(y,w,S,N,j):ue(y,w,S,L,E,N,j):pe(f,y,j)},ue=(f,y,w,S,L,E,N)=>{const O=f.component=Nl(f,S,L);if(vr(f)&&(O.ctx.renderer=X),Fl(O,!1,N),O.asyncDep){if(L&&L.registerDep(O,U,N),!f.el){const j=O.subTree=be(Dt);V(null,j,y,w)}}else U(O,f,y,w,L,E,N)},pe=(f,y,w)=>{const S=y.component=f.component;if(El(f,y,w))if(S.asyncDep&&!S.asyncResolved){J(S,y,w);return}else S.next=y,S.update();else y.el=f.el,S.vnode=y},U=(f,y,w,S,L,E,N)=>{const O=()=>{if(f.isMounted){let{next:K,bu:ee,u:le,parent:me,vnode:Ie}=f;{const xe=Or(f);if(xe){K&&(K.el=Ie.el,J(f,K,N)),xe.asyncDep.then(()=>{f.isUnmounted||O()});return}}let Ce=K,Xe;Ft(f,!1),K?(K.el=Ie.el,J(f,K,N)):K=Ie,ee&&Ds(ee),(Xe=K.props&&K.props.onVnodeBeforeUpdate)&&gt(Xe,me,K,Ie),Ft(f,!0);const Ue=uo(f),at=f.subTree;f.subTree=Ue,k(at,Ue,g(at.el),de(at),f,L,E),K.el=Ue.el,Ce===null&&Al(f,Ue.el),le&&tt(le,L),(Xe=K.props&&K.props.onVnodeUpdated)&&tt(()=>gt(Xe,me,K,Ie),L)}else{let K;const{el:ee,props:le}=y,{bm:me,m:Ie,parent:Ce,root:Xe,type:Ue}=f,at=ys(y);if(Ft(f,!1),me&&Ds(me),!at&&(K=le&&le.onVnodeBeforeMount)&&gt(K,Ce,y),Ft(f,!0),ee&&Ze){const xe=()=>{f.subTree=uo(f),Ze(ee,f.subTree,f,L,null)};at&&Ue.__asyncHydrate?Ue.__asyncHydrate(ee,f,xe):xe()}else{Xe.ce&&Xe.ce._injectChildStyle(Ue);const xe=f.subTree=uo(f);k(null,xe,w,S,f,L,E),y.el=xe.el}if(Ie&&tt(Ie,L),!at&&(K=le&&le.onVnodeMounted)){const xe=y;tt(()=>gt(K,Ce,xe),L)}(y.shapeFlag&256||Ce&&ys(Ce.vnode)&&Ce.vnode.shapeFlag&256)&&f.a&&tt(f.a,L),f.isMounted=!0,y=w=S=null}};f.scope.on();const j=f.effect=new Kn(O);f.scope.off();const I=f.update=j.run.bind(j),ne=f.job=j.runIfDirty.bind(j);ne.i=f,ne.id=f.uid,j.scheduler=()=>Vo(ne),Ft(f,!0),I()},J=(f,y,w)=>{y.component=f;const S=f.vnode.props;f.vnode=y,f.next=null,fl(f,y.props,S,w),yl(f,y.children,w),Rt(),xo(f),Nt()},ie=(f,y,w,S,L,E,N,O,j=!1)=>{const I=f&&f.children,ne=f?f.shapeFlag:0,K=y.children,{patchFlag:ee,shapeFlag:le}=y;if(ee>0){if(ee&128){je(I,K,w,S,L,E,N,O,j);return}else if(ee&256){ve(I,K,w,S,L,E,N,O,j);return}}le&8?(ne&16&&P(I,L,E),K!==I&&d(w,K)):ne&16?le&16?je(I,K,w,S,L,E,N,O,j):P(I,L,E,!0):(ne&8&&d(w,""),le&16&&Te(K,w,S,L,E,N,O,j))},ve=(f,y,w,S,L,E,N,O,j)=>{f=f||xt,y=y||xt;const I=f.length,ne=y.length,K=Math.min(I,ne);let ee;for(ee=0;ee<K;ee++){const le=y[ee]=j?Et(y[ee]):yt(y[ee]);k(f[ee],le,w,null,L,E,N,O,j)}I>ne?P(f,L,E,!0,!1,K):Te(y,w,S,L,E,N,O,j,K)},je=(f,y,w,S,L,E,N,O,j)=>{let I=0;const ne=y.length;let K=f.length-1,ee=ne-1;for(;I<=K&&I<=ee;){const le=f[I],me=y[I]=j?Et(y[I]):yt(y[I]);if(Xt(le,me))k(le,me,w,null,L,E,N,O,j);else break;I++}for(;I<=K&&I<=ee;){const le=f[K],me=y[ee]=j?Et(y[ee]):yt(y[ee]);if(Xt(le,me))k(le,me,w,null,L,E,N,O,j);else break;K--,ee--}if(I>K){if(I<=ee){const le=ee+1,me=le<ne?y[le].el:S;for(;I<=ee;)k(null,y[I]=j?Et(y[I]):yt(y[I]),w,me,L,E,N,O,j),I++}}else if(I>ee)for(;I<=K;)M(f[I],L,E,!0),I++;else{const le=I,me=I,Ie=new Map;for(I=me;I<=ee;I++){const et=y[I]=j?Et(y[I]):yt(y[I]);et.key!=null&&Ie.set(et.key,I)}let Ce,Xe=0;const Ue=ee-me+1;let at=!1,xe=0;const ls=new Array(Ue);for(I=0;I<Ue;I++)ls[I]=0;for(I=le;I<=K;I++){const et=f[I];if(Xe>=Ue){M(et,L,E,!0);continue}let ft;if(et.key!=null)ft=Ie.get(et.key);else for(Ce=me;Ce<=ee;Ce++)if(ls[Ce-me]===0&&Xt(et,y[Ce])){ft=Ce;break}ft===void 0?M(et,L,E,!0):(ls[ft-me]=I+1,ft>=xe?xe=ft:at=!0,k(et,y[ft],w,null,L,E,N,O,j),Xe++)}const Go=at?$l(ls):xt;for(Ce=Go.length-1,I=Ue-1;I>=0;I--){const et=me+I,ft=y[et],Yo=et+1<ne?y[et+1].el:S;ls[I]===0?k(null,ft,w,Yo,L,E,N,O,j):at&&(Ce<0||I!==Go[Ce]?De(ft,w,Yo,2):Ce--)}}},De=(f,y,w,S,L=null)=>{const{el:E,type:N,transition:O,children:j,shapeFlag:I}=f;if(I&6){De(f.component.subTree,y,w,S);return}if(I&128){f.suspense.move(y,w,S);return}if(I&64){N.move(f,y,w,X);return}if(N===Q){n(E,y,w);for(let K=0;K<j.length;K++)De(j[K],y,w,S);n(f.anchor,y,w);return}if(N===Ps){H(f,y,w);return}if(S!==2&&I&1&&O)if(S===0)O.beforeEnter(E),n(E,y,w),tt(()=>O.enter(E),L);else{const{leave:K,delayLeave:ee,afterLeave:le}=O,me=()=>n(E,y,w),Ie=()=>{K(E,()=>{me(),le&&le()})};ee?ee(E,me,Ie):Ie()}else n(E,y,w)},M=(f,y,w,S=!1,L=!1)=>{const{type:E,props:N,ref:O,children:j,dynamicChildren:I,shapeFlag:ne,patchFlag:K,dirs:ee,cacheIndex:le}=f;if(K===-2&&(L=!1),O!=null&&Vs(O,null,w,f,!0),le!=null&&(y.renderCache[le]=void 0),ne&256){y.ctx.deactivate(f);return}const me=ne&1&&ee,Ie=!ys(f);let Ce;if(Ie&&(Ce=N&&N.onVnodeBeforeUnmount)&&gt(Ce,y,f),ne&6)A(f.component,w,S);else{if(ne&128){f.suspense.unmount(w,S);return}me&&jt(f,null,y,"beforeUnmount"),ne&64?f.type.remove(f,y,w,X,S):I&&!I.hasOnce&&(E!==Q||K>0&&K&64)?P(I,y,w,!1,!0):(E===Q&&K&384||!L&&ne&16)&&P(j,y,w),S&&z(f)}(Ie&&(Ce=N&&N.onVnodeUnmounted)||me)&&tt(()=>{Ce&&gt(Ce,y,f),me&&jt(f,null,y,"unmounted")},w)},z=f=>{const{type:y,el:w,anchor:S,transition:L}=f;if(y===Q){fe(w,S);return}if(y===Ps){b(f);return}const E=()=>{i(w),L&&!L.persisted&&L.afterLeave&&L.afterLeave()};if(f.shapeFlag&1&&L&&!L.persisted){const{leave:N,delayLeave:O}=L,j=()=>N(w,E);O?O(f.el,E,j):j()}else E()},fe=(f,y)=>{let w;for(;f!==y;)w=p(f),i(f),f=w;i(y)},A=(f,y,w)=>{const{bum:S,scope:L,job:E,subTree:N,um:O,m:j,a:I}=f;ln(j),ln(I),S&&Ds(S),L.stop(),E&&(E.flags|=8,M(N,f,y,w)),O&&tt(O,y),tt(()=>{f.isUnmounted=!0},y),y&&y.pendingBranch&&!y.isUnmounted&&f.asyncDep&&!f.asyncResolved&&f.suspenseId===y.pendingId&&(y.deps--,y.deps===0&&y.resolve())},P=(f,y,w,S=!1,L=!1,E=0)=>{for(let N=E;N<f.length;N++)M(f[N],y,w,S,L)},de=f=>{if(f.shapeFlag&6)return de(f.component.subTree);if(f.shapeFlag&128)return f.suspense.next();const y=p(f.anchor||f.el),w=y&&y[Bi];return w?p(w):y};let R=!1;const Y=(f,y,w)=>{f==null?y._vnode&&M(y._vnode,null,null,!0):k(y._vnode||null,f,y,null,null,null,w),y._vnode=f,R||(R=!0,xo(),cr(),R=!1)},X={p:k,um:M,m:De,r:z,mt:ue,mc:Te,pc:ie,pbc:W,n:de,o:t};let Ae,Ze;return e&&([Ae,Ze]=e(X)),{render:Y,hydrate:Ae,createApp:cl(Y,Ae)}}function co({type:t,props:e},s){return s==="svg"&&t==="foreignObject"||s==="mathml"&&t==="annotation-xml"&&e&&e.encoding&&e.encoding.includes("html")?void 0:s}function Ft({effect:t,job:e},s){s?(t.flags|=32,e.flags|=4):(t.flags&=-33,e.flags&=-5)}function bl(t,e){return(!t||t&&!t.pendingBranch)&&e&&!e.persisted}function Mr(t,e,s=!1){const n=t.children,i=e.children;if(oe(n)&&oe(i))for(let l=0;l<n.length;l++){const o=n[l];let a=i[l];a.shapeFlag&1&&!a.dynamicChildren&&((a.patchFlag<=0||a.patchFlag===32)&&(a=i[l]=Et(i[l]),a.el=o.el),!s&&a.patchFlag!==-2&&Mr(o,a)),a.type===to&&(a.el=o.el)}}function $l(t){const e=t.slice(),s=[0];let n,i,l,o,a;const c=t.length;for(n=0;n<c;n++){const u=t[n];if(u!==0){if(i=s[s.length-1],t[i]<u){e[n]=i,s.push(n);continue}for(l=0,o=s.length-1;l<o;)a=l+o>>1,t[s[a]]<u?l=a+1:o=a;u<t[s[l]]&&(l>0&&(e[n]=s[l-1]),s[l]=n)}}for(l=s.length,o=s[l-1];l-- >0;)s[l]=o,o=e[o];return s}function Or(t){const e=t.subTree.component;if(e)return e.asyncDep&&!e.asyncResolved?e:Or(e)}function ln(t){if(t)for(let e=0;e<t.length;e++)t[e].flags|=8}const wl=Symbol.for("v-scx"),Cl=()=>ye(wl);function Qe(t,e,s){return Dr(t,e,s)}function Dr(t,e,s=Le){const{immediate:n,deep:i,flush:l,once:o}=s,a=Re({},s),c=e&&n||!e&&l!=="post";let u;if(_s){if(l==="sync"){const m=Cl();u=m.__watcherHandles||(m.__watcherHandles=[])}else if(!c){const m=()=>{};return m.stop=ct,m.resume=ct,m.pause=ct,m}}const d=Fe;a.call=(m,T,k)=>dt(m,d,T,k);let g=!1;l==="post"?a.scheduler=m=>{tt(m,d&&d.suspense)}:l!=="sync"&&(g=!0,a.scheduler=(m,T)=>{T?m():Vo(m)}),a.augmentJob=m=>{e&&(m.flags|=4),g&&(m.flags|=2,d&&(m.id=d.uid,m.i=d))};const p=Ni(t,e,a);return _s&&(u?u.push(p):c&&p()),p}function Tl(t,e,s){const n=this.proxy,i=Pe(t)?t.includes(".")?Pr(n,t):()=>n[t]:t.bind(n,n);let l;ce(e)?l=e:(l=e.handler,s=e);const o=Es(this),a=Dr(i,l.bind(n),s);return o(),a}function Pr(t,e){const s=e.split(".");return()=>{let n=t;for(let i=0;i<s.length&&n;i++)n=n[s[i]];return n}}const _l=(t,e)=>e==="modelValue"||e==="model-value"?t.modelModifiers:t[`${e}Modifiers`]||t[`${lt(e)}Modifiers`]||t[`${Ht(e)}Modifiers`];function Ll(t,e,...s){if(t.isUnmounted)return;const n=t.vnode.props||Le;let i=s;const l=e.startsWith("update:"),o=l&&_l(n,e.slice(7));o&&(o.trim&&(i=s.map(d=>Pe(d)?d.trim():d)),o.number&&(i=s.map(js)));let a,c=n[a=oo(e)]||n[a=oo(lt(e))];!c&&l&&(c=n[a=oo(Ht(e))]),c&&dt(c,t,6,i);const u=n[a+"Once"];if(u){if(!t.emitted)t.emitted={};else if(t.emitted[a])return;t.emitted[a]=!0,dt(u,t,6,i)}}function Hr(t,e,s=!1){const n=e.emitsCache,i=n.get(t);if(i!==void 0)return i;const l=t.emits;let o={},a=!1;if(!ce(t)){const c=u=>{const d=Hr(u,e,!0);d&&(a=!0,Re(o,d))};!s&&e.mixins.length&&e.mixins.forEach(c),t.extends&&c(t.extends),t.mixins&&t.mixins.forEach(c)}return!l&&!a?(Oe(t)&&n.set(t,null),null):(oe(l)?l.forEach(c=>o[c]=null):Re(o,l),Oe(t)&&n.set(t,o),o)}function eo(t,e){return!t||!Gs(e)?!1:(e=e.slice(2).replace(/Once$/,""),we(t,e[0].toLowerCase()+e.slice(1))||we(t,Ht(e))||we(t,e))}function uo(t){const{type:e,vnode:s,proxy:n,withProxy:i,propsOptions:[l],slots:o,attrs:a,emit:c,render:u,renderCache:d,props:g,data:p,setupState:m,ctx:T,inheritAttrs:k}=t,Z=Bs(t);let V,F;try{if(s.shapeFlag&4){const b=i||n,D=b;V=yt(u.call(D,b,d,g,m,p,T)),F=a}else{const b=e;V=yt(b.length>1?b(g,{attrs:a,slots:o,emit:c}):b(g,null)),F=e.props?a:Sl(a)}}catch(b){ms.length=0,Xs(b,t,1),V=be(Dt)}let H=V;if(F&&k!==!1){const b=Object.keys(F),{shapeFlag:D}=H;b.length&&D&7&&(l&&b.some(Io)&&(F=kl(F,l)),H=Gt(H,F,!1,!0))}return s.dirs&&(H=Gt(H,null,!1,!0),H.dirs=H.dirs?H.dirs.concat(s.dirs):s.dirs),s.transition&&Cs(H,s.transition),V=H,Bs(Z),V}const Sl=t=>{let e;for(const s in t)(s==="class"||s==="style"||Gs(s))&&((e||(e={}))[s]=t[s]);return e},kl=(t,e)=>{const s={};for(const n in t)(!Io(n)||!(n.slice(9)in e))&&(s[n]=t[n]);return s};function El(t,e,s){const{props:n,children:i,component:l}=t,{props:o,children:a,patchFlag:c}=e,u=l.emitsOptions;if(e.dirs||e.transition)return!0;if(s&&c>=0){if(c&1024)return!0;if(c&16)return n?an(n,o,u):!!o;if(c&8){const d=e.dynamicProps;for(let g=0;g<d.length;g++){const p=d[g];if(o[p]!==n[p]&&!eo(u,p))return!0}}}else return(i||a)&&(!a||!a.$stable)?!0:n===o?!1:n?o?an(n,o,u):!0:!!o;return!1}function an(t,e,s){const n=Object.keys(e);if(n.length!==Object.keys(t).length)return!0;for(let i=0;i<n.length;i++){const l=n[i];if(e[l]!==t[l]&&!eo(s,l))return!0}return!1}function Al({vnode:t,parent:e},s){for(;e;){const n=e.subTree;if(n.suspense&&n.suspense.activeBranch===t&&(n.el=t.el),n===t)(t=e.vnode).el=s,e=e.parent;else break}}const Rr=t=>t.__isSuspense;function Il(t,e){e&&e.pendingBranch?oe(t)?e.effects.push(...t):e.effects.push(t):Ui(t)}const Q=Symbol.for("v-fgt"),to=Symbol.for("v-txt"),Dt=Symbol.for("v-cmt"),Ps=Symbol.for("v-stc"),ms=[];let ot=null;function v(t=!1){ms.push(ot=t?null:[])}function Ml(){ms.pop(),ot=ms[ms.length-1]||null}let Ts=1;function cn(t,e=!1){Ts+=t,t<0&&ot&&e&&(ot.hasOnce=!0)}function Nr(t){return t.dynamicChildren=Ts>0?ot||xt:null,Ml(),Ts>0&&ot&&ot.push(t),t}function h(t,e,s,n,i,l){return Nr(r(t,e,s,n,i,l,!0))}function It(t,e,s,n,i){return Nr(be(t,e,s,n,i,!0))}function jr(t){return t?t.__v_isVNode===!0:!1}function Xt(t,e){return t.type===e.type&&t.key===e.key}const Fr=({key:t})=>t??null,Hs=({ref:t,ref_key:e,ref_for:s})=>(typeof t=="number"&&(t=""+t),t!=null?Pe(t)||Je(t)||ce(t)?{i:qe,r:t,k:e,f:!!s}:t:null);function r(t,e=null,s=null,n=0,i=null,l=t===Q?0:1,o=!1,a=!1){const c={__v_isVNode:!0,__v_skip:!0,type:t,props:e,key:e&&Fr(e),ref:e&&Hs(e),scopeId:dr,slotScopeIds:null,children:s,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:l,patchFlag:n,dynamicProps:i,dynamicChildren:null,appContext:null,ctx:qe};return a?(Wo(c,s),l&128&&t.normalize(c)):s&&(c.shapeFlag|=Pe(s)?8:16),Ts>0&&!o&&ot&&(c.patchFlag>0||l&6)&&c.patchFlag!==32&&ot.push(c),c}const be=Ol;function Ol(t,e=null,s=null,n=0,i=null,l=!1){if((!t||t===mr)&&(t=Dt),jr(t)){const a=Gt(t,e,!0);return s&&Wo(a,s),Ts>0&&!l&&ot&&(a.shapeFlag&6?ot[ot.indexOf(t)]=a:ot.push(a)),a.patchFlag=-2,a}if(Kl(t)&&(t=t.__vccOpts),e){e=Dl(e);let{class:a,style:c}=e;a&&!Pe(a)&&(e.class=ae(a)),Oe(c)&&(Bo(c)&&!oe(c)&&(c=Re({},c)),e.style=Ot(c))}const o=Pe(t)?1:Rr(t)?128:Vi(t)?64:Oe(t)?4:ce(t)?2:0;return r(t,e,s,n,i,o,l,!0)}function Dl(t){return t?Bo(t)||_r(t)?Re({},t):t:null}function Gt(t,e,s=!1,n=!1){const{props:i,ref:l,patchFlag:o,children:a,transition:c}=t,u=e?Pl(i||{},e):i,d={__v_isVNode:!0,__v_skip:!0,type:t.type,props:u,key:u&&Fr(u),ref:e&&e.ref?s&&l?oe(l)?l.concat(Hs(e)):[l,Hs(e)]:Hs(e):l,scopeId:t.scopeId,slotScopeIds:t.slotScopeIds,children:a,target:t.target,targetStart:t.targetStart,targetAnchor:t.targetAnchor,staticCount:t.staticCount,shapeFlag:t.shapeFlag,patchFlag:e&&t.type!==Q?o===-1?16:o|16:o,dynamicProps:t.dynamicProps,dynamicChildren:t.dynamicChildren,appContext:t.appContext,dirs:t.dirs,transition:c,component:t.component,suspense:t.suspense,ssContent:t.ssContent&&Gt(t.ssContent),ssFallback:t.ssFallback&&Gt(t.ssFallback),el:t.el,anchor:t.anchor,ctx:t.ctx,ce:t.ce};return c&&n&&Cs(d,c.clone(d)),d}function Ge(t=" ",e=0){return be(to,null,t,e)}function un(t,e){const s=be(Ps,null,t);return s.staticCount=e,s}function x(t="",e=!1){return e?(v(),It(Dt,null,t)):be(Dt,null,t)}function yt(t){return t==null||typeof t=="boolean"?be(Dt):oe(t)?be(Q,null,t.slice()):jr(t)?Et(t):be(to,null,String(t))}function Et(t){return t.el===null&&t.patchFlag!==-1||t.memo?t:Gt(t)}function Wo(t,e){let s=0;const{shapeFlag:n}=t;if(e==null)e=null;else if(oe(e))s=16;else if(typeof e=="object")if(n&65){const i=e.default;i&&(i._c&&(i._d=!1),Wo(t,i()),i._c&&(i._d=!0));return}else{s=32;const i=e._;!i&&!_r(e)?e._ctx=qe:i===3&&qe&&(qe.slots._===1?e._=1:(e._=2,t.patchFlag|=1024))}else ce(e)?(e={default:e,_ctx:qe},s=32):(e=String(e),n&64?(s=16,e=[Ge(e)]):s=8);t.children=e,t.shapeFlag|=s}function Pl(...t){const e={};for(let s=0;s<t.length;s++){const n=t[s];for(const i in n)if(i==="class")e.class!==n.class&&(e.class=ae([e.class,n.class]));else if(i==="style")e.style=Ot([e.style,n.style]);else if(Gs(i)){const l=e[i],o=n[i];o&&l!==o&&!(oe(l)&&l.includes(o))&&(e[i]=l?[].concat(l,o):o)}else i!==""&&(e[i]=n[i])}return e}function gt(t,e,s,n=null){dt(t,e,7,[s,n])}const Hl=wr();let Rl=0;function Nl(t,e,s){const n=t.type,i=(e?e.appContext:t.appContext)||Hl,l={uid:Rl++,vnode:t,type:n,parent:e,appContext:i,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new ci(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(i.provides),ids:e?e.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:Sr(n,i),emitsOptions:Hr(n,i),emit:null,emitted:null,propsDefaults:Le,inheritAttrs:n.inheritAttrs,ctx:Le,data:Le,props:Le,attrs:Le,slots:Le,refs:Le,setupState:Le,setupContext:null,suspense:s,suspenseId:s?s.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return l.ctx={_:l},l.root=e?e.root:l,l.emit=Ll.bind(null,l),t.ce&&t.ce(l),l}let Fe=null;const jl=()=>Fe||qe;let Ks,Lo;{const t=Qs(),e=(s,n)=>{let i;return(i=t[s])||(i=t[s]=[]),i.push(n),l=>{i.length>1?i.forEach(o=>o(l)):i[0](l)}};Ks=e("__VUE_INSTANCE_SETTERS__",s=>Fe=s),Lo=e("__VUE_SSR_SETTERS__",s=>_s=s)}const Es=t=>{const e=Fe;return Ks(t),t.scope.on(),()=>{t.scope.off(),Ks(e)}},dn=()=>{Fe&&Fe.scope.off(),Ks(null)};function Ur(t){return t.vnode.shapeFlag&4}let _s=!1;function Fl(t,e=!1,s=!1){e&&Lo(e);const{props:n,children:i}=t.vnode,l=Ur(t);dl(t,n,l,e),vl(t,i,s);const o=l?Ul(t,e):void 0;return e&&Lo(!1),o}function Ul(t,e){const s=t.type;t.accessCache=Object.create(null),t.proxy=new Proxy(t.ctx,sl);const{setup:n}=s;if(n){Rt();const i=t.setupContext=n.length>1?Vl(t):null,l=Es(t),o=Ss(n,t,0,[t.props,i]),a=Nn(o);if(Nt(),l(),(a||t.sp)&&!ys(t)&&pr(t),a){if(o.then(dn,dn),e)return o.then(c=>{fn(t,c,e)}).catch(c=>{Xs(c,t,0)});t.asyncDep=o}else fn(t,o,e)}else Br(t,e)}function fn(t,e,s){ce(e)?t.type.__ssrInlineRender?t.ssrRender=e:t.render=e:Oe(e)&&(t.setupState=ir(e)),Br(t,s)}let gn;function Br(t,e,s){const n=t.type;if(!t.render){if(!e&&gn&&!n.render){const i=n.template||Ko(t).template;if(i){const{isCustomElement:l,compilerOptions:o}=t.appContext.config,{delimiters:a,compilerOptions:c}=n,u=Re(Re({isCustomElement:l,delimiters:a},o),c);n.render=gn(i,u)}}t.render=n.render||ct}{const i=Es(t);Rt();try{ol(t)}finally{Nt(),i()}}}const Bl={get(t,e){return Be(t,"get",""),t[e]}};function Vl(t){const e=s=>{t.exposed=s||{}};return{attrs:new Proxy(t.attrs,Bl),slots:t.slots,emit:t.emit,expose:e}}function so(t){return t.exposed?t.exposeProxy||(t.exposeProxy=new Proxy(ir(rr(t.exposed)),{get(e,s){if(s in e)return e[s];if(s in hs)return hs[s](t)},has(e,s){return s in e||s in hs}})):t.proxy}function Jl(t,e=!0){return ce(t)?t.displayName||t.name:t.name||e&&t.__name}function Kl(t){return ce(t)&&"__vccOpts"in t}const Se=(t,e)=>Hi(t,e,_s),zl="3.5.13";/**
* @vue/runtime-dom v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let So;const pn=typeof window<"u"&&window.trustedTypes;if(pn)try{So=pn.createPolicy("vue",{createHTML:t=>t})}catch{}const Vr=So?t=>So.createHTML(t):t=>t,Wl="http://www.w3.org/2000/svg",Gl="http://www.w3.org/1998/Math/MathML",bt=typeof document<"u"?document:null,vn=bt&&bt.createElement("template"),Yl={insert:(t,e,s)=>{e.insertBefore(t,s||null)},remove:t=>{const e=t.parentNode;e&&e.removeChild(t)},createElement:(t,e,s,n)=>{const i=e==="svg"?bt.createElementNS(Wl,t):e==="mathml"?bt.createElementNS(Gl,t):s?bt.createElement(t,{is:s}):bt.createElement(t);return t==="select"&&n&&n.multiple!=null&&i.setAttribute("multiple",n.multiple),i},createText:t=>bt.createTextNode(t),createComment:t=>bt.createComment(t),setText:(t,e)=>{t.nodeValue=e},setElementText:(t,e)=>{t.textContent=e},parentNode:t=>t.parentNode,nextSibling:t=>t.nextSibling,querySelector:t=>bt.querySelector(t),setScopeId(t,e){t.setAttribute(e,"")},insertStaticContent(t,e,s,n,i,l){const o=s?s.previousSibling:e.lastChild;if(i&&(i===l||i.nextSibling))for(;e.insertBefore(i.cloneNode(!0),s),!(i===l||!(i=i.nextSibling)););else{vn.innerHTML=Vr(n==="svg"?`<svg>${t}</svg>`:n==="mathml"?`<math>${t}</math>`:t);const a=vn.content;if(n==="svg"||n==="mathml"){const c=a.firstChild;for(;c.firstChild;)a.appendChild(c.firstChild);a.removeChild(c)}e.insertBefore(a,s)}return[o?o.nextSibling:e.firstChild,s?s.previousSibling:e.lastChild]}},Lt="transition",cs="animation",ns=Symbol("_vtc"),Jr={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},ql=Re({},Ki,Jr),Ut=(t,e=[])=>{oe(t)?t.forEach(s=>s(...e)):t&&t(...e)},yn=t=>t?oe(t)?t.some(e=>e.length>1):t.length>1:!1;function Ql(t){const e={};for(const C in t)C in Jr||(e[C]=t[C]);if(t.css===!1)return e;const{name:s="v",type:n,duration:i,enterFromClass:l=`${s}-enter-from`,enterActiveClass:o=`${s}-enter-active`,enterToClass:a=`${s}-enter-to`,appearFromClass:c=l,appearActiveClass:u=o,appearToClass:d=a,leaveFromClass:g=`${s}-leave-from`,leaveActiveClass:p=`${s}-leave-active`,leaveToClass:m=`${s}-leave-to`}=t,T=Zl(i),k=T&&T[0],Z=T&&T[1],{onBeforeEnter:V,onEnter:F,onEnterCancelled:H,onLeave:b,onLeaveCancelled:D,onBeforeAppear:te=V,onAppear:q=F,onAppearCancelled:Te=H}=e,se=(C,G,ue,pe)=>{C._enterCancelled=pe,St(C,G?d:a),St(C,G?u:o),ue&&ue()},W=(C,G)=>{C._isLeaving=!1,St(C,g),St(C,m),St(C,p),G&&G()},re=C=>(G,ue)=>{const pe=C?q:F,U=()=>se(G,C,ue);Ut(pe,[G,U]),hn(()=>{St(G,C?c:l),pt(G,C?d:a),yn(pe)||mn(G,n,k,U)})};return Re(e,{onBeforeEnter(C){Ut(V,[C]),pt(C,l),pt(C,o)},onBeforeAppear(C){Ut(te,[C]),pt(C,c),pt(C,u)},onEnter:re(!1),onAppear:re(!0),onLeave(C,G){C._isLeaving=!0;const ue=()=>W(C,G);pt(C,g),C._enterCancelled?(pt(C,p),ko()):(ko(),pt(C,p)),hn(()=>{C._isLeaving&&(St(C,g),pt(C,m),yn(b)||mn(C,n,Z,ue))}),Ut(b,[C,ue])},onEnterCancelled(C){se(C,!1,void 0,!0),Ut(H,[C])},onAppearCancelled(C){se(C,!0,void 0,!0),Ut(Te,[C])},onLeaveCancelled(C){W(C),Ut(D,[C])}})}function Zl(t){if(t==null)return null;if(Oe(t))return[fo(t.enter),fo(t.leave)];{const e=fo(t);return[e,e]}}function fo(t){return ti(t)}function pt(t,e){e.split(/\s+/).forEach(s=>s&&t.classList.add(s)),(t[ns]||(t[ns]=new Set)).add(e)}function St(t,e){e.split(/\s+/).forEach(n=>n&&t.classList.remove(n));const s=t[ns];s&&(s.delete(e),s.size||(t[ns]=void 0))}function hn(t){requestAnimationFrame(()=>{requestAnimationFrame(t)})}let Xl=0;function mn(t,e,s,n){const i=t._endId=++Xl,l=()=>{i===t._endId&&n()};if(s!=null)return setTimeout(l,s);const{type:o,timeout:a,propCount:c}=Kr(t,e);if(!o)return n();const u=o+"end";let d=0;const g=()=>{t.removeEventListener(u,p),l()},p=m=>{m.target===t&&++d>=c&&g()};setTimeout(()=>{d<c&&g()},a+1),t.addEventListener(u,p)}function Kr(t,e){const s=window.getComputedStyle(t),n=T=>(s[T]||"").split(", "),i=n(`${Lt}Delay`),l=n(`${Lt}Duration`),o=bn(i,l),a=n(`${cs}Delay`),c=n(`${cs}Duration`),u=bn(a,c);let d=null,g=0,p=0;e===Lt?o>0&&(d=Lt,g=o,p=l.length):e===cs?u>0&&(d=cs,g=u,p=c.length):(g=Math.max(o,u),d=g>0?o>u?Lt:cs:null,p=d?d===Lt?l.length:c.length:0);const m=d===Lt&&/\b(transform|all)(,|$)/.test(n(`${Lt}Property`).toString());return{type:d,timeout:g,propCount:p,hasTransform:m}}function bn(t,e){for(;t.length<e.length;)t=t.concat(t);return Math.max(...e.map((s,n)=>$n(s)+$n(t[n])))}function $n(t){return t==="auto"?0:Number(t.slice(0,-1).replace(",","."))*1e3}function ko(){return document.body.offsetHeight}function xl(t,e,s){const n=t[ns];n&&(e=(e?[e,...n]:[...n]).join(" ")),e==null?t.removeAttribute("class"):s?t.setAttribute("class",e):t.className=e}const zs=Symbol("_vod"),zr=Symbol("_vsh"),us={beforeMount(t,{value:e},{transition:s}){t[zs]=t.style.display==="none"?"":t.style.display,s&&e?s.beforeEnter(t):ds(t,e)},mounted(t,{value:e},{transition:s}){s&&e&&s.enter(t)},updated(t,{value:e,oldValue:s},{transition:n}){!e!=!s&&(n?e?(n.beforeEnter(t),ds(t,!0),n.enter(t)):n.leave(t,()=>{ds(t,!1)}):ds(t,e))},beforeUnmount(t,{value:e}){ds(t,e)}};function ds(t,e){t.style.display=e?t[zs]:"none",t[zr]=!e}const ea=Symbol(""),ta=/(^|;)\s*display\s*:/;function sa(t,e,s){const n=t.style,i=Pe(s);let l=!1;if(s&&!i){if(e)if(Pe(e))for(const o of e.split(";")){const a=o.slice(0,o.indexOf(":")).trim();s[a]==null&&Rs(n,a,"")}else for(const o in e)s[o]==null&&Rs(n,o,"");for(const o in s)o==="display"&&(l=!0),Rs(n,o,s[o])}else if(i){if(e!==s){const o=n[ea];o&&(s+=";"+o),n.cssText=s,l=ta.test(s)}}else e&&t.removeAttribute("style");zs in t&&(t[zs]=l?n.display:"",t[zr]&&(n.display="none"))}const wn=/\s*!important$/;function Rs(t,e,s){if(oe(s))s.forEach(n=>Rs(t,e,n));else if(s==null&&(s=""),e.startsWith("--"))t.setProperty(e,s);else{const n=oa(t,e);wn.test(s)?t.setProperty(Ht(n),s.replace(wn,""),"important"):t[n]=s}}const Cn=["Webkit","Moz","ms"],go={};function oa(t,e){const s=go[e];if(s)return s;let n=lt(e);if(n!=="filter"&&n in t)return go[e]=n;n=qs(n);for(let i=0;i<Cn.length;i++){const l=Cn[i]+n;if(l in t)return go[e]=l}return e}const Tn="http://www.w3.org/1999/xlink";function _n(t,e,s,n,i,l=li(e)){n&&e.startsWith("xlink:")?s==null?t.removeAttributeNS(Tn,e.slice(6,e.length)):t.setAttributeNS(Tn,e,s):s==null||l&&!Bn(s)?t.removeAttribute(e):t.setAttribute(e,l?"":ht(s)?String(s):s)}function Ln(t,e,s,n,i){if(e==="innerHTML"||e==="textContent"){s!=null&&(t[e]=e==="innerHTML"?Vr(s):s);return}const l=t.tagName;if(e==="value"&&l!=="PROGRESS"&&!l.includes("-")){const a=l==="OPTION"?t.getAttribute("value")||"":t.value,c=s==null?t.type==="checkbox"?"on":"":String(s);(a!==c||!("_value"in t))&&(t.value=c),s==null&&t.removeAttribute(e),t._value=s;return}let o=!1;if(s===""||s==null){const a=typeof t[e];a==="boolean"?s=Bn(s):s==null&&a==="string"?(s="",o=!0):a==="number"&&(s=0,o=!0)}try{t[e]=s}catch{}o&&t.removeAttribute(i||e)}function Ct(t,e,s,n){t.addEventListener(e,s,n)}function na(t,e,s,n){t.removeEventListener(e,s,n)}const Sn=Symbol("_vei");function ra(t,e,s,n,i=null){const l=t[Sn]||(t[Sn]={}),o=l[e];if(n&&o)o.value=n;else{const[a,c]=ia(e);if(n){const u=l[e]=ca(n,i);Ct(t,a,u,c)}else o&&(na(t,a,o,c),l[e]=void 0)}}const kn=/(?:Once|Passive|Capture)$/;function ia(t){let e;if(kn.test(t)){e={};let n;for(;n=t.match(kn);)t=t.slice(0,t.length-n[0].length),e[n[0].toLowerCase()]=!0}return[t[2]===":"?t.slice(3):Ht(t.slice(2)),e]}let po=0;const la=Promise.resolve(),aa=()=>po||(la.then(()=>po=0),po=Date.now());function ca(t,e){const s=n=>{if(!n._vts)n._vts=Date.now();else if(n._vts<=s.attached)return;dt(ua(n,s.value),e,5,[n])};return s.value=t,s.attached=aa(),s}function ua(t,e){if(oe(e)){const s=t.stopImmediatePropagation;return t.stopImmediatePropagation=()=>{s.call(t),t._stopped=!0},e.map(n=>i=>!i._stopped&&n&&n(i))}else return e}const En=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&t.charCodeAt(2)>96&&t.charCodeAt(2)<123,da=(t,e,s,n,i,l)=>{const o=i==="svg";e==="class"?xl(t,n,o):e==="style"?sa(t,s,n):Gs(e)?Io(e)||ra(t,e,s,n,l):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):fa(t,e,n,o))?(Ln(t,e,n),!t.tagName.includes("-")&&(e==="value"||e==="checked"||e==="selected")&&_n(t,e,n,o,l,e!=="value")):t._isVueCE&&(/[A-Z]/.test(e)||!Pe(n))?Ln(t,lt(e),n,l,e):(e==="true-value"?t._trueValue=n:e==="false-value"&&(t._falseValue=n),_n(t,e,n,o))};function fa(t,e,s,n){if(n)return!!(e==="innerHTML"||e==="textContent"||e in t&&En(e)&&ce(s));if(e==="spellcheck"||e==="draggable"||e==="translate"||e==="form"||e==="list"&&t.tagName==="INPUT"||e==="type"&&t.tagName==="TEXTAREA")return!1;if(e==="width"||e==="height"){const i=t.tagName;if(i==="IMG"||i==="VIDEO"||i==="CANVAS"||i==="SOURCE")return!1}return En(e)&&Pe(s)?!1:e in t}const Wr=new WeakMap,Gr=new WeakMap,Ws=Symbol("_moveCb"),An=Symbol("_enterCb"),ga=t=>(delete t.props.mode,t),pa=ga({name:"TransitionGroup",props:Re({},ql,{tag:String,moveClass:String}),setup(t,{slots:e}){const s=jl(),n=Ji();let i,l;return hr(()=>{if(!i.length)return;const o=t.moveClass||`${t.name||"v"}-move`;if(!ba(i[0].el,s.vnode.el,o))return;i.forEach(ya),i.forEach(ha);const a=i.filter(ma);ko(),a.forEach(c=>{const u=c.el,d=u.style;pt(u,o),d.transform=d.webkitTransform=d.transitionDuration="";const g=u[Ws]=p=>{p&&p.target!==u||(!p||/transform$/.test(p.propertyName))&&(u.removeEventListener("transitionend",g),u[Ws]=null,St(u,o))};u.addEventListener("transitionend",g)})}),()=>{const o=$e(t),a=Ql(o);let c=o.tag||Q;if(i=[],l)for(let u=0;u<l.length;u++){const d=l[u];d.el&&d.el instanceof Element&&(i.push(d),Cs(d,$o(d,a,n,s)),Wr.set(d,d.el.getBoundingClientRect()))}l=e.default?gr(e.default()):[];for(let u=0;u<l.length;u++){const d=l[u];d.key!=null&&Cs(d,$o(d,a,n,s))}return be(c,null,l)}}}),va=pa;function ya(t){const e=t.el;e[Ws]&&e[Ws](),e[An]&&e[An]()}function ha(t){Gr.set(t,t.el.getBoundingClientRect())}function ma(t){const e=Wr.get(t),s=Gr.get(t),n=e.left-s.left,i=e.top-s.top;if(n||i){const l=t.el.style;return l.transform=l.webkitTransform=`translate(${n}px,${i}px)`,l.transitionDuration="0s",t}}function ba(t,e,s){const n=t.cloneNode(),i=t[ns];i&&i.forEach(a=>{a.split(/\s+/).forEach(c=>c&&n.classList.remove(c))}),s.split(/\s+/).forEach(a=>a&&n.classList.add(a)),n.style.display="none";const l=e.nodeType===1?e:e.parentNode;l.appendChild(n);const{hasTransform:o}=Kr(n);return l.removeChild(n),o}const Pt=t=>{const e=t.props["onUpdate:modelValue"]||!1;return oe(e)?s=>Ds(e,s):e};function $a(t){t.target.composing=!0}function In(t){const e=t.target;e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}const it=Symbol("_assign"),Ee={created(t,{modifiers:{lazy:e,trim:s,number:n}},i){t[it]=Pt(i);const l=n||i.props&&i.props.type==="number";Ct(t,e?"change":"input",o=>{if(o.target.composing)return;let a=t.value;s&&(a=a.trim()),l&&(a=js(a)),t[it](a)}),s&&Ct(t,"change",()=>{t.value=t.value.trim()}),e||(Ct(t,"compositionstart",$a),Ct(t,"compositionend",In),Ct(t,"change",In))},mounted(t,{value:e}){t.value=e??""},beforeUpdate(t,{value:e,oldValue:s,modifiers:{lazy:n,trim:i,number:l}},o){if(t[it]=Pt(o),t.composing)return;const a=(l||t.type==="number")&&!/^0\d/.test(t.value)?js(t.value):t.value,c=e??"";a!==c&&(document.activeElement===t&&t.type!=="range"&&(n&&e===s||i&&t.value.trim()===c)||(t.value=c))}},Ye={deep:!0,created(t,e,s){t[it]=Pt(s),Ct(t,"change",()=>{const n=t._modelValue,i=rs(t),l=t.checked,o=t[it];if(oe(n)){const a=Do(n,i),c=a!==-1;if(l&&!c)o(n.concat(i));else if(!l&&c){const u=[...n];u.splice(a,1),o(u)}}else if(is(n)){const a=new Set(n);l?a.add(i):a.delete(i),o(a)}else o(Yr(t,l))})},mounted:Mn,beforeUpdate(t,e,s){t[it]=Pt(s),Mn(t,e,s)}};function Mn(t,{value:e,oldValue:s},n){t._modelValue=e;let i;if(oe(e))i=Do(e,n.props.value)>-1;else if(is(e))i=e.has(n.props.value);else{if(e===s)return;i=zt(e,Yr(t,!0))}t.checked!==i&&(t.checked=i)}const Bt={created(t,{value:e},s){t.checked=zt(e,s.props.value),t[it]=Pt(s),Ct(t,"change",()=>{t[it](rs(t))})},beforeUpdate(t,{value:e,oldValue:s},n){t[it]=Pt(n),e!==s&&(t.checked=zt(e,n.props.value))}},Ne={deep:!0,created(t,{value:e,modifiers:{number:s}},n){const i=is(e);Ct(t,"change",()=>{const l=Array.prototype.filter.call(t.options,o=>o.selected).map(o=>s?js(rs(o)):rs(o));t[it](t.multiple?i?new Set(l):l:l[0]),t._assigning=!0,Tt(()=>{t._assigning=!1})}),t[it]=Pt(n)},mounted(t,{value:e}){On(t,e)},beforeUpdate(t,e,s){t[it]=Pt(s)},updated(t,{value:e}){t._assigning||On(t,e)}};function On(t,e){const s=t.multiple,n=oe(e);if(!(s&&!n&&!is(e))){for(let i=0,l=t.options.length;i<l;i++){const o=t.options[i],a=rs(o);if(s)if(n){const c=typeof a;c==="string"||c==="number"?o.selected=e.some(u=>String(u)===String(a)):o.selected=Do(e,a)>-1}else o.selected=e.has(a);else if(zt(rs(o),e)){t.selectedIndex!==i&&(t.selectedIndex=i);return}}!s&&t.selectedIndex!==-1&&(t.selectedIndex=-1)}}function rs(t){return"_value"in t?t._value:t.value}function Yr(t,e){const s=e?"_trueValue":"_falseValue";return s in t?t[s]:e}const wa=["ctrl","shift","alt","meta"],Ca={stop:t=>t.stopPropagation(),prevent:t=>t.preventDefault(),self:t=>t.target!==t.currentTarget,ctrl:t=>!t.ctrlKey,shift:t=>!t.shiftKey,alt:t=>!t.altKey,meta:t=>!t.metaKey,left:t=>"button"in t&&t.button!==0,middle:t=>"button"in t&&t.button!==1,right:t=>"button"in t&&t.button!==2,exact:(t,e)=>wa.some(s=>t[`${s}Key`]&&!e.includes(s))},Mt=(t,e)=>{const s=t._withMods||(t._withMods={}),n=e.join(".");return s[n]||(s[n]=(i,...l)=>{for(let o=0;o<e.length;o++){const a=Ca[e[o]];if(a&&a(i,e))return}return t(i,...l)})},Ta={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},Eo=(t,e)=>{const s=t._withKeys||(t._withKeys={}),n=e.join(".");return s[n]||(s[n]=i=>{if(!("key"in i))return;const l=Ht(i.key);if(e.some(o=>o===l||Ta[o]===l))return t(i)})},_a=Re({patchProp:da},Yl);let Dn;function La(){return Dn||(Dn=hl(_a))}const Pn=(...t)=>{const e=La().createApp(...t),{mount:s}=e;return e.mount=n=>{const i=ka(n);if(!i)return;const l=e._component;!ce(l)&&!l.render&&!l.template&&(l.template=i.innerHTML),i.nodeType===1&&(i.textContent="");const o=s(i,!1,Sa(i));return i instanceof Element&&(i.removeAttribute("v-cloak"),i.setAttribute("data-v-app","")),o},e};function Sa(t){if(t instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&t instanceof MathMLElement)return"mathml"}function ka(t){return Pe(t)?document.querySelector(t):t}const _e=(t,e)=>{const s=t.__vccOpts||t;for(const[n,i]of e)s[n]=i;return s},Ea=He({name:"MultiCategorySelector",props:{categories:{type:Array,required:!0},value:{type:Array,default:()=>[]},maxSelections:{type:Number,default:0}},emits:["update:value","change"],setup(t,{emit:e}){const s=$(!1),n=$(""),i=$([...t.value]),l=$(null),o=Se(()=>{if(!n.value)return t.categories;const m=n.value.toLowerCase();return t.categories.filter(T=>T.toLowerCase().includes(m))});Qe(()=>t.value,m=>{i.value=[...m]});const a=()=>{s.value=!0,n.value="",Tt(()=>{l.value&&l.value.focus()})},c=()=>{s.value=!1};return{isModalOpen:s,searchTerm:n,selectedCategories:i,filteredCategories:o,searchInput:l,openModal:a,closeModal:c,selectAll:()=>{i.value=[...o.value],t.maxSelections>0&&i.value.length>t.maxSelections&&(i.value=i.value.slice(0,t.maxSelections))},selectNone:()=>{i.value=[]},toggleCategory:m=>{const T=i.value.indexOf(m);if(T===-1){if(t.maxSelections>0&&i.value.length>=t.maxSelections)return;i.value.push(m)}else i.value.splice(T,1)},confirm:()=>{e("update:value",i.value),e("change",i.value),c()}}}}),Aa={class:"multi-category-selector"},Ia={class:"trigger-text"},Ma={key:0,class:"trigger-badge"},Oa={key:0,class:"selector-modal"},Da={class:"modal-content"},Pa={class:"modal-header"},Ha={class:"search-box"},Ra={class:"selection-actions"},Na={class:"selection-counter"},ja={class:"categories-list"},Fa=["onClick"],Ua={class:"checkbox"},Ba={key:0,class:"checkmark"},Va={class:"category-name"},Ja={key:0,class:"empty-result"},Ka={class:"modal-footer"};function za(t,e,s,n,i,l){return v(),h("div",Aa,[r("button",{onClick:e[0]||(e[0]=(...o)=>t.openModal&&t.openModal(...o)),class:ae(["selector-trigger",{"has-selections":t.selectedCategories.length>0}])},[e[8]||(e[8]=r("span",{class:"trigger-icon"},"🔍",-1)),r("span",Ia,_(t.selectedCategories.length>0?`已选择 ${t.selectedCategories.length} 个分类`:"选择分类范围"),1),t.selectedCategories.length>0?(v(),h("span",Ma,_(t.selectedCategories.length),1)):x("",!0)],2),t.isModalOpen?(v(),h("div",Oa,[r("div",{class:"modal-backdrop",onClick:e[1]||(e[1]=(...o)=>t.closeModal&&t.closeModal(...o))}),r("div",Da,[r("div",Pa,[e[9]||(e[9]=r("h3",null,"选择分类范围",-1)),r("button",{onClick:e[2]||(e[2]=(...o)=>t.closeModal&&t.closeModal(...o)),class:"close-btn"},"×")]),r("div",Ha,[B(r("input",{type:"text","onUpdate:modelValue":e[3]||(e[3]=o=>t.searchTerm=o),placeholder:"搜索分类...",class:"search-input",ref:"searchInput"},null,512),[[Ee,t.searchTerm]]),e[10]||(e[10]=r("span",{class:"search-icon"},"🔍",-1))]),r("div",Ra,[r("button",{onClick:e[4]||(e[4]=(...o)=>t.selectAll&&t.selectAll(...o)),class:"action-btn"},"全选"),r("button",{onClick:e[5]||(e[5]=(...o)=>t.selectNone&&t.selectNone(...o)),class:"action-btn"},"清空"),r("span",Na,"已选择 "+_(t.selectedCategories.length)+"/"+_(t.filteredCategories.length),1)]),r("div",ja,[(v(!0),h(Q,null,ge(t.filteredCategories,o=>(v(),h("div",{key:o,class:ae(["category-item",{selected:t.selectedCategories.includes(o)}]),onClick:a=>t.toggleCategory(o)},[r("span",Ua,[t.selectedCategories.includes(o)?(v(),h("span",Ba,"✓")):x("",!0)]),r("span",Va,_(o),1)],10,Fa))),128)),t.filteredCategories.length===0?(v(),h("div",Ja," 没有找到匹配的分类 ")):x("",!0)]),r("div",Ka,[r("button",{onClick:e[6]||(e[6]=(...o)=>t.confirm&&t.confirm(...o)),class:"primary-btn"},"确定"),r("button",{onClick:e[7]||(e[7]=(...o)=>t.closeModal&&t.closeModal(...o)),class:"cancel-btn"},"取消")])])])):x("",!0)])}const Wa=_e(Ea,[["render",za],["__scopeId","data-v-3dba2079"]]);const Ga=He({name:"DrawerForm",components:{MultiCategorySelector:Wa},emits:["draw-completed"],setup(t,{emit:e}){const s=ye("emitter"),n=ye("tagLibrary"),i=ye("tagDrawer"),l=$(3),o=$("all"),a=$("default"),c=$(!1),u=$([]),d=$(!1),g=$(!1),p=$(!1),m=$([]),T=$(null),k=$(!1),Z=Se(()=>{const W=n.getCurrentLibrary();return Object.keys(W||{})}),V=Se(()=>n.getLibraryNames().filter(W=>W!==a.value)),F=()=>{l.value<99&&l.value++},H=()=>{l.value>1&&l.value--},b=()=>{c.value=!c.value,c.value||(u.value=[])},D=async()=>{if(a.value)try{k.value=!0,await n.setCurrentLibrary(a.value),te(),m.value=n.getRecentLibraries(),o.value="all",u.value=[],s.emit("notification",{type:"success",message:`已切换到标签库: ${a.value}`})}catch(W){s.emit("notification",{type:"error",message:`切换标签库失败: ${W.message}`})}finally{k.value=!1}},te=()=>{const W=n.getCurrentLibrary();if(W){const re=Object.keys(W).length;let C=0;for(const G in W)Array.isArray(W[G])&&(C+=W[G].length);T.value={categoryCount:re,tagCount:C}}else T.value=null},q=async()=>{if(!g.value)try{p.value=!0;const W={count:l.value,categories:c.value?u.value:o.value==="all"?void 0:[o.value],ensureEachCategory:c.value&&u.value.length>1?d.value:!1},re=await i.draw(W);n.addToHistory(re,W),e("draw-completed",re),s.emit("tags-drawn",re),s.emit("notification",{type:"success",message:`成功抽取了 ${re.length} 个标签`})}catch(W){console.error("抽签失败:",W),s.emit("notification",{type:"error",message:`抽签失败: ${W.message}`})}finally{g.value=!1}},Te=()=>{l.value=3,o.value="all",c.value=!1,u.value=[],d.value=!1},se=W=>{W&&W!==a.value&&(a.value=W,D())};return Ke(()=>{const W=localStorage.getItem("library_settings");let re=null;if(W)try{re=JSON.parse(W).defaultLibrary}catch(G){console.error("加载库设置失败",G)}const C=n.getLibraryNames();C.length>0&&(a.value=re&&C.includes(re)?re:C[0],D()),m.value=n.getRecentLibraries(),te()}),{drawCount:l,selectedCategory:o,selectedLibrary:a,useMultiCategories:c,selectedCategories:u,ensureEachCategory:d,isDrawing:g,isGenerating:p,recentLibraries:m,currentLibraryInfo:T,isLibraryLoading:k,filteredLibraries:V,categories:Z,increaseCount:F,decreaseCount:H,toggleMultiCategoryMode:b,handleLibraryChange:D,drawTags:q,resetForm:Te,quickSelectLibrary:se}}}),Ya={class:"drawer-form"},qa={class:"form-content"},Qa={class:"section"},Za={class:"number-control"},Xa=["disabled"],xa={class:"number"},ec=["disabled"],tc={class:"section"},sc={class:"category-selection"},oc=["value"],nc={class:"category-mode-toggle"},rc={key:1,class:"balance-option"},ic={class:"section"},lc={class:"library-selection"},ac=["value"],cc=["value"],uc={key:0,class:"recent-libraries"},dc={class:"recent-chips"},fc=["onClick"],gc={key:1,class:"library-info"},pc={class:"info-item"},vc={class:"info-value"},yc={class:"info-item"},hc={class:"info-value"},mc={key:0,class:"loading-indicator"},bc={class:"button-group"},$c=["disabled"],wc={key:0,class:"button-spinner"},Cc={key:1,class:"button-icon"},Tc=["disabled"];function _c(t,e,s,n,i,l){const o=ke("multi-category-selector");return v(),h("div",Ya,[e[20]||(e[20]=r("div",{class:"panel-header"},[r("h3",{class:"panel-title"},"抽签设置")],-1)),r("div",qa,[r("div",Qa,[e[10]||(e[10]=r("h3",null,"抽取数量",-1)),r("div",Za,[r("button",{class:"control-btn",onClick:e[0]||(e[0]=(...a)=>t.decreaseCount&&t.decreaseCount(...a)),disabled:t.drawCount<=1},"-",8,Xa),r("span",xa,_(t.drawCount),1),r("button",{class:"control-btn",onClick:e[1]||(e[1]=(...a)=>t.increaseCount&&t.increaseCount(...a)),disabled:t.drawCount>=99},"+",8,ec)])]),r("div",tc,[e[13]||(e[13]=r("h3",null,"选择分类",-1)),r("div",sc,[t.useMultiCategories?x("",!0):B((v(),h("select",{key:0,"onUpdate:modelValue":e[2]||(e[2]=a=>t.selectedCategory=a),class:"form-select"},[e[11]||(e[11]=r("option",{value:"all"},"全部分类",-1)),(v(!0),h(Q,null,ge(t.categories,a=>(v(),h("option",{key:a,value:a},_(a),9,oc))),128))],512)),[[Ne,t.selectedCategory]]),r("div",nc,[r("button",{onClick:e[3]||(e[3]=(...a)=>t.toggleMultiCategoryMode&&t.toggleMultiCategoryMode(...a)),class:ae(["toggle-button",{active:t.useMultiCategories}])},_(t.useMultiCategories?"单分类模式":"多分类模式"),3)])]),t.useMultiCategories?(v(),It(o,{key:0,categories:t.categories,value:t.selectedCategories,"onUpdate:value":e[4]||(e[4]=a=>t.selectedCategories=a),class:"multi-selector"},null,8,["categories","value"])):x("",!0),t.useMultiCategories&&t.selectedCategories.length>1?(v(),h("div",rc,[B(r("input",{type:"checkbox",id:"ensureEachCategory","onUpdate:modelValue":e[5]||(e[5]=a=>t.ensureEachCategory=a)},null,512),[[Ye,t.ensureEachCategory]]),e[12]||(e[12]=r("label",{for:"ensureEachCategory"},"多分类平衡模式（确保每个分类至少抽取一个标签）",-1))])):x("",!0)]),r("div",ic,[e[18]||(e[18]=r("h3",null,"选择Tag库",-1)),r("div",lc,[B(r("select",{"onUpdate:modelValue":e[6]||(e[6]=a=>t.selectedLibrary=a),class:"form-select",onChange:e[7]||(e[7]=(...a)=>t.handleLibraryChange&&t.handleLibraryChange(...a))},[r("option",{value:t.selectedLibrary},_(t.selectedLibrary),9,ac),(v(!0),h(Q,null,ge(t.filteredLibraries,a=>(v(),h("option",{key:a,value:a},_(a),9,cc))),128))],544),[[Ne,t.selectedLibrary]]),t.recentLibraries.length>0?(v(),h("div",uc,[e[14]||(e[14]=r("span",{class:"recent-label"},"最近使用:",-1)),r("div",dc,[(v(!0),h(Q,null,ge(t.recentLibraries,a=>(v(),h("button",{key:a,onClick:c=>t.quickSelectLibrary(a),class:ae(["library-chip",{active:t.selectedLibrary===a}])},_(a),11,fc))),128))])])):x("",!0),t.currentLibraryInfo?(v(),h("div",gc,[r("div",pc,[e[15]||(e[15]=r("span",{class:"info-label"},"分类数:",-1)),r("span",vc,_(t.currentLibraryInfo.categoryCount),1)]),r("div",yc,[e[16]||(e[16]=r("span",{class:"info-label"},"标签数:",-1)),r("span",hc,_(t.currentLibraryInfo.tagCount),1)])])):x("",!0)]),t.isLibraryLoading?(v(),h("div",mc,e[17]||(e[17]=[r("div",{class:"spinner"},null,-1),r("span",null,"加载标签库中...",-1)]))):x("",!0)]),r("div",bc,[r("button",{onClick:e[8]||(e[8]=(...a)=>t.drawTags&&t.drawTags(...a)),class:"primary-button",disabled:t.isDrawing},[t.isDrawing?(v(),h("span",wc)):(v(),h("span",Cc,"🎯")),Ge(" "+_(t.isDrawing?"抽取中...":"抽签"),1)],8,$c),r("button",{onClick:e[9]||(e[9]=(...a)=>t.resetForm&&t.resetForm(...a)),class:"secondary-button",disabled:t.isDrawing},e[19]||(e[19]=[r("span",{class:"button-icon"},"🔄",-1),Ge(" 重置 ")]),8,Tc)])])])}const Lc=_e(Ga,[["render",_c],["__scopeId","data-v-5db807f6"]]);const Sc=He({name:"DrawerResults",props:{drawnTags:{type:Array,default:()=>[]}},setup(t){const e=ye("emitter");return{copyResultTags:(n=!1)=>{if(!t.drawnTags||t.drawnTags.length===0)return;let i="";n?i=t.drawnTags.map(l=>l.content).join(","):i=t.drawnTags.map(l=>{let o=`【${l.category}】${l.content}`;return l.subTitles&&l.subTitles.length>0&&(o+=` (${l.subTitles.join(" / ")})`),o}).join(","),navigator.clipboard.writeText(i).then(()=>{e.emit("notification",{type:"success",message:n?"已复制内容到剪贴板":"已复制完整结果到剪贴板"})}).catch(l=>{console.error("复制失败:",l),e.emit("notification",{type:"error",message:"复制失败，请手动复制"})})}}}}),kc={class:"drawer-results"},Ec={class:"panel-header"},Ac={key:0,class:"copy-buttons"},Ic={key:0,class:"empty-result"},Mc={key:1,class:"results-list"},Oc={class:"result-category"},Dc={class:"result-content"},Pc={key:0,class:"result-subtitle"};function Hc(t,e,s,n,i,l){return v(),h("div",kc,[r("div",Ec,[e[4]||(e[4]=r("h3",{class:"panel-title"},"抽签结果",-1)),t.drawnTags.length>0?(v(),h("div",Ac,[r("button",{onClick:e[0]||(e[0]=o=>t.copyResultTags(!1)),class:"copy-button",title:"复制全部结果"},e[2]||(e[2]=[r("span",{class:"button-icon"},"📋",-1)])),r("button",{onClick:e[1]||(e[1]=o=>t.copyResultTags(!0)),class:"copy-button",title:"只复制内容"},e[3]||(e[3]=[r("span",{class:"button-icon"},"📝",-1)]))])):x("",!0)]),t.drawnTags.length===0?(v(),h("div",Ic,' 点击"抽签"按钮开始 ')):(v(),h("div",Mc,[(v(!0),h(Q,null,ge(t.drawnTags,(o,a)=>(v(),h("div",{key:a,class:"result-item",style:Ot({animationDelay:`${a*.15}s`})},[r("div",Oc,_(o.category||"未分类"),1),r("div",Dc,_(o.content),1),o.subTitles&&o.subTitles.length>0?(v(),h("div",Pc,_(o.subTitles.join(" / ")),1)):x("",!0)],4))),128))]))])}const Rc=_e(Sc,[["render",Hc],["__scopeId","data-v-0188b2eb"]]);const Nc=He({name:"DrawerPanel",components:{DrawerForm:Lc,DrawerResults:Rc},setup(){const t=$([]);return{drawnTags:t,handleDrawCompleted:s=>{t.value=s}}}}),jc={class:"drawer-panel"},Fc={class:"drawer-settings-panel"},Uc={class:"drawer-results-panel"};function Bc(t,e,s,n,i,l){const o=ke("drawer-form"),a=ke("drawer-results");return v(),h("div",jc,[r("div",Fc,[be(o,{onDrawCompleted:t.handleDrawCompleted},null,8,["onDrawCompleted"])]),r("div",Uc,[be(a,{"drawn-tags":t.drawnTags},null,8,["drawn-tags"])])])}const Vc=_e(Nc,[["render",Bc],["__scopeId","data-v-139229c5"]]);const Jc=He({name:"HistoryPanel",setup(){const t=ye("emitter"),e=ye("tagLibrary"),s=$([]),n=()=>{try{console.log("HistoryPanel: 开始加载历史记录");const p=e.getHistory();if(console.log("HistoryPanel: 从TagLibrary获取到历史记录数量:",(p==null?void 0:p.length)||0),Array.isArray(p)){if(s.value=p,console.log("HistoryPanel: 历史记录加载成功，数量:",s.value.length),p.length>0){const m=p[0];console.log("HistoryPanel: 历史记录示例项:",JSON.stringify(m).substring(0,200)+"...")}}else console.error("HistoryPanel: 获取到的历史记录不是数组"),s.value=[]}catch(p){console.error("HistoryPanel: 加载历史记录失败:",p),s.value=[],t.emit("notification",{type:"error",message:"加载历史记录失败"})}},i=p=>{const m=new Date(p);return`${m.getFullYear()}-${String(m.getMonth()+1).padStart(2,"0")}-${String(m.getDate()).padStart(2,"0")} ${String(m.getHours()).padStart(2,"0")}:${String(m.getMinutes()).padStart(2,"0")}`},l=p=>{t.emit("reuse-history",p),t.emit("notification",{type:"success",message:"已重用历史记录"})},o=p=>{if(!p.tags||p.tags.length===0)return;const m=p.tags.map(T=>{let k=`【${T.category}】${T.content}`;return T.subTitles&&T.subTitles.length>0&&(k+=` (${T.subTitles.join(" / ")})`),k}).join(",");navigator.clipboard.writeText(m).then(()=>{t.emit("notification",{type:"success",message:"已复制历史记录到剪贴板"})}).catch(T=>{console.error("复制失败:",T),t.emit("notification",{type:"error",message:"复制失败，请手动复制"})})},a=p=>{try{e.removeHistoryItem(p),n(),t.emit("notification",{type:"success",message:"历史记录已删除"})}catch(m){console.error("删除历史记录失败:",m),t.emit("notification",{type:"error",message:"删除历史记录失败"})}},c=()=>{if(confirm("确定要清空所有历史记录吗？此操作不可恢复。"))try{e.clearHistory(),s.value=[],t.emit("notification",{type:"success",message:"所有历史记录已清空"})}catch(p){console.error("清空历史记录失败:",p),t.emit("notification",{type:"error",message:"清空历史记录失败"})}};Ke(()=>{console.log("HistoryPanel: 组件挂载"),setTimeout(()=>{console.log("HistoryPanel: 延迟加载历史记录"),n()},500),u=t.on("history-updated",()=>{console.log("HistoryPanel: 收到history-updated事件"),n()}),d=t.on("tags-drawn",()=>{console.log("HistoryPanel: 收到tags-drawn事件"),setTimeout(()=>{console.log("HistoryPanel: 延迟响应tags-drawn事件，开始加载历史记录"),n()},200)});const p=()=>{console.log("HistoryPanel: 收到history-updated自定义事件"),setTimeout(()=>{console.log("HistoryPanel: 延迟响应CustomEvent，开始加载历史记录"),n()},200)};window.addEventListener("history-updated",p);const m=setInterval(()=>{console.log("HistoryPanel: 触发自动刷新历史记录"),n()},3e4);g=()=>{console.log("HistoryPanel: 清理事件监听"),window.removeEventListener("history-updated",p),clearInterval(m)}});let u,d,g;return Yt(()=>{u&&u(),d&&d(),g&&g()}),{historyItems:s,formatTime:i,reuseHistory:l,copyHistoryTags:o,deleteHistory:a,clearAllHistory:c}}}),Kc={class:"history-panel"},zc={key:0,class:"empty-history"},Wc={key:1,class:"history-content"},Gc={class:"history-header"},Yc={class:"header-actions"},qc={class:"history-list"},Qc={class:"history-meta"},Zc={class:"history-time"},Xc={class:"history-actions"},xc=["onClick"],eu=["onClick"],tu=["onClick"],su={class:"history-tags"},ou={class:"tag-header"},nu={class:"tag-category"},ru={class:"tag-body"},iu={class:"tag-content"},lu={key:0,class:"tag-subtitle"},au={class:"history-options"},cu={class:"option-values"},uu={class:"option-item"},du={class:"option-item"},fu={class:"option-item"};function gu(t,e,s,n,i,l){return v(),h("div",Kc,[t.historyItems.length===0?(v(),h("div",zc,e[1]||(e[1]=[r("p",null,"暂无抽签历史记录",-1),r("p",{class:"empty-tip"},"抽签后的结果将自动保存在这里",-1)]))):(v(),h("div",Wc,[r("div",Gc,[e[2]||(e[2]=r("h3",null,"历史记录",-1)),r("div",Yc,[r("button",{onClick:e[0]||(e[0]=(...o)=>t.clearAllHistory&&t.clearAllHistory(...o)),class:"clear-all-btn"}," 清空全部 ")])]),r("div",qc,[(v(!0),h(Q,null,ge(t.historyItems,o=>(v(),h("div",{key:o.id,class:"history-item"},[r("div",Qc,[r("div",Zc,_(t.formatTime(o.timestamp)),1),r("div",Xc,[r("button",{onClick:a=>t.reuseHistory(o),class:"action-btn reuse-btn",title:"重新使用"},e[3]||(e[3]=[r("span",{class:"btn-icon"},"🔄",-1),r("span",{class:"btn-text"},"重用",-1)]),8,xc),r("button",{onClick:a=>t.copyHistoryTags(o),class:"action-btn copy-btn",title:"复制结果"},e[4]||(e[4]=[r("span",{class:"btn-icon"},"📋",-1),r("span",{class:"btn-text"},"复制",-1)]),8,eu),r("button",{onClick:a=>t.deleteHistory(o.id),class:"action-btn delete-btn",title:"删除"},e[5]||(e[5]=[r("span",{class:"btn-icon"},"🗑️",-1),r("span",{class:"btn-text"},"删除",-1)]),8,tu)])]),r("div",su,[(v(!0),h(Q,null,ge(o.tags,(a,c)=>(v(),h("div",{key:c,class:"history-tag"},[r("div",ou,[r("span",nu,_(a.category),1)]),r("div",ru,[r("span",iu,_(a.content),1),a.subTitles&&a.subTitles.length>0?(v(),h("span",lu,_(a.subTitles.join(" / ")),1)):x("",!0)])]))),128))]),r("div",au,[e[9]||(e[9]=r("span",{class:"option-label"},"抽取选项:",-1)),r("div",cu,[r("span",uu,[e[6]||(e[6]=r("span",{class:"option-icon"},"🎯",-1)),r("span",null,"数量: "+_(o.options.count),1)]),r("span",du,[e[7]||(e[7]=r("span",{class:"option-icon"},"📁",-1)),r("span",null,"分类: "+_(o.options.category||"全部"),1)]),r("span",fu,[e[8]||(e[8]=r("span",{class:"option-icon"},"🔄",-1)),r("span",null,"排除重复: "+_(o.options.noDuplicates?"是":"否"),1)])])])]))),128))])]))])}const pu=_e(Jc,[["render",gu],["__scopeId","data-v-5f8ff0de"]]);const vu=He({name:"ThemeSettings",setup(){const t=ye("emitter"),e=$(16),s=$("#2196F3"),n=[{name:"宝石蓝",value:"#2196F3"},{name:"翡翠绿",value:"#4CAF50"},{name:"珊瑚红",value:"#F44336"},{name:"紫水晶",value:"#9C27B0"},{name:"琥珀黄",value:"#FF9800"},{name:"青玉",value:"#009688"},{name:"石墨黑",value:"#37474F"},{name:"深蓝",value:"#3F51B5"}],i=$(!1),l=$(!0),o=()=>{const p=document.documentElement,m=e.value;p.style.setProperty("--font-size-base",`${m}px`),p.style.setProperty("--font-size-xs",`${m*.85}px`),p.style.setProperty("--font-size-sm",`${m*.95}px`),p.style.setProperty("--font-size-md",`${m}px`),p.style.setProperty("--font-size-lg",`${m*1.2}px`),p.style.setProperty("--font-size-xl",`${m*1.5}px`),t.emit("font-size-changed",m),localStorage.setItem("user_font_size",m.toString()),d(!0)},a=p=>{s.value=p,document.documentElement.style.setProperty("--primary-color",p);const m=parseInt(p.slice(1,3),16),T=parseInt(p.slice(3,5),16),k=parseInt(p.slice(5,7),16),Z=`rgb(${Math.max(0,m*.7)}, ${Math.max(0,T*.7)}, ${Math.max(0,k*.7)})`;document.documentElement.style.setProperty("--primary-hover-color",Z);const V=`rgba(${m}, ${T}, ${k}, 0.1)`;document.documentElement.style.setProperty("--primary-light-color",V),d(!0)},c=()=>{i.value?document.body.classList.add("dark-mode"):document.body.classList.remove("dark-mode"),d()},u=()=>{t.emit("notificationsSettingChanged",l.value),d()},d=(p=!1)=>{localStorage.setItem("theme_settings",JSON.stringify({fontSize:e.value,themeColor:s.value,darkMode:i.value,showNotifications:l.value})),l.value&&!p&&t.emit("notification",{type:"success",message:"主题设置已保存"})},g=()=>{const p=localStorage.getItem("theme_settings");if(p)try{const m=JSON.parse(p);e.value=m.fontSize||16,s.value=m.themeColor||"#2196F3",i.value=m.darkMode||!1,l.value=m.showNotifications!==!1;const T=e.value,k=document.documentElement;k.style.setProperty("--font-size-base",`${T}px`),k.style.setProperty("--font-size-xs",`${T*.85}px`),k.style.setProperty("--font-size-sm",`${T*.95}px`),k.style.setProperty("--font-size-md",`${T}px`),k.style.setProperty("--font-size-lg",`${T*1.2}px`),k.style.setProperty("--font-size-xl",`${T*1.5}px`),k.style.setProperty("--primary-color",s.value),i.value?document.body.classList.add("dark-mode"):document.body.classList.remove("dark-mode"),t.emit("notificationsSettingChanged",l.value),a(s.value)}catch(m){console.error("加载主题设置失败:",m)}};return Ke(()=>{g()}),{fontSize:e,themeColor:s,themeColors:n,darkMode:i,showNotifications:l,applyFontSize:o,setThemeColor:a,toggleDarkMode:c,toggleNotifications:u}}}),yu={class:"theme-settings"},hu={class:"settings-section"},mu={class:"settings-item"},bu={class:"setting-control"},$u={class:"slider-container with-value"},wu={class:"settings-item"},Cu={class:"setting-control"},Tu={class:"color-picker"},_u=["onClick","title"],Lu={class:"settings-item"},Su={class:"setting-control"},ku={class:"toggle-switch"},Eu={class:"settings-item"},Au={class:"setting-control"},Iu={class:"toggle-switch"};function Mu(t,e,s,n,i,l){return v(),h("div",yu,[r("div",hu,[e[16]||(e[16]=r("h3",{class:"section-title"},"界面设置",-1)),r("div",mu,[e[7]||(e[7]=r("div",{class:"setting-label"},"字体大小",-1)),r("div",bu,[r("div",$u,[B(r("input",{type:"range",min:"12",max:"20",step:"1","onUpdate:modelValue":e[0]||(e[0]=o=>t.fontSize=o),class:"slider",onInput:e[1]||(e[1]=(...o)=>t.applyFontSize&&t.applyFontSize(...o))},null,544),[[Ee,t.fontSize]]),r("span",{class:"slider-value",style:Ot({fontSize:t.fontSize+"px"})},_(t.fontSize)+"px",5)]),e[6]||(e[6]=r("div",{class:"setting-description"},"调整应用的整体字体大小 (12-20像素)",-1))])]),r("div",wu,[e[9]||(e[9]=r("div",{class:"setting-label"},"主题颜色",-1)),r("div",Cu,[r("div",Tu,[(v(!0),h(Q,null,ge(t.themeColors,(o,a)=>(v(),h("div",{key:a,class:ae(["color-swatch",{active:t.themeColor===o.value}]),style:Ot({backgroundColor:o.value}),onClick:c=>t.setThemeColor(o.value),title:o.name},null,14,_u))),128))]),e[8]||(e[8]=r("div",{class:"setting-description"},"选择应用的主题配色",-1))])]),r("div",Lu,[e[12]||(e[12]=r("div",{class:"setting-label"},"深色模式",-1)),r("div",Su,[r("label",ku,[B(r("input",{type:"checkbox","onUpdate:modelValue":e[2]||(e[2]=o=>t.darkMode=o),onChange:e[3]||(e[3]=(...o)=>t.toggleDarkMode&&t.toggleDarkMode(...o))},null,544),[[Ye,t.darkMode]]),e[10]||(e[10]=r("span",{class:"toggle-slider"},null,-1))]),e[11]||(e[11]=r("div",{class:"setting-description"},"切换应用的明暗主题",-1))])]),r("div",Eu,[e[15]||(e[15]=r("div",{class:"setting-label"},"通知消息",-1)),r("div",Au,[r("label",Iu,[B(r("input",{type:"checkbox","onUpdate:modelValue":e[4]||(e[4]=o=>t.showNotifications=o),onChange:e[5]||(e[5]=(...o)=>t.toggleNotifications&&t.toggleNotifications(...o))},null,544),[[Ye,t.showNotifications]]),e[13]||(e[13]=r("span",{class:"toggle-slider"},null,-1))]),e[14]||(e[14]=r("div",{class:"setting-description"},"控制是否显示操作反馈通知消息",-1))])])])])}const Ou=_e(vu,[["render",Mu],["__scopeId","data-v-7b14b1dc"]]);const Du=He({name:"DrawerSettings",setup(){const t=ye("emitter"),e=ye("tagLibrary"),s=$(0),n=$(3),i=$(!0),l=$(!1),o=$(!0),a=$(60),c=$(!1),u=$(!0),d=$(50),g=$("default"),p=Se(()=>(s.value,e.getLibraryNames()||["default"])),m=()=>{s.value++,console.log("抽签设置: 标签库列表已更新",s.value),g.value&&!p.value.includes(g.value)&&p.value.length>0&&(g.value=p.value[0],F())},T=()=>{n.value<10&&(n.value++,Z())},k=()=>{n.value>1&&(n.value--,Z())},Z=()=>{localStorage.setItem("drawer_settings",JSON.stringify({defaultDrawCount:n.value,noDuplicates:i.value,useWeights:l.value,showAnimation:o.value,animationIntensity:a.value,ensureEachCategory:c.value})),t.emit("notification",{type:"success",message:"抽签设置已保存"})},V=()=>{localStorage.setItem("history_settings",JSON.stringify({autoSaveHistory:u.value,maxHistoryCount:d.value})),e&&typeof e.setMaxHistorySize=="function"&&e.setMaxHistorySize(u.value?d.value:0),t.emit("notification",{type:"success",message:"历史记录设置已保存"})},F=()=>{localStorage.setItem("library_settings",JSON.stringify({defaultLibrary:g.value})),e&&typeof e.setCurrentLibrary=="function"&&e.setCurrentLibrary(g.value),t.emit("notification",{type:"success",message:"标签库设置已保存"})},H=()=>{const b=localStorage.getItem("drawer_settings");if(b)try{const q=JSON.parse(b);n.value=q.defaultDrawCount||3,i.value=q.noDuplicates!==!1,l.value=q.useWeights||!1,o.value=q.showAnimation||!0,a.value=q.animationIntensity||60,c.value=q.ensureEachCategory||!1}catch(q){console.error("加载抽签设置失败:",q)}const D=localStorage.getItem("history_settings");if(D)try{const q=JSON.parse(D);u.value=q.autoSaveHistory!==!1,d.value=q.maxHistoryCount||50,e&&typeof e.setMaxHistorySize=="function"&&e.setMaxHistorySize(u.value?d.value:0)}catch(q){console.error("加载历史记录设置失败:",q)}const te=localStorage.getItem("library_settings");if(te)try{const q=JSON.parse(te);q.defaultLibrary&&p.value.includes(q.defaultLibrary)?g.value=q.defaultLibrary:p.value.length>0&&(g.value=p.value[0])}catch(q){console.error("加载标签库设置失败:",q)}else p.value.length>0&&(g.value=p.value[0])};return Ke(()=>{H(),t.on("tagLibraryUpdated",m)}),ks(()=>{t.off("tagLibraryUpdated",m)}),{defaultDrawCount:n,noDuplicates:i,useWeights:l,showAnimation:o,animationIntensity:a,ensureEachCategory:c,increaseDefaultDrawCount:T,decreaseDefaultDrawCount:k,saveDrawSettings:Z,autoSaveHistory:u,maxHistoryCount:d,saveHistorySettings:V,defaultLibrary:g,libraries:p,saveLibrarySettings:F,refreshData:m}}}),Pu={class:"drawer-settings"},Hu={class:"settings-section"},Ru={class:"settings-item"},Nu={class:"setting-control"},ju={class:"number-input"},Fu={class:"settings-item"},Uu={class:"setting-control"},Bu={class:"toggle-switch"},Vu={class:"settings-item"},Ju={class:"setting-control"},Ku={class:"toggle-switch"},zu={class:"settings-item"},Wu={class:"setting-control"},Gu={class:"toggle-switch"},Yu={class:"settings-item"},qu={class:"setting-control"},Qu={class:"toggle-switch"},Zu={key:0,class:"settings-item"},Xu={class:"setting-control"},xu={class:"slider-container with-value"},ed={class:"slider-value"},td={class:"settings-section"},sd={class:"settings-item"},od={class:"setting-control"},nd={class:"toggle-switch"},rd={class:"settings-item"},id={class:"setting-control"},ld={class:"slider-container with-value"},ad=["disabled"],cd={class:"slider-value"},ud={class:"settings-section"},dd={class:"settings-item"},fd={class:"setting-control"},gd=["value"];function pd(t,e,s,n,i,l){return v(),h("div",Pu,[r("div",Hu,[e[36]||(e[36]=r("h3",{class:"section-title"},"抽签行为设置",-1)),r("div",Ru,[e[21]||(e[21]=r("div",{class:"setting-label"},"默认抽签数量",-1)),r("div",Nu,[r("div",ju,[r("button",{onClick:e[0]||(e[0]=(...o)=>t.decreaseDefaultDrawCount&&t.decreaseDefaultDrawCount(...o)),class:"number-btn"},"-"),B(r("input",{type:"number","onUpdate:modelValue":e[1]||(e[1]=o=>t.defaultDrawCount=o),min:"1",max:"10",class:"number-field",onChange:e[2]||(e[2]=(...o)=>t.saveDrawSettings&&t.saveDrawSettings(...o))},null,544),[[Ee,t.defaultDrawCount]]),r("button",{onClick:e[3]||(e[3]=(...o)=>t.increaseDefaultDrawCount&&t.increaseDefaultDrawCount(...o)),class:"number-btn"},"+")]),e[20]||(e[20]=r("div",{class:"setting-description"},"设置每次抽签的默认数量",-1))])]),r("div",Fu,[e[24]||(e[24]=r("div",{class:"setting-label"},"避免重复标签",-1)),r("div",Uu,[r("label",Bu,[B(r("input",{type:"checkbox","onUpdate:modelValue":e[4]||(e[4]=o=>t.noDuplicates=o),onChange:e[5]||(e[5]=(...o)=>t.saveDrawSettings&&t.saveDrawSettings(...o))},null,544),[[Ye,t.noDuplicates]]),e[22]||(e[22]=r("span",{class:"toggle-slider"},null,-1))]),e[23]||(e[23]=r("div",{class:"setting-description"},"启用后，抽取结果中不会出现重复的标签",-1))])]),r("div",Vu,[e[27]||(e[27]=r("div",{class:"setting-label"},"使用权重抽取",-1)),r("div",Ju,[r("label",Ku,[B(r("input",{type:"checkbox","onUpdate:modelValue":e[6]||(e[6]=o=>t.useWeights=o),onChange:e[7]||(e[7]=(...o)=>t.saveDrawSettings&&t.saveDrawSettings(...o))},null,544),[[Ye,t.useWeights]]),e[25]||(e[25]=r("span",{class:"toggle-slider"},null,-1))]),e[26]||(e[26]=r("div",{class:"setting-description"},"启用后，常用标签将有更高的概率被抽到",-1))])]),r("div",zu,[e[30]||(e[30]=r("div",{class:"setting-label"},"多分类模式下确保平衡",-1)),r("div",Wu,[r("label",Gu,[B(r("input",{type:"checkbox","onUpdate:modelValue":e[8]||(e[8]=o=>t.ensureEachCategory=o),onChange:e[9]||(e[9]=(...o)=>t.saveDrawSettings&&t.saveDrawSettings(...o))},null,544),[[Ye,t.ensureEachCategory]]),e[28]||(e[28]=r("span",{class:"toggle-slider"},null,-1))]),e[29]||(e[29]=r("div",{class:"setting-description"},"在多分类模式下，确保每个选定的分类至少抽取一个标签",-1))])]),r("div",Yu,[e[33]||(e[33]=r("div",{class:"setting-label"},"抽签动画",-1)),r("div",qu,[r("label",Qu,[B(r("input",{type:"checkbox","onUpdate:modelValue":e[10]||(e[10]=o=>t.showAnimation=o),onChange:e[11]||(e[11]=(...o)=>t.saveDrawSettings&&t.saveDrawSettings(...o))},null,544),[[Ye,t.showAnimation]]),e[31]||(e[31]=r("span",{class:"toggle-slider"},null,-1))]),e[32]||(e[32]=r("div",{class:"setting-description"},"启用动画效果，增强抽签体验",-1))])]),t.showAnimation?(v(),h("div",Zu,[e[35]||(e[35]=r("div",{class:"setting-label"},"动画强度",-1)),r("div",Xu,[r("div",xu,[B(r("input",{type:"range",min:"10",max:"100",step:"10","onUpdate:modelValue":e[12]||(e[12]=o=>t.animationIntensity=o),class:"slider",onChange:e[13]||(e[13]=(...o)=>t.saveDrawSettings&&t.saveDrawSettings(...o))},null,544),[[Ee,t.animationIntensity]]),r("span",ed,_(t.animationIntensity)+"%",1)]),e[34]||(e[34]=r("div",{class:"setting-description"},"调整抽签动画的视觉效果强度",-1))])])):x("",!0)]),r("div",td,[e[42]||(e[42]=r("h3",{class:"section-title"},"历史记录",-1)),r("div",sd,[e[39]||(e[39]=r("div",{class:"setting-label"},"自动保存历史记录",-1)),r("div",od,[r("label",nd,[B(r("input",{type:"checkbox","onUpdate:modelValue":e[14]||(e[14]=o=>t.autoSaveHistory=o),onChange:e[15]||(e[15]=(...o)=>t.saveHistorySettings&&t.saveHistorySettings(...o))},null,544),[[Ye,t.autoSaveHistory]]),e[37]||(e[37]=r("span",{class:"toggle-slider"},null,-1))]),e[38]||(e[38]=r("div",{class:"setting-description"},"自动记录每次抽签结果，便于后续查看和分析",-1))])]),r("div",rd,[e[41]||(e[41]=r("div",{class:"setting-label"},"最大历史记录数量",-1)),r("div",id,[r("div",ld,[B(r("input",{type:"range",min:"10",max:"100",step:"10","onUpdate:modelValue":e[16]||(e[16]=o=>t.maxHistoryCount=o),class:"slider",onChange:e[17]||(e[17]=(...o)=>t.saveHistorySettings&&t.saveHistorySettings(...o)),disabled:!t.autoSaveHistory},null,40,ad),[[Ee,t.maxHistoryCount]]),r("span",cd,_(t.maxHistoryCount),1)]),e[40]||(e[40]=r("div",{class:"setting-description"},"设置历史记录保存的最大数量，超出将自动删除最早的记录",-1))])])]),r("div",ud,[e[45]||(e[45]=r("h3",{class:"section-title"},"标签库默认设置",-1)),r("div",dd,[e[44]||(e[44]=r("div",{class:"setting-label"},"默认标签库",-1)),r("div",fd,[B(r("select",{"onUpdate:modelValue":e[18]||(e[18]=o=>t.defaultLibrary=o),onChange:e[19]||(e[19]=(...o)=>t.saveLibrarySettings&&t.saveLibrarySettings(...o)),class:"select-field"},[(v(!0),h(Q,null,ge(t.libraries,o=>(v(),h("option",{key:o,value:o},_(o),9,gd))),128))],544),[[Ne,t.defaultLibrary]]),e[43]||(e[43]=r("div",{class:"setting-description"},"设置应用启动时默认加载的标签库",-1))])])])])}const vd=_e(Du,[["render",pd],["__scopeId","data-v-a465d02d"]]);const yd=He({name:"BackupSettings",setup(){const t=ye("emitter"),e=ye("tagLibrary"),s=$(!1),n=$("daily"),i=$(5),l=$(!1),o=$(!1),a=$(""),c=$(!1),u=$(!1),d=$(""),g=$([]),p=$([]),m=$(""),T=()=>{try{const U=localStorage.getItem("backup_settings");if(U){const ve=JSON.parse(U);s.value=ve.autoBackup||!1,n.value=ve.backupFrequency||"daily",i.value=ve.maxBackups||5,l.value=ve.googleDriveSync||!1,c.value=ve.oneDriveSync||!1}const J=localStorage.getItem("google_account");if(J){const ve=JSON.parse(J);o.value=ve.connected||!1,a.value=ve.name||""}const ie=localStorage.getItem("onedrive_account");if(ie){const ve=JSON.parse(ie);u.value=ve.connected||!1,d.value=ve.name||""}Z()}catch(U){console.error("加载备份设置失败",U)}},k=()=>{try{const U={autoBackup:s.value,backupFrequency:n.value,maxBackups:i.value,googleDriveSync:l.value,oneDriveSync:c.value};localStorage.setItem("backup_settings",JSON.stringify(U)),s.value&&q(),t.emit("notification",{type:"success",message:"备份设置已保存"})}catch(U){console.error("保存备份设置失败",U),t.emit("notification",{type:"error",message:`保存设置失败: ${U.message}`})}},Z=()=>{try{const U=localStorage.getItem("backups");U&&(g.value=JSON.parse(U))}catch(U){console.error("加载备份列表失败",U),g.value=[]}},V=U=>new Date(U).toLocaleString(),F=(U,J=2)=>{if(U===0)return"0 Bytes";const ie=1024,ve=J<0?0:J,je=["Bytes","KB","MB","GB"],De=Math.floor(Math.log(U)/Math.log(ie));return parseFloat((U/Math.pow(ie,De)).toFixed(ve))+" "+je[De]},H=async()=>{try{const U=e.exportAllData?e.exportAllData():{libraries:{}},J=JSON.stringify(U),ie=new Date().toISOString(),ve=`备份_${new Date().toLocaleDateString().replace(/\//g,"-")}`,je={id:`backup_${Date.now()}`,name:ve,date:ie,size:J.length,data:J};g.value.push(je),g.value.length>i.value&&(g.value.sort((De,M)=>new Date(De.date)-new Date(M.date)),g.value.splice(0,g.value.length-i.value)),localStorage.setItem("backups",JSON.stringify(g.value)),l.value&&o.value&&console.log("同步备份到 Google Drive"),c.value&&u.value&&console.log("同步备份到 OneDrive"),t.emit("notification",{type:"success",message:"备份创建成功"})}catch(U){console.error("创建备份失败",U),t.emit("notification",{type:"error",message:`创建备份失败: ${U.message}`})}},b=U=>{if(confirm("确定要从此备份恢复数据吗？当前数据将被覆盖。"))try{const J=JSON.parse(U.data);if(e.importAllData)e.importAllData(J),t.emit("notification",{type:"success",message:"数据已成功恢复"});else throw new Error("标签库不支持导入功能")}catch(J){console.error("恢复备份失败",J),t.emit("notification",{type:"error",message:`恢复备份失败: ${J.message}`})}},D=U=>{try{const J=new Blob([U.data],{type:"application/json"}),ie=URL.createObjectURL(J),ve=document.createElement("a");ve.download=`${U.name.replace(/\s/g,"-")}.json`,ve.href=ie,ve.click(),URL.revokeObjectURL(ie),t.emit("notification",{type:"success",message:"备份文件已下载"})}catch(J){console.error("下载备份失败",J),t.emit("notification",{type:"error",message:`下载备份失败: ${J.message}`})}},te=U=>{if(confirm("确定要删除此备份吗？"))try{const J=g.value.findIndex(ie=>ie.id===U.id);J!==-1&&(g.value.splice(J,1),localStorage.setItem("backups",JSON.stringify(g.value)),t.emit("notification",{type:"success",message:"备份已删除"}))}catch(J){console.error("删除备份失败",J),t.emit("notification",{type:"error",message:`删除备份失败: ${J.message}`})}},q=()=>{console.log(`设置自动备份计划: ${n.value}`)},Te=()=>{setTimeout(()=>{o.value=!0,a.value="user@gmail.com",localStorage.setItem("google_account",JSON.stringify({connected:!0,name:"user@gmail.com"})),t.emit("notification",{type:"success",message:"Google Drive 账号已连接"})},1e3)},se=()=>{confirm("确定要断开 Google Drive 连接吗？")&&(o.value=!1,a.value="",localStorage.setItem("google_account",JSON.stringify({connected:!1,name:""})),t.emit("notification",{type:"success",message:"Google Drive 账号已断开连接"}))},W=()=>{setTimeout(()=>{u.value=!0,d.value="user@outlook.com",localStorage.setItem("onedrive_account",JSON.stringify({connected:!0,name:"user@outlook.com"})),t.emit("notification",{type:"success",message:"OneDrive 账号已连接"})},1e3)},re=()=>{confirm("确定要断开 OneDrive 连接吗？")&&(u.value=!1,d.value="",localStorage.setItem("onedrive_account",JSON.stringify({connected:!1,name:""})),t.emit("notification",{type:"success",message:"OneDrive 账号已断开连接"}))},C=()=>{try{e&&e.getLibraryNames?p.value=e.getLibraryNames():p.value=[]}catch(U){console.error("加载标签库名称失败",U),p.value=[]}},G=()=>{if(confirm("确定要清除所有历史记录吗？此操作无法撤销。"))try{if(e&&e.clearHistory)e.clearHistory(),t.emit("notification",{type:"success",message:"已清除所有历史记录"});else throw new Error("清除历史记录功能不可用")}catch(U){console.error("清除历史记录失败",U),t.emit("notification",{type:"error",message:`清除历史记录失败: ${U.message}`})}},ue=()=>{if(!m.value){t.emit("notification",{type:"warning",message:"请先选择要清除的标签库"});return}if(confirm(`确定要清除"${m.value}"标签库吗？此操作无法撤销。`))try{if(e&&e.deleteLibrary)if(e.deleteLibrary(m.value))C(),m.value="",t.emit("notification",{type:"success",message:`已清除"${m.value}"标签库`}),t.emit("tagLibraryUpdated");else throw new Error("无法清除默认标签库或库不存在");else throw new Error("清除标签库功能不可用")}catch(U){console.error("清除标签库失败",U),t.emit("notification",{type:"error",message:`清除标签库失败: ${U.message}`})}},pe=()=>{if(confirm("警告：确定要清除所有数据吗？这将删除所有标签库、历史记录和设置，此操作无法撤销！"))try{localStorage.clear(),t.emit("notification",{type:"success",message:"已清除所有数据，即将重新加载页面"}),setTimeout(()=>{window.location.reload()},1500)}catch(U){console.error("清除所有数据失败",U),t.emit("notification",{type:"error",message:`清除所有数据失败: ${U.message}`})}};return Ke(()=>{T(),C()}),{autoBackup:s,backupFrequency:n,maxBackups:i,googleDriveSync:l,googleAccountConnected:o,googleAccountName:a,oneDriveSync:c,oneDriveAccountConnected:u,oneDriveAccountName:d,backups:g,saveSettings:k,formatDate:V,formatBytes:F,createBackup:H,restoreBackup:b,downloadBackup:D,deleteBackup:te,connectGoogleAccount:Te,disconnectGoogleAccount:se,connectOneDriveAccount:W,disconnectOneDriveAccount:re,libraries:p,selectedLibraryToClear:m,clearHistory:G,clearSelectedLibrary:ue,clearAllData:pe}}}),hd={class:"backup-settings"},md={class:"settings-section"},bd={class:"settings-item"},$d={class:"setting-control"},wd={class:"toggle-switch"},Cd={key:0,class:"settings-item"},Td={class:"setting-control"},_d={class:"input-group"},Ld={key:1,class:"settings-item"},Sd={class:"setting-control"},kd={class:"input-group"},Ed={class:"settings-section"},Ad={key:0,class:"empty-state"},Id={key:1,class:"backup-list"},Md={class:"backup-info"},Od={class:"backup-name"},Dd={class:"backup-meta"},Pd={class:"backup-date"},Hd={class:"backup-size"},Rd={class:"backup-actions"},Nd=["onClick"],jd=["onClick"],Fd=["onClick"],Ud={class:"action-row"},Bd={class:"settings-section"},Vd={class:"settings-item"},Jd={class:"setting-control"},Kd={class:"toggle-switch"},zd={key:0,class:"settings-item"},Wd={class:"setting-control"},Gd={key:0,class:"account-status connected"},Yd={class:"account-name"},qd={key:1,class:"account-status"},Qd={class:"settings-item"},Zd={class:"setting-control"},Xd={class:"toggle-switch"},xd={key:1,class:"settings-item"},ef={class:"setting-control"},tf={key:0,class:"account-status connected"},sf={class:"account-name"},of={key:1,class:"account-status"},nf={class:"settings-section danger-zone"},rf={class:"settings-item"},lf={class:"setting-control"},af={class:"settings-item"},cf={class:"setting-control"},uf={class:"select-action"},df=["value"],ff=["disabled"],gf={class:"settings-item"},pf={class:"setting-control"};function vf(t,e,s,n,i,l){return v(),h("div",hd,[r("div",md,[e[27]||(e[27]=r("h3",{class:"section-title"},"自动备份",-1)),r("div",bd,[e[21]||(e[21]=r("div",{class:"setting-label"},"启用自动备份",-1)),r("div",$d,[r("div",wd,[B(r("input",{type:"checkbox",id:"autoBackup","onUpdate:modelValue":e[0]||(e[0]=o=>t.autoBackup=o),onChange:e[1]||(e[1]=(...o)=>t.saveSettings&&t.saveSettings(...o))},null,544),[[Ye,t.autoBackup]]),e[19]||(e[19]=r("label",{for:"autoBackup"},null,-1))]),e[20]||(e[20]=r("div",{class:"setting-description"}," 定期自动备份所有标签库和设置数据 ",-1))])]),t.autoBackup?(v(),h("div",Cd,[e[24]||(e[24]=r("div",{class:"setting-label"},"备份频率",-1)),r("div",Td,[r("div",_d,[B(r("select",{"onUpdate:modelValue":e[2]||(e[2]=o=>t.backupFrequency=o),onChange:e[3]||(e[3]=(...o)=>t.saveSettings&&t.saveSettings(...o)),class:"select-input"},e[22]||(e[22]=[r("option",{value:"daily"},"每天",-1),r("option",{value:"weekly"},"每周",-1),r("option",{value:"monthly"},"每月",-1)]),544),[[Ne,t.backupFrequency]])]),e[23]||(e[23]=r("div",{class:"setting-description"}," 选择自动备份的频率 ",-1))])])):x("",!0),t.autoBackup?(v(),h("div",Ld,[e[26]||(e[26]=r("div",{class:"setting-label"},"保留备份数",-1)),r("div",Sd,[r("div",kd,[B(r("input",{type:"number","onUpdate:modelValue":e[4]||(e[4]=o=>t.maxBackups=o),onChange:e[5]||(e[5]=(...o)=>t.saveSettings&&t.saveSettings(...o)),min:"1",max:"20",class:"number-input"},null,544),[[Ee,t.maxBackups]])]),e[25]||(e[25]=r("div",{class:"setting-description"}," 保留的最大备份数量，超过将自动删除最早的备份 ",-1))])])):x("",!0)]),r("div",Ed,[e[29]||(e[29]=r("h3",{class:"section-title"},"备份管理",-1)),t.backups.length===0?(v(),h("div",Ad,e[28]||(e[28]=[r("div",{class:"empty-message"},"没有可用的备份",-1)]))):(v(),h("div",Id,[(v(!0),h(Q,null,ge(t.backups,(o,a)=>(v(),h("div",{class:"backup-item",key:a},[r("div",Md,[r("div",Od,_(o.name),1),r("div",Dd,[r("span",Pd,_(t.formatDate(o.date)),1),r("span",Hd,_(t.formatBytes(o.size)),1)])]),r("div",Rd,[r("button",{onClick:c=>t.restoreBackup(o),class:"action-button secondary"}," 恢复 ",8,Nd),r("button",{onClick:c=>t.downloadBackup(o),class:"action-button primary"}," 下载 ",8,jd),r("button",{onClick:c=>t.deleteBackup(o),class:"action-button danger"}," 删除 ",8,Fd)])]))),128))])),r("div",Ud,[r("button",{onClick:e[6]||(e[6]=(...o)=>t.createBackup&&t.createBackup(...o)),class:"action-button primary"}," 立即创建备份 ")])]),r("div",Bd,[e[40]||(e[40]=r("h3",{class:"section-title"},"云同步",-1)),r("div",Vd,[e[32]||(e[32]=r("div",{class:"setting-label"},"Google Drive 同步",-1)),r("div",Jd,[r("div",Kd,[B(r("input",{type:"checkbox",id:"googleDriveSync","onUpdate:modelValue":e[7]||(e[7]=o=>t.googleDriveSync=o),onChange:e[8]||(e[8]=(...o)=>t.saveSettings&&t.saveSettings(...o))},null,544),[[Ye,t.googleDriveSync]]),e[30]||(e[30]=r("label",{for:"googleDriveSync"},null,-1))]),e[31]||(e[31]=r("div",{class:"setting-description"}," 将备份文件自动同步到 Google Drive ",-1))])]),t.googleDriveSync?(v(),h("div",zd,[e[34]||(e[34]=r("div",{class:"setting-label"},"账号状态",-1)),r("div",Wd,[t.googleAccountConnected?(v(),h("div",Gd,[e[33]||(e[33]=r("span",{class:"account-label"},"已连接",-1)),r("span",Yd,_(t.googleAccountName),1),r("button",{onClick:e[9]||(e[9]=(...o)=>t.disconnectGoogleAccount&&t.disconnectGoogleAccount(...o)),class:"action-button small danger"}," 断开连接 ")])):(v(),h("div",qd,[r("button",{onClick:e[10]||(e[10]=(...o)=>t.connectGoogleAccount&&t.connectGoogleAccount(...o)),class:"action-button primary"}," 连接账号 ")]))])])):x("",!0),r("div",Qd,[e[37]||(e[37]=r("div",{class:"setting-label"},"OneDrive 同步",-1)),r("div",Zd,[r("div",Xd,[B(r("input",{type:"checkbox",id:"oneDriveSync","onUpdate:modelValue":e[11]||(e[11]=o=>t.oneDriveSync=o),onChange:e[12]||(e[12]=(...o)=>t.saveSettings&&t.saveSettings(...o))},null,544),[[Ye,t.oneDriveSync]]),e[35]||(e[35]=r("label",{for:"oneDriveSync"},null,-1))]),e[36]||(e[36]=r("div",{class:"setting-description"}," 将备份文件自动同步到 OneDrive ",-1))])]),t.oneDriveSync?(v(),h("div",xd,[e[39]||(e[39]=r("div",{class:"setting-label"},"账号状态",-1)),r("div",ef,[t.oneDriveAccountConnected?(v(),h("div",tf,[e[38]||(e[38]=r("span",{class:"account-label"},"已连接",-1)),r("span",sf,_(t.oneDriveAccountName),1),r("button",{onClick:e[13]||(e[13]=(...o)=>t.disconnectOneDriveAccount&&t.disconnectOneDriveAccount(...o)),class:"action-button small danger"}," 断开连接 ")])):(v(),h("div",of,[r("button",{onClick:e[14]||(e[14]=(...o)=>t.connectOneDriveAccount&&t.connectOneDriveAccount(...o)),class:"action-button primary"}," 连接账号 ")]))])])):x("",!0)]),r("div",nf,[e[48]||(e[48]=r("h3",{class:"section-title"},"数据清除",-1)),e[49]||(e[49]=r("div",{class:"warning-text"},[r("strong",null,"警告："),Ge(" 以下操作会删除数据，请谨慎操作。所有操作无法撤销。 ")],-1)),r("div",rf,[e[42]||(e[42]=r("div",{class:"setting-label"},"清除历史记录",-1)),r("div",lf,[r("button",{onClick:e[15]||(e[15]=(...o)=>t.clearHistory&&t.clearHistory(...o)),class:"action-button warning"}," 清除历史记录 "),e[41]||(e[41]=r("div",{class:"setting-description"}," 删除所有抽签历史记录，不影响标签库数据。 ",-1))])]),r("div",af,[e[45]||(e[45]=r("div",{class:"setting-label"},"清除标签库",-1)),r("div",cf,[r("div",uf,[B(r("select",{"onUpdate:modelValue":e[16]||(e[16]=o=>t.selectedLibraryToClear=o),class:"select-input"},[e[43]||(e[43]=r("option",{value:""},"-- 选择要清除的库 --",-1)),(v(!0),h(Q,null,ge(t.libraries,o=>(v(),h("option",{key:o,value:o},_(o),9,df))),128))],512),[[Ne,t.selectedLibraryToClear]]),r("button",{onClick:e[17]||(e[17]=(...o)=>t.clearSelectedLibrary&&t.clearSelectedLibrary(...o)),class:"action-button warning",disabled:!t.selectedLibraryToClear}," 清除选中的库 ",8,ff)]),e[44]||(e[44]=r("div",{class:"setting-description"}," 删除指定标签库的所有数据。 ",-1))])]),r("div",gf,[e[47]||(e[47]=r("div",{class:"setting-label"},"清除所有数据",-1)),r("div",pf,[r("button",{onClick:e[18]||(e[18]=(...o)=>t.clearAllData&&t.clearAllData(...o)),class:"action-button danger"}," 清除所有数据 "),e[46]||(e[46]=r("div",{class:"setting-description"}," 删除所有标签库、历史记录和设置。此操作将重置整个应用。 ",-1))])])])])}const yf=_e(yd,[["render",vf],["__scopeId","data-v-b54ec455"]]);const hf=He({name:"SettingsPanel",components:{ThemeSettings:Ou,DrawerSettings:vd,BackupSettings:yf},emits:["close"],setup(){return{activeTab:$("preferences")}}}),mf={class:"settings-panel"},bf={class:"panel-header"},$f={class:"header-actions"},wf={class:"panel-body"},Cf={class:"tab-container"},Tf={class:"tab-buttons"},_f={class:"tab-content-container"};function Lf(t,e,s,n,i,l){const o=ke("theme-settings"),a=ke("drawer-settings"),c=ke("backup-settings");return v(),h("div",mf,[r("div",bf,[e[4]||(e[4]=r("h3",null,"系统设置",-1)),r("div",$f,[r("button",{class:"close-btn",onClick:e[0]||(e[0]=u=>t.$emit("close"))},"×")])]),r("div",wf,[r("div",Cf,[r("div",Tf,[r("button",{class:ae(["tab-btn",{active:t.activeTab==="preferences"}]),onClick:e[1]||(e[1]=u=>t.activeTab="preferences")},"用户偏好",2),r("button",{class:ae(["tab-btn",{active:t.activeTab==="drawer"}]),onClick:e[2]||(e[2]=u=>t.activeTab="drawer")},"抽签设置",2),r("button",{class:ae(["tab-btn",{active:t.activeTab==="backup"}]),onClick:e[3]||(e[3]=u=>t.activeTab="backup")},"数据/备份",2)]),r("div",_f,[r("div",{class:ae(["tab-content",{active:t.activeTab==="preferences"}])},[be(o)],2),r("div",{class:ae(["tab-content",{active:t.activeTab==="drawer"}])},[be(a)],2),r("div",{class:ae(["tab-content",{active:t.activeTab==="backup"}])},[be(c)],2)])])])])}const Sf=_e(hf,[["render",Lf],["__scopeId","data-v-dfb8de7b"]]);const kf=He({name:"InfoPanel",setup(){const t=$(!1);return{showUpdateLog:t,openUpdateLog:()=>{t.value=!0},closeUpdateLog:()=>{t.value=!1}}}}),Ef={class:"panel"},Af={class:"info-content"},If={class:"info-section"},Mf={key:0,class:"update-log-modal"},Of={class:"update-log-content"},Df={class:"update-log-header"};function Pf(t,e,s,n,i,l){return v(),h("div",Ef,[e[10]||(e[10]=r("h2",null,"关于应用",-1)),r("div",Af,[e[6]||(e[6]=r("div",{class:"info-section"},[r("div",{class:"info-title"},"标签抽签工具"),r("p",null,"版本 1.2.3"),r("p",null,"一个用于管理和随机抽取标签的工具，适用于创意激发。随机选择等场景。支持多标签库、历史记录、权重抽取等高级功能。")],-1)),r("div",If,[e[3]||(e[3]=r("div",{class:"info-title"},"开发信息",-1)),e[4]||(e[4]=r("h4",null,"开发者: 蘭",-1)),e[5]||(e[5]=r("p",null,"联系邮箱: 3503146143@qq.com",-1)),r("p",null,[e[2]||(e[2]=Ge("更新日志: ")),r("a",{href:"#",class:"update-link",onClick:e[0]||(e[0]=Mt((...o)=>t.openUpdateLog&&t.openUpdateLog(...o),["prevent"]))},"查看")])]),e[7]||(e[7]=un('<h3 data-v-f0258b12>使用方法</h3><ol class="instruction-list" data-v-f0258b12><li data-v-f0258b12>在<strong data-v-f0258b12>设置</strong>面板中设置抽取数量</li><li data-v-f0258b12>选择要抽取的标签分类（或使用全部分类）</li><li data-v-f0258b12>可选：设置排除关键词，输入不想出现的关键词</li><li data-v-f0258b12>点击<strong data-v-f0258b12>抽签</strong>按钮获取随机标签</li><li data-v-f0258b12>抽取结果将显示在右侧面板中</li><li data-v-f0258b12>您还可以在<strong data-v-f0258b12>历史记录</strong>中查看和重用之前的抽取结果</li></ol><h3 data-v-f0258b12>功能特点</h3><ul class="feature-list" data-v-f0258b12><li data-v-f0258b12>多分类标签库，包括人物特质、故事背景、情节元素等</li><li data-v-f0258b12>自定义抽取数量，根据需要设置同时抽取的标签数量</li><li data-v-f0258b12>分类筛选，可以选择从特定分类或全部分类中抽取标签</li><li data-v-f0258b12>历史记录功能，保存之前的抽取结果，方便查看和重用</li><li data-v-f0258b12>支持导入自定义的JSON格式标签库，方便扩展和个性化</li><li data-v-f0258b12>美观的界面设计，操作简单直观</li></ul><div class="version-info" data-v-f0258b12><div class="github-link" data-v-f0258b12><a href="https://github.com/Tera-Dark/Inspiration-Provider" target="_blank" data-v-f0258b12> GitHub 开源项目 </a></div></div>',5))]),t.showUpdateLog?(v(),h("div",Mf,[r("div",Of,[r("div",Df,[e[8]||(e[8]=r("h3",null,"更新日志",-1)),r("button",{class:"close-btn",onClick:e[1]||(e[1]=(...o)=>t.closeUpdateLog&&t.closeUpdateLog(...o))},"×")]),e[9]||(e[9]=un('<div class="update-log-body" data-v-f0258b12><div class="version-entry" data-v-f0258b12><div class="version-header" data-v-f0258b12>版本 1.2.3 (2024-04-08)</div><ul class="version-changes" data-v-f0258b12><li data-v-f0258b12>修复高级编辑器标签管理功能</li><li data-v-f0258b12>优化事件处理机制，解决循环刷新问题</li><li data-v-f0258b12>增强表单验证和错误处理</li><li data-v-f0258b12>改进标签库数据处理逻辑</li><li data-v-f0258b12>添加详细日志记录，便于问题排查</li><li data-v-f0258b12>提升应用整体稳定性</li></ul></div><div class="version-entry" data-v-f0258b12><div class="version-header" data-v-f0258b12>版本 1.2.2 (2024-04-07)</div><ul class="version-changes" data-v-f0258b12><li data-v-f0258b12>优化权重添加器功能</li><li data-v-f0258b12>改进所长常规法典库的支持</li><li data-v-f0258b12>优化标签库预览界面布局</li><li data-v-f0258b12>修复对象格式标签的解析问题</li><li data-v-f0258b12>增强深色模式显示效果</li></ul></div><div class="version-entry" data-v-f0258b12><div class="version-header" data-v-f0258b12>版本 1.2.1 (2024-04-04)</div><ul class="version-changes" data-v-f0258b12><li data-v-f0258b12>添加标签格式转换工具</li><li data-v-f0258b12>支持多种文本格式导入</li><li data-v-f0258b12>优化移动端适配</li><li data-v-f0258b12>改进用户界面交互</li><li data-v-f0258b12>优化数据处理性能</li></ul></div><div class="version-entry" data-v-f0258b12><div class="version-header" data-v-f0258b12>版本 1.2.0 (2024-04-01)</div><ul class="version-changes" data-v-f0258b12><li data-v-f0258b12>新增权重添加器功能</li><li data-v-f0258b12>标签库管理系统升级</li><li data-v-f0258b12>深色模式优化</li><li data-v-f0258b12>本地数据存储增强</li><li data-v-f0258b12>响应式设计改进</li></ul></div><div class="version-entry" data-v-f0258b12><div class="version-header" data-v-f0258b12>版本 1.1.0 (2024-03-31)</div><ul class="version-changes" data-v-f0258b12><li data-v-f0258b12>新增标签权重功能</li><li data-v-f0258b12>新增历史记录管理</li><li data-v-f0258b12>改进用户界面交互</li><li data-v-f0258b12>修复多项已知问题</li></ul></div></div>',1))])])):x("",!0)])}const Hf=_e(kf,[["render",Pf],["__scopeId","data-v-f0258b12"]]);const Rf=He({name:"ImportPanel",props:{libraries:{type:Array,required:!0}},emits:["library-updated"],setup(t,{emit:e}){const s=ye("tagLibrary"),n=ye("emitter"),i=$("new"),l=$(""),o=$(""),a=$(null),c=$(!1),u=$(""),d=$(null),g=$("auto"),p=Se(()=>d.value?JSON.stringify(d.value,null,2):""),m=$(""),T=$(""),k=$(null),Z=()=>({default:"默认标签库",artists:"画师标签库",所长常规法典:"所长常规法典"})[T.value]||T.value,V=async()=>{if(!T.value){k.value=null;return}try{const M=await fetch(`/public/${T.value==="default"?"default.json":T.value==="artists"?"artists.json":"所长常规法典.json"}`);if(!M.ok)throw new Error("加载预设JSON失败");const z=await M.json();k.value=z,c.value=!1}catch(M){n.emit("notification",{type:"error",message:`加载预设JSON失败: ${M.message}`})}},F=M=>{console.log("文件选择器触发事件");const z=M.target.files[0];if(!z){console.log("没有选择文件"),c.value=!1,a.value=null;return}if(console.log("选择的文件:",z.name,z.type,z.size+" 字节"),z.type!=="application/json"&&!z.name.endsWith(".json")){console.log("文件类型不是JSON"),b("error","请选择JSON文件"),c.value=!1,a.value=null;return}const fe=new FileReader;fe.onload=A=>{try{let P=A.target.result;console.log("读取到文件内容，长度:",P.length);const de=JSON.parse(P);if(console.log("JSON解析成功，分类数:",Object.keys(de).length),typeof de!="object"||de===null)throw new Error("无效的JSON格式：必须是一个对象");let R=!1,Y=[];for(const X in de){if(!Array.isArray(de[X])){Y.push(X);continue}R=!0,console.log(`分类 "${X}" 包含 ${de[X].length} 个标签`)}if(Y.length>0)throw console.error("发现无效分类:",Y),new Error(`以下分类的内容不是数组: ${Y.join(", ")}`);if(!R)throw new Error("JSON文件必须包含至少一个分类");a.value=de,c.value=!0,b("success","文件加载成功"),T.value="",console.log("文件内容已成功加载到fileContent中")}catch(P){console.error("解析JSON失败:",P),b("error",`无法解析文件: ${P.message}`),c.value=!1,a.value=null;const de=document.querySelector('input[type="file"]');de&&(de.value="")}},fe.onerror=A=>{console.error("读取文件失败:",A),b("error","读取文件失败"),c.value=!1,a.value=null},console.log("开始读取文件..."),fe.readAsText(z)},H=()=>{l.value="",o.value="",a.value=null,c.value=!1,T.value="",k.value=null;const M=document.querySelector('input[type="file"]');M&&(M.value="")},b=(M,z)=>{n.emit("notification",{type:M,message:z})},D=()=>{u.value=""},te=()=>{d.value=null},q=()=>d.value?Object.keys(d.value).length:0,Te=()=>{if(!d.value)return 0;let M=0;for(const z in d.value)M+=d.value[z].length;return M},se=()=>{if(!u.value.trim()){b("warning","请先输入要转换的文本内容");return}try{let M=g.value;switch(M==="auto"&&(M=W(u.value)),M){case"categoryLineTag":d.value=re(u.value);break;case"tagHashCategory":d.value=C(u.value);break;case"commaCategory":d.value=G(u.value);break;case"characterTags":d.value=ue(u.value);break;default:b("error","无法识别的文本格式");return}b("success","文本转换成功")}catch(M){console.error("转换失败:",M),b("error","转换失败: "+M.message)}},W=M=>{if(/^●.+$/m.test(M))return"characterTags";if(/#[\u4e00-\u9fa5_a-zA-Z0-9]+/.test(M))return"tagHashCategory";const z=M.split(`
`).filter(fe=>fe.trim());for(const fe of z)if(/,.*\s+[\u4e00-\u9fa5_a-zA-Z0-9]+$/.test(fe))return"commaCategory";return"categoryLineTag"},re=M=>{const z={};let fe=null;const A=M.split(`
`);for(let P of A){if(P=P.trim(),!P){fe=null;continue}fe===null?(fe=P,z[fe]=[]):(z[fe]||(z[fe]=[]),z[fe].push({category:fe,subTitles:[],content:P}))}return z},C=M=>{const z={},fe=M.split(`
`);for(let A of fe){if(A=A.trim(),!A)continue;const P=A.match(/^(.+?)\s+#([\u4e00-\u9fa5_a-zA-Z0-9]+)$/);if(P){const[,de,R]=P;z[R]||(z[R]=[]),z[R].push({category:R,subTitles:[],content:de.trim()})}}return z},G=M=>{const z={},fe=M.split(`
`);for(let A of fe){if(A=A.trim(),!A)continue;const P=A.match(/^(.+?)\s+([\u4e00-\u9fa5_a-zA-Z0-9]+)$/);if(P){const[,de,R]=P,Y=de.split(",").map(X=>X.trim()).filter(X=>X);z[R]||(z[R]=[]);for(const X of Y)z[R].push({category:R,subTitles:[],content:X})}}return z},ue=M=>{const z={},fe=M.split(`
`);let A=null;for(const de of fe)if(de.trim().startsWith("●")){A=de.trim().substring(1).trim();break}if(!A)throw new Error("找不到主分类(以●开头的行)");z[A]=[];let P=null;for(let de=0;de<fe.length;de++){const R=fe[de].trim();if(R){if(R.startsWith("●")){P=R.substring(1).trim();continue}if(P&&!R.includes(",")&&de+1<fe.length){const Y=R,X=fe[de+1].trim();X&&X.includes(",")&&(z[A].push({content:X,subTitles:[Y,P].filter(Ae=>Ae!==A)}),de++)}}}return z},pe=()=>{if(!a.value){b("warning","请先选择JSON文件或预设");return}if(!l.value){b("warning","请输入新库名称");return}try{if(console.log("开始创建新库:",l.value),console.log("数据类型:",typeof a.value),console.log("分类数量:",Object.keys(a.value).length),typeof a.value!="object"||a.value===null)throw new Error("无效的数据格式：数据必须是一个对象");if(t.libraries.map(z=>z.name).includes(l.value))throw new Error(`库名 "${l.value}" 已存在，请使用不同的名称`);if(s.importLibrary)console.log("使用importLibrary方法"),s.importLibrary(l.value,a.value);else if(s.addLibrary){if(console.log("使用addLibrary方法"),!s.addLibrary(l.value,a.value))throw new Error("添加库失败，请查看控制台获取更多信息")}else throw new Error("缺少导入库的API，请确保标签库提供必要的方法");console.log("新库创建成功:",l.value),b("success",`成功创建新库 "${l.value}"`),H(),e("library-updated"),n.emit("tagLibraryUpdated")}catch(M){console.error("创建新库失败:",M),b("error",`创建新库失败: ${M.message}`)}},U=()=>{if(console.log("点击了扩展现有库按钮"),!a.value&&!k.value){console.error("没有要导入的数据"),b("error","没有要导入的数据，请先选择文件或预设");return}const M=a.value||k.value;if(console.log("要导入的数据:",Object.keys(M)),!o.value){console.error("未选择目标库"),b("error","请选择要扩展的目标库");return}console.log("目标库:",o.value);try{const z=s.getLibrary(o.value);if(!z)throw new Error(`找不到库: ${o.value}`);console.log("当前库数据:",Object.keys(z));const fe={...z};let A=0,P=0;for(const Y in M)if(Array.isArray(M[Y]))if(!fe[Y])fe[Y]=[...M[Y]],A++,P+=M[Y].length,console.log(`添加新分类: ${Y}，包含 ${M[Y].length} 个标签`);else{const X=new Set(fe[Y]),Ae=X.size;M[Y].forEach(f=>X.add(f)),fe[Y]=Array.from(X);const Ze=X.size-Ae;P+=Ze,console.log(`更新现有分类: ${Y}，添加了 ${Ze} 个标签`)}else console.warn(`跳过无效分类: ${Y}，它不是一个数组`);console.log("保存合并后的库:",Object.keys(fe)),s.setLibrary(o.value,fe),s._saveToStorage();const de=`成功扩展库 "${o.value}"：新增 ${A} 个分类和 ${P} 个标签`;console.log(de),b("success",de),c.value=!1,a.value=null,T.value="",k.value=null;const R=document.querySelector('input[type="file"]');R&&(R.value=""),updateLibraryList(),e("library-updated"),n.emit("tagLibraryUpdated")}catch(z){console.error("扩展库失败:",z),b("error",`扩展库失败: ${z.message}`)}},J=()=>{if(!d.value){b("warning","没有可导入的数据");return}try{const M=s.getCurrentLibraryName();s.extendLibrary(M,d.value),n.emit("tagLibraryUpdated"),b("success","数据导入成功")}catch(M){console.error("导入失败:",M),b("error","导入失败: "+M.message)}},ie=()=>{if(!d.value){b("warning","没有可复制的数据");return}try{const M=JSON.stringify(d.value,null,2);navigator.clipboard.writeText(M).then(()=>{b("success","已复制到剪贴板")})}catch(M){console.error("复制失败:",M),b("error","复制失败: "+M.message)}},ve=()=>{if(!m.value){b("warning","请先选择要导出的库");return}try{let M=s.getLibrary(m.value);if(!M||Object.keys(M).length===0)throw new Error(`库 "${m.value}" 数据为空或不存在`);const z=JSON.stringify(M,null,2),fe=new Blob([z],{type:"application/json"}),A=URL.createObjectURL(fe),P=document.createElement("a");P.href=A,P.download=`${m.value}.json`,document.body.appendChild(P),P.click(),setTimeout(()=>{document.body.removeChild(P),URL.revokeObjectURL(A)},100),b("success",`库 "${m.value}" 导出成功`)}catch(M){console.error("导出库失败:",M),b("error",`导出库失败: ${M.message}`)}};return{importMode:i,newLibraryName:l,selectedLibraryName:o,fileSelected:c,fileContent:a,presetFileContent:k,handleFileSelect:F,clearImport:H,importNewLibrary:pe,extendExistingLibrary:U,sourceText:u,convertedJson:d,textFormat:g,jsonPreview:p,countCategories:q,countTags:Te,convertTextToJson:se,clearSourceText:D,clearConvertedJson:te,importConvertedJson:J,copyJsonToClipboard:ie,exportLibraryName:m,exportLibrary:ve,exportCurrentLibrary:()=>{const M=s.getCurrentLibraryName();if(!M){b("warning","当前没有选择的库");return}m.value=M,ve()},selectedPresetJson:T,handlePresetChange:V,getPresetName:Z,debugCheckFileContent:()=>{if(console.log("=== 调试检查文件内容状态 ==="),console.log("fileContent 是否为null:",a.value===null),console.log("fileSelected 状态:",c.value),console.log("selectedLibraryName:",o.value),console.log("selectedPresetJson:",T.value),console.log("presetFileContent 是否为null:",k.value===null),a.value){console.log("上传文件内容摘要:"),console.log("- 分类数:",Object.keys(a.value).length);for(const z in a.value)Array.isArray(a.value[z])?console.log(`- ${z}: ${a.value[z].length} 个标签`):console.log(`- ${z}: 无效格式 (${typeof a.value[z]})`)}if(k.value){console.log("预设JSON内容摘要:"),console.log("- 分类数:",Object.keys(k.value).length);for(const z in k.value)Array.isArray(k.value[z])?console.log(`- ${z}: ${k.value[z].length} 个标签`):console.log(`- ${z}: 无效格式 (${typeof k.value[z]})`)}const M=document.querySelector('input[type="file"]');console.log("文件输入元素:",M?"已找到":"未找到"),M&&console.log("文件输入值:",M.value),console.log("可用库列表:"),t.libraries.forEach(z=>{console.log(`- ${z.name}: ${z.count} 个标签`)}),b("info","请查看控制台以获取调试信息")}}}}),Nf={class:"import-panel"},jf={class:"section"},Ff={class:"form-group"},Uf={class:"radio-group"},Bf={class:"radio-item"},Vf={class:"radio-item"},Jf={class:"json-import"},Kf={key:0,class:"form-group"},zf={key:1,class:"form-group"},Wf=["value"],Gf={class:"form-group"},Yf={key:0,class:"info-text"},qf={class:"form-group"},Qf={for:"import-file",class:"file-label"},Zf={key:0,class:"selected-file"},Xf={class:"action-group"},xf={key:0,class:"import-action"},eg=["disabled"],tg={key:1,class:"import-action"},sg=["disabled"],og={class:"section"},ng={class:"export-panel"},rg={class:"form-group"},ig=["value"],lg={class:"action-group"},ag=["disabled"],cg={class:"section"},ug={class:"text-convert-import"},dg={class:"card"},fg={class:"card-header"},gg={class:"format-selector"},pg={class:"radio-item"},vg={class:"radio-item"},yg={class:"radio-item"},hg={class:"radio-item"},mg={class:"radio-item"},bg={class:"button-row"},$g=["disabled"],wg=["disabled"],Cg={key:0,class:"card"},Tg={class:"card-header"},_g={class:"result-stats"},Lg={class:"button-row"};function Sg(t,e,s,n,i,l){return v(),h("div",Nf,[r("div",jf,[e[34]||(e[34]=r("h3",null,"导入方式",-1)),r("div",Ff,[r("div",Uf,[r("div",Bf,[B(r("input",{type:"radio",id:"import-new","onUpdate:modelValue":e[0]||(e[0]=o=>t.importMode=o),value:"new"},null,512),[[Bt,t.importMode]]),e[26]||(e[26]=r("label",{for:"import-new"},"创建新库",-1))]),r("div",Vf,[B(r("input",{type:"radio",id:"import-extend","onUpdate:modelValue":e[1]||(e[1]=o=>t.importMode=o),value:"extend"},null,512),[[Bt,t.importMode]]),e[27]||(e[27]=r("label",{for:"import-extend"},"扩展现有库",-1))])])]),r("div",Jf,[t.importMode==="new"?(v(),h("div",Kf,[e[28]||(e[28]=r("label",{for:"library-name"},"新库名称",-1)),B(r("input",{type:"text",id:"library-name","onUpdate:modelValue":e[2]||(e[2]=o=>t.newLibraryName=o),placeholder:"输入新标签库名称",class:"form-control"},null,512),[[Ee,t.newLibraryName]])])):(v(),h("div",zf,[e[30]||(e[30]=r("label",{for:"extend-library"},"选择要扩展的库",-1)),B(r("select",{id:"extend-library","onUpdate:modelValue":e[3]||(e[3]=o=>t.selectedLibraryName=o),class:"form-control"},[e[29]||(e[29]=r("option",{value:""},"-- 选择库 --",-1)),(v(!0),h(Q,null,ge(t.libraries,o=>(v(),h("option",{key:o.name,value:o.name},_(o.name)+" ("+_(o.count)+" 个标签) ",9,Wf))),128))],512),[[Ne,t.selectedLibraryName]])])),r("div",Gf,[e[32]||(e[32]=r("label",{for:"preset-json"},"预设JSON",-1)),B(r("select",{id:"preset-json","onUpdate:modelValue":e[4]||(e[4]=o=>t.selectedPresetJson=o),class:"form-control",onChange:e[5]||(e[5]=(...o)=>t.handlePresetChange&&t.handlePresetChange(...o))},e[31]||(e[31]=[r("option",{value:""},"-- 选择预设JSON --",-1),r("option",{value:"default"},"默认标签库",-1),r("option",{value:"artists"},"画师标签库",-1),r("option",{value:"所长常规法典"},"所长常规法典",-1)]),544),[[Ne,t.selectedPresetJson]]),t.selectedPresetJson?(v(),h("div",Yf,"已选择预设: "+_(t.getPresetName()),1)):x("",!0)]),r("div",qf,[r("label",Qf,[e[33]||(e[33]=r("span",null,"选择JSON文件",-1)),r("input",{type:"file",id:"import-file",onChange:e[6]||(e[6]=(...o)=>t.handleFileSelect&&t.handleFileSelect(...o)),accept:".json"},null,32)]),t.fileSelected&&!t.selectedPresetJson?(v(),h("div",Zf," 已选择文件 ")):x("",!0)]),r("div",Xf,[t.importMode==="new"?(v(),h("div",xf,[r("button",{onClick:e[7]||(e[7]=(...o)=>t.importNewLibrary&&t.importNewLibrary(...o)),class:"btn primary-btn",disabled:!t.fileSelected&&!t.selectedPresetJson},"创建新库",8,eg)])):(v(),h("div",tg,[r("button",{onClick:e[8]||(e[8]=(...o)=>t.extendExistingLibrary&&t.extendExistingLibrary(...o)),class:"btn primary-btn",disabled:!t.fileSelected&&!t.selectedPresetJson},"扩展现有库",8,sg)])),r("button",{onClick:e[9]||(e[9]=(...o)=>t.clearImport&&t.clearImport(...o)),class:"btn secondary-btn"},"清空"),r("button",{onClick:e[10]||(e[10]=(...o)=>t.debugCheckFileContent&&t.debugCheckFileContent(...o)),class:"btn debug-btn"},"调试检查")])])]),r("div",og,[e[36]||(e[36]=r("h3",null,"标签库导出",-1)),r("div",ng,[r("div",rg,[e[35]||(e[35]=r("label",{for:"export-library"},"选择要导出的库",-1)),B(r("select",{id:"export-library","onUpdate:modelValue":e[11]||(e[11]=o=>t.exportLibraryName=o),class:"form-control"},[(v(!0),h(Q,null,ge(t.libraries,o=>(v(),h("option",{key:o.name,value:o.name},_(o.name),9,ig))),128))],512),[[Ne,t.exportLibraryName]])]),r("div",lg,[r("button",{onClick:e[12]||(e[12]=(...o)=>t.exportLibrary&&t.exportLibrary(...o)),class:"btn primary-btn",disabled:!t.exportLibraryName},"导出为JSON",8,ag),r("button",{onClick:e[13]||(e[13]=(...o)=>t.exportCurrentLibrary&&t.exportCurrentLibrary(...o)),class:"btn secondary-btn"},"导出当前库")])])]),r("div",cg,[e[44]||(e[44]=r("h3",null,"文本转换导入",-1)),r("div",ug,[r("div",dg,[r("div",fg,[e[42]||(e[42]=r("h4",null,"文本标签转换工具",-1)),r("div",gg,[r("label",pg,[B(r("input",{type:"radio","onUpdate:modelValue":e[14]||(e[14]=o=>t.textFormat=o),value:"auto"},null,512),[[Bt,t.textFormat]]),e[37]||(e[37]=r("span",null,"自动检测",-1))]),r("label",vg,[B(r("input",{type:"radio","onUpdate:modelValue":e[15]||(e[15]=o=>t.textFormat=o),value:"categoryLineTag"},null,512),[[Bt,t.textFormat]]),e[38]||(e[38]=r("span",null,"分类换行标签",-1))]),r("label",yg,[B(r("input",{type:"radio","onUpdate:modelValue":e[16]||(e[16]=o=>t.textFormat=o),value:"tagHashCategory"},null,512),[[Bt,t.textFormat]]),e[39]||(e[39]=r("span",null,"标签#分类",-1))]),r("label",hg,[B(r("input",{type:"radio","onUpdate:modelValue":e[17]||(e[17]=o=>t.textFormat=o),value:"commaCategory"},null,512),[[Bt,t.textFormat]]),e[40]||(e[40]=r("span",null,"逗号分隔分类",-1))]),r("label",mg,[B(r("input",{type:"radio","onUpdate:modelValue":e[18]||(e[18]=o=>t.textFormat=o),value:"characterTags"},null,512),[[Bt,t.textFormat]]),e[41]||(e[41]=r("span",null,"法典标签格式",-1))])])]),B(r("textarea",{"onUpdate:modelValue":e[19]||(e[19]=o=>t.sourceText=o),class:"form-control",rows:"10",placeholder:"请粘贴需要转换的文本内容..."},null,512),[[Ee,t.sourceText]]),r("div",bg,[r("button",{class:"btn primary-btn",onClick:e[20]||(e[20]=(...o)=>t.convertTextToJson&&t.convertTextToJson(...o)),disabled:!t.sourceText.trim()}," 转换为JSON ",8,$g),r("button",{class:"btn secondary-btn",onClick:e[21]||(e[21]=(...o)=>t.clearSourceText&&t.clearSourceText(...o)),disabled:!t.sourceText.trim()}," 清空输入 ",8,wg)])]),t.convertedJson?(v(),h("div",Cg,[r("div",Tg,[e[43]||(e[43]=r("h4",null,"转换结果预览",-1)),r("div",_g," 发现 "+_(t.countCategories())+" 个分类，"+_(t.countTags())+" 个标签 ",1)]),B(r("textarea",{"onUpdate:modelValue":e[22]||(e[22]=o=>t.jsonPreview=o),class:"form-control",rows:"10",readonly:""},null,512),[[Ee,t.jsonPreview]]),r("div",Lg,[r("button",{class:"btn primary-btn",onClick:e[23]||(e[23]=(...o)=>t.importConvertedJson&&t.importConvertedJson(...o))}," 导入转换后的JSON "),r("button",{class:"btn secondary-btn",onClick:e[24]||(e[24]=(...o)=>t.copyJsonToClipboard&&t.copyJsonToClipboard(...o))}," 复制JSON "),r("button",{class:"btn secondary-btn",onClick:e[25]||(e[25]=(...o)=>t.clearConvertedJson&&t.clearConvertedJson(...o))}," 清空结果 ")])])):x("",!0)])])])}const kg=_e(Rf,[["render",Sg],["__scopeId","data-v-53dc1863"]]);const Eg=He({name:"ManagePanel",props:{libraries:{type:Array,required:!0},currentLibrary:{type:String,required:!0}},emits:["library-updated","switch-library"],setup(t,{emit:e}){const s=ye("tagLibrary"),n=ye("emitter"),i=$(""),l=$(""),o=$(""),a=$(""),c=$(""),u=$(""),d=$(""),g=$("");return{createLibraryName:i,renameSource:l,renameTarget:o,duplicateSource:a,duplicateTarget:c,mergeSource:u,mergeTarget:d,cleanupTarget:g,switchLibrary:b=>{b!==t.currentLibrary&&e("switch-library",b)},createNewLibrary:()=>{if(!i.value){n.emit("notification",{type:"warning",message:"请输入新库名称"});return}try{s.createEmptyLibrary?s.createEmptyLibrary(i.value):s.addLibrary(i.value,{}),n.emit("notification",{type:"success",message:`成功创建库 "${i.value}"`});const b=i.value;i.value="",e("library-updated"),e("switch-library",b)}catch(b){n.emit("notification",{type:"error",message:`创建库失败: ${b.message}`})}},deleteCurrentLibrary:()=>{if(t.libraries.length<=1){n.emit("notification",{type:"warning",message:"至少需要保留一个标签库"});return}if(confirm(`确定要删除标签库 "${t.currentLibrary}" 吗？此操作不可恢复。`))try{s.deleteLibrary(t.currentLibrary),n.emit("notification",{type:"success",message:`成功删除标签库 "${t.currentLibrary}"`}),e("library-updated")}catch(b){n.emit("notification",{type:"error",message:`删除库失败: ${b.message}`})}},renameLibrary:()=>{if(!l.value||!o.value){n.emit("notification",{type:"warning",message:"请选择要重命名的库并输入新名称"});return}try{s.renameLibrary(l.value,o.value),n.emit("notification",{type:"success",message:`成功将库 "${l.value}" 重命名为 "${o.value}"`}),l.value="",o.value="",e("library-updated"),t.currentLibrary===l.value&&e("switch-library",o.value)}catch(b){n.emit("notification",{type:"error",message:`重命名库失败: ${b.message}`})}},duplicateLibrary:()=>{if(!a.value||!c.value){n.emit("notification",{type:"warning",message:"请选择源库并输入新库名称"});return}try{s.duplicateLibrary(a.value,c.value),n.emit("notification",{type:"success",message:`成功复制库 "${a.value}" 到 "${c.value}"`}),a.value="",c.value="",e("library-updated")}catch(b){n.emit("notification",{type:"error",message:`复制库失败: ${b.message}`})}},mergeLibraries:()=>{if(!u.value||!d.value){n.emit("notification",{type:"warning",message:"请选择源库和目标库"});return}if(u.value===d.value){n.emit("notification",{type:"warning",message:"源库和目标库不能相同"});return}try{s.mergeLibraries(u.value,d.value),n.emit("notification",{type:"success",message:`成功将库 "${u.value}" 合并到 "${d.value}"`}),u.value="",d.value="",e("library-updated")}catch(b){n.emit("notification",{type:"error",message:`合并库失败: ${b.message}`})}},cleanEmptyCategories:()=>{if(!g.value){n.emit("notification",{type:"warning",message:"请选择要清理的库"});return}try{const b=s.cleanEmptyCategories(g.value);n.emit("notification",{type:"success",message:b>0?`清理成功：删除了 ${b} 个空分类`:"没有发现空分类"}),b>0&&e("library-updated")}catch(b){n.emit("notification",{type:"error",message:`清理空分类失败: ${b.message}`})}},cleanDuplicateTags:()=>{if(!g.value){n.emit("notification",{type:"warning",message:"请选择要清理的库"});return}try{const b=s.cleanDuplicateTags(g.value);n.emit("notification",{type:"success",message:b>0?`清理成功：删除了 ${b} 个重复标签`:"没有发现重复标签"}),b>0&&e("library-updated")}catch(b){n.emit("notification",{type:"error",message:`清理重复标签失败: ${b.message}`})}}}}}),Ag={class:"manage-container"},Ig={class:"section"},Mg={class:"form-group"},Og={class:"input-group"},Dg={class:"form-group"},Pg={class:"section"},Hg={class:"action-container"},Rg={class:"action-section"},Ng={class:"action-controls"},jg=["value"],Fg={class:"action-section"},Ug={class:"action-controls"},Bg=["value"],Vg={class:"action-section"},Jg={class:"action-controls"},Kg=["value"],zg=["value"],Wg={class:"action-section"},Gg={class:"action-controls"},Yg=["value"],qg={class:"section"},Qg={class:"libraries-list"},Zg=["onClick"],Xg={class:"library-name"},xg={class:"library-count"},ep={key:0,class:"empty-message"};function tp(t,e,s,n,i,l){return v(),h("div",Ag,[r("div",Ig,[e[15]||(e[15]=r("h3",null,"创建标签库",-1)),r("div",Mg,[r("div",Og,[B(r("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=o=>t.createLibraryName=o),placeholder:"新建库名称",class:"form-control"},null,512),[[Ee,t.createLibraryName]]),r("button",{onClick:e[1]||(e[1]=(...o)=>t.createNewLibrary&&t.createNewLibrary(...o)),class:"btn primary-btn"},"创建新库")])]),r("div",Dg,[r("button",{onClick:e[2]||(e[2]=(...o)=>t.deleteCurrentLibrary&&t.deleteCurrentLibrary(...o)),class:"btn danger-btn"},"删除当前库")])]),r("div",Pg,[e[25]||(e[25]=r("h3",null,"高级管理",-1)),r("div",Hg,[r("div",Rg,[e[17]||(e[17]=r("h4",null,"重命名库",-1)),r("div",Ng,[B(r("select",{"onUpdate:modelValue":e[3]||(e[3]=o=>t.renameSource=o),class:"form-control small"},[e[16]||(e[16]=r("option",{value:""},"选择要重命名的库",-1)),(v(!0),h(Q,null,ge(t.libraries,o=>(v(),h("option",{key:`rename-${o.name}`,value:o.name},_(o.name),9,jg))),128))],512),[[Ne,t.renameSource]]),B(r("input",{type:"text","onUpdate:modelValue":e[4]||(e[4]=o=>t.renameTarget=o),placeholder:"新名称",class:"form-control small"},null,512),[[Ee,t.renameTarget]]),r("button",{onClick:e[5]||(e[5]=(...o)=>t.renameLibrary&&t.renameLibrary(...o)),class:"btn action-btn"},"重命名")])]),r("div",Fg,[e[19]||(e[19]=r("h4",null,"复制库",-1)),r("div",Ug,[B(r("select",{"onUpdate:modelValue":e[6]||(e[6]=o=>t.duplicateSource=o),class:"form-control small"},[e[18]||(e[18]=r("option",{value:""},"选择源库",-1)),(v(!0),h(Q,null,ge(t.libraries,o=>(v(),h("option",{key:`duplicate-${o.name}`,value:o.name},_(o.name),9,Bg))),128))],512),[[Ne,t.duplicateSource]]),B(r("input",{type:"text","onUpdate:modelValue":e[7]||(e[7]=o=>t.duplicateTarget=o),placeholder:"新库名称",class:"form-control small"},null,512),[[Ee,t.duplicateTarget]]),r("button",{onClick:e[8]||(e[8]=(...o)=>t.duplicateLibrary&&t.duplicateLibrary(...o)),class:"btn action-btn"},"复制")])]),r("div",Vg,[e[22]||(e[22]=r("h4",null,"合并库",-1)),r("div",Jg,[B(r("select",{"onUpdate:modelValue":e[9]||(e[9]=o=>t.mergeSource=o),class:"form-control small"},[e[20]||(e[20]=r("option",{value:""},"选择源库",-1)),(v(!0),h(Q,null,ge(t.libraries,o=>(v(),h("option",{key:`merge-source-${o.name}`,value:o.name},_(o.name),9,Kg))),128))],512),[[Ne,t.mergeSource]]),B(r("select",{"onUpdate:modelValue":e[10]||(e[10]=o=>t.mergeTarget=o),class:"form-control small"},[e[21]||(e[21]=r("option",{value:""},"选择目标库",-1)),(v(!0),h(Q,null,ge(t.libraries,o=>(v(),h("option",{key:`merge-target-${o.name}`,value:o.name},_(o.name),9,zg))),128))],512),[[Ne,t.mergeTarget]]),r("button",{onClick:e[11]||(e[11]=(...o)=>t.mergeLibraries&&t.mergeLibraries(...o)),class:"btn action-btn"},"合并")])]),r("div",Wg,[e[24]||(e[24]=r("h4",null,"清理和优化",-1)),r("div",Gg,[B(r("select",{"onUpdate:modelValue":e[12]||(e[12]=o=>t.cleanupTarget=o),class:"form-control small"},[e[23]||(e[23]=r("option",{value:""},"选择要清理的库",-1)),(v(!0),h(Q,null,ge(t.libraries,o=>(v(),h("option",{key:`cleanup-${o.name}`,value:o.name},_(o.name),9,Yg))),128))],512),[[Ne,t.cleanupTarget]]),r("button",{onClick:e[13]||(e[13]=(...o)=>t.cleanEmptyCategories&&t.cleanEmptyCategories(...o)),class:"btn action-btn",title:"删除没有标签的空分类"},"清理空分类"),r("button",{onClick:e[14]||(e[14]=(...o)=>t.cleanDuplicateTags&&t.cleanDuplicateTags(...o)),class:"btn action-btn",title:"删除重复的标签"},"去除重复标签")])])])]),r("div",qg,[e[26]||(e[26]=r("h3",null,"库列表",-1)),r("div",Qg,[(v(!0),h(Q,null,ge(t.libraries,o=>(v(),h("div",{key:o.name,class:ae(["library-item",{active:t.currentLibrary===o.name}]),onClick:a=>t.switchLibrary(o.name)},[r("span",Xg,_(o.name),1),r("span",xg,_(o.count)+" 个标签",1)],10,Zg))),128)),t.libraries.length===0?(v(),h("div",ep," 无可用标签库 ")):x("",!0)])])])}const sp=_e(Eg,[["render",tp],["__scopeId","data-v-9f089735"]]);const op=He({name:"PreviewPanel",props:{currentLibrary:{type:String,required:!0}},setup(t){const e=ye("tagLibrary"),s=ye("emitter"),n=$(""),i=$("all"),l=$("category"),o=$(20),a=$(1),c=$(0),u=Se(()=>{c.value;try{if(e.getCategories){const H=e.getCategories(t.currentLibrary);if(Array.isArray(H))return H}const F=e.getLibrary(t.currentLibrary);return F?Object.keys(F):[]}catch(F){return console.error("获取分类失败:",F),[]}}),d=Se(()=>{c.value;try{if(e.getTagCountByLibrary)return e.getTagCountByLibrary(t.currentLibrary);if(e.getAllTags){const b=e.getAllTags(t.currentLibrary);return Array.isArray(b)?b.length:0}const F=e.getLibrary(t.currentLibrary);if(!F)return 0;let H=0;for(const b in F)Array.isArray(F[b])&&(H+=F[b].length);return H}catch(F){return console.error("获取标签总数失败:",F),0}}),g=Se(()=>u.value.length),p=Se(()=>{c.value;try{let F=[];if(e.getAllTags)F=e.getAllTags(t.currentLibrary);else{const H=e.getLibrary(t.currentLibrary);if(!H)return[];for(const b in H)Array.isArray(H[b])&&(F=F.concat(H[b].map(D=>typeof D=="string"?{category:b,content:D}:{category:b,content:D.content||"",subTitles:D.subTitles||[]})))}return F=F.map(H=>({category:H.category||"",content:H.content||"",subTitles:Array.isArray(H.subTitles)?H.subTitles:[]})),F.filter(H=>{if(i.value!=="all"&&H.category!==i.value)return!1;if(n.value){const b=n.value.toLowerCase(),D=(H.content||"").toLowerCase(),te=(H.subTitles||[]).join(" ").toLowerCase();return D.includes(b)||te.includes(b)}return!0})}catch(F){return console.error("处理标签数据失败:",F),[]}}),m=Se(()=>Math.max(1,Math.ceil(p.value.length/o.value))),T=Se(()=>{const F=(a.value-1)*o.value,H=F+o.value;return p.value.slice(F,H)}),k=Se(()=>{const F={};return p.value.forEach(H=>{F[H.category]||(F[H.category]=[]),F[H.category].push(H)}),F}),Z=Se(()=>{const F={};let H=0;const b=(a.value-1)*o.value,D=b+o.value;for(const te in k.value){const q=k.value[te];if(H>=D)break;if(H+q.length>b){const Te=Math.max(0,b-H),se=Math.min(q.length,D-H);F[te]=q.slice(Te,se)}H+=q.length}return F});Qe([n,i,l],()=>{a.value=1}),Qe(()=>t.currentLibrary,()=>{a.value=1,n.value="",i.value="all"});const V=()=>{c.value++,a.value=1};return Ke(()=>{s.on("tagLibraryUpdated",V)}),ks(()=>{s.off("tagLibraryUpdated",V)}),{previewFilter:n,previewCategory:i,previewDisplayMode:l,pageSize:o,currentPage:a,refreshTrigger:c,categories:u,tagCount:d,categoryCount:g,filteredPreviewTags:p,totalPages:m,paginatedTags:T,paginatedGroupedTags:Z}}}),np={class:"preview-container"},rp={class:"section"},ip={class:"info-stats"},lp={class:"info-item"},ap={class:"info-value"},cp={class:"info-item"},up={class:"info-value"},dp={class:"info-item"},fp={class:"info-value"},gp={class:"section"},pp={class:"filter-container"},vp={class:"form-group"},yp={class:"input-group"},hp=["value"],mp={class:"display-options"},bp={class:"option-group"},$p={class:"segmented-control"},wp={class:"option-group"},Cp={class:"section preview-section"},Tp={class:"tag-preview-container"},_p={key:0,class:"empty-message"},Lp={class:"category-header"},Sp={class:"category-name"},kp={class:"category-count"},Ep={class:"tag-grid"},Ap={class:"tag-content"},Ip={key:0,class:"tag-subtitle"},Mp={key:2,class:"list-view"},Op={class:"data-table"},Dp={key:3,class:"card-view"},Pp={class:"card-grid"},Hp={class:"card-category"},Rp={class:"card-content"},Np={key:0,class:"card-subtitle"},jp={key:4,class:"pagination"},Fp=["disabled"],Up=["disabled"],Bp={class:"page-info"},Vp=["disabled"],Jp=["disabled"];function Kp(t,e,s,n,i,l){return v(),h("div",np,[r("div",rp,[e[13]||(e[13]=r("h3",null,"库信息",-1)),r("div",ip,[r("div",lp,[e[10]||(e[10]=r("span",{class:"info-label"},"当前库:",-1)),r("span",ap,_(t.currentLibrary),1)]),r("div",cp,[e[11]||(e[11]=r("span",{class:"info-label"},"标签总数:",-1)),r("span",up,_(t.tagCount),1)]),r("div",dp,[e[12]||(e[12]=r("span",{class:"info-label"},"分类总数:",-1)),r("span",fp,_(t.categoryCount),1)])])]),r("div",gp,[e[18]||(e[18]=r("h3",null,"搜索与筛选",-1)),r("div",pp,[r("div",vp,[r("div",yp,[B(r("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=o=>t.previewFilter=o),placeholder:"搜索标签...",class:"form-control"},null,512),[[Ee,t.previewFilter]]),B(r("select",{"onUpdate:modelValue":e[1]||(e[1]=o=>t.previewCategory=o),class:"form-control category-select"},[e[14]||(e[14]=r("option",{value:"all"},"全部分类",-1)),(v(!0),h(Q,null,ge(t.categories,o=>(v(),h("option",{key:o,value:o},_(o),9,hp))),128))],512),[[Ne,t.previewCategory]])])]),r("div",mp,[r("div",bp,[e[15]||(e[15]=r("label",null,"显示模式:",-1)),r("div",$p,[r("button",{class:ae({active:t.previewDisplayMode==="category"}),onClick:e[2]||(e[2]=o=>t.previewDisplayMode="category")},"按分类",2),r("button",{class:ae({active:t.previewDisplayMode==="list"}),onClick:e[3]||(e[3]=o=>t.previewDisplayMode="list")},"列表",2),r("button",{class:ae({active:t.previewDisplayMode==="card"}),onClick:e[4]||(e[4]=o=>t.previewDisplayMode="card")},"卡片",2)])]),r("div",wp,[e[17]||(e[17]=r("label",null,"每页显示:",-1)),B(r("select",{"onUpdate:modelValue":e[5]||(e[5]=o=>t.pageSize=o),class:"page-size-select"},e[16]||(e[16]=[r("option",{value:20},"20",-1),r("option",{value:50},"50",-1),r("option",{value:100},"100",-1),r("option",{value:200},"200",-1),r("option",{value:500},"500",-1)]),512),[[Ne,t.pageSize]])])])])]),r("div",Cp,[e[20]||(e[20]=r("h3",null,"标签预览",-1)),r("div",Tp,[t.filteredPreviewTags.length===0?(v(),h("div",_p," 没有找到匹配的标签 ")):t.previewDisplayMode==="category"?(v(!0),h(Q,{key:1},ge(t.paginatedGroupedTags,(o,a)=>(v(),h("div",{key:a,class:"category-block"},[r("div",Lp,[r("span",Sp,_(a),1),r("span",kp,_(o.length)+" 个标签",1)]),r("div",Ep,[(v(!0),h(Q,null,ge(o,c=>(v(),h("div",{key:`${a}-${c.content}`,class:"tag-item"},[r("div",Ap,_(c.content),1),c.subTitles&&c.subTitles.length>0?(v(),h("div",Ip,_(c.subTitles.join(" / ")),1)):x("",!0)]))),128))])]))),128)):t.previewDisplayMode==="list"?(v(),h("div",Mp,[r("table",Op,[e[19]||(e[19]=r("thead",null,[r("tr",null,[r("th",null,"分类"),r("th",null,"标签"),r("th",null,"子标题")])],-1)),r("tbody",null,[(v(!0),h(Q,null,ge(t.paginatedTags,(o,a)=>(v(),h("tr",{key:a},[r("td",null,_(o.category),1),r("td",null,_(o.content),1),r("td",null,_(o.subTitles?o.subTitles.join(" / "):""),1)]))),128))])])])):(v(),h("div",Dp,[r("div",Pp,[(v(!0),h(Q,null,ge(t.paginatedTags,(o,a)=>(v(),h("div",{key:a,class:"tag-card"},[r("div",Hp,_(o.category),1),r("div",Rp,_(o.content),1),o.subTitles&&o.subTitles.length>0?(v(),h("div",Np,_(o.subTitles.join(" / ")),1)):x("",!0)]))),128))])])),t.filteredPreviewTags.length>0?(v(),h("div",jp,[r("button",{class:"btn pagination-btn",onClick:e[6]||(e[6]=o=>t.currentPage=1),disabled:t.currentPage===1},"首页",8,Fp),r("button",{class:"btn pagination-btn",onClick:e[7]||(e[7]=o=>t.currentPage--),disabled:t.currentPage===1},"上一页",8,Up),r("span",Bp,_(t.currentPage)+" / "+_(t.totalPages),1),r("button",{class:"btn pagination-btn",onClick:e[8]||(e[8]=o=>t.currentPage++),disabled:t.currentPage===t.totalPages},"下一页",8,Vp),r("button",{class:"btn pagination-btn",onClick:e[9]||(e[9]=o=>t.currentPage=t.totalPages),disabled:t.currentPage===t.totalPages},"末页",8,Jp)])):x("",!0)])])])}const zp=_e(op,[["render",Kp],["__scopeId","data-v-98e863ed"]]);const Wp=He({name:"EditorPanel",props:{libraries:{type:Array,default:()=>[]},currentLibrary:{type:String,default:""}},emits:["library-updated"],setup(t,{emit:e}){const s=ye("tagLibrary"),n=ye("emitter"),i=$("json"),l=$(""),o=$(""),a=$(""),c=$(""),u=$(!1),d=$(!1),g=$(""),p=$(null),m=Se(()=>i.value==="json"?u.value:d.value),T=Se(()=>m.value?Object.keys(p.value||{}).sort():[]),k=Se(()=>T.value.length>0),Z=Se(()=>!g.value||!p.value?[]:p.value[g.value]||[]),V=()=>{t.currentLibrary&&(a.value=t.currentLibrary)},F=async()=>{if(!a.value){c.value="请选择目标库";return}try{const C=s.getLibrary(a.value);i.value==="json"?(l.value=JSON.stringify(C,null,2),H()):(o.value=D(C),b()),p.value=C,g.value="",n.emit("notification",{type:"success",message:`已加载 "${a.value}" 库到编辑器`})}catch(C){c.value=`加载库失败: ${C.message}`,n.emit("notification",{type:"error",message:`加载库失败: ${C.message}`})}},H=()=>{try{if(!l.value.trim()){u.value=!1,c.value="",p.value=null;return}const C=JSON.parse(l.value);u.value=!0,c.value="",p.value=C,n.emit("notification",{type:"success",message:"格式验证成功"})}catch(C){u.value=!1,c.value=`JSON格式错误: ${C.message}`,p.value=null}},b=()=>{try{if(!o.value.trim()){d.value=!1,c.value="",p.value=null;return}const C=te(o.value);d.value=!0,c.value="",p.value=C,n.emit("notification",{type:"success",message:"格式验证成功"})}catch(C){d.value=!1,c.value=`文本格式错误: ${C.message}`,p.value=null}},D=C=>{let G="";for(const ue in C)G+=`${ue}:
`,Array.isArray(C[ue])&&C[ue].forEach(pe=>{if(typeof pe=="string")G+=`${pe}
`;else if(pe&&typeof pe=="object"){let J=pe.content||"";pe.subTitles&&Array.isArray(pe.subTitles)&&pe.subTitles.length>0&&(J+=`|${pe.subTitles.join(",")}`),G+=`${J}
`}}),G+=`
`;return G.trim()},te=C=>{const G=C.split(`
`),ue={};let pe=null;for(let U=0;U<G.length;U++){const J=G[U].trim();if(J)if(J.endsWith(":"))pe=J.substring(0,J.length-1).trim(),ue[pe]=[];else if(pe)if(J.includes("|")){const[ie,ve]=J.split("|"),je={content:ie.trim()};ve&&ve.trim()&&(je.subTitles=ve.split(",").map(De=>De.trim())),ue[pe].push(je)}else ue[pe].push(J);else throw new Error(`第 ${U+1} 行没有对应的分类`)}return ue},q=()=>{try{if(i.value==="json"&&u.value){const C=JSON.parse(l.value);o.value=D(C),i.value="text",d.value=!0}else if(i.value==="text"&&d.value){const C=te(o.value);l.value=JSON.stringify(C,null,2),i.value="json",u.value=!0}}catch(C){c.value=`格式转换失败: ${C.message}`}},Te=C=>{if(C!==i.value)try{if(C==="json"&&d.value){const G=te(o.value);l.value=JSON.stringify(G,null,2),i.value="json",u.value=!0}else if(C==="text"&&u.value){const G=JSON.parse(l.value);o.value=D(G),i.value="text",d.value=!0}else i.value=C}catch(G){c.value=`切换模式失败: ${G.message}`}},se=C=>{if(!p.value||!p.value[C])return[];const G=p.value[C];return Array.isArray(G)?G:[]},W=()=>{try{let C,G,ue;if(!m.value)throw new Error("当前内容格式无效，无法导出");i.value==="json"?(C=l.value,G=`tag_library_${Date.now()}.json`,ue="application/json"):(C=o.value,G=`tag_library_${Date.now()}.txt`,ue="text/plain");const pe=new Blob([C],{type:ue}),U=URL.createObjectURL(pe),J=document.createElement("a");J.href=U,J.download=G,document.body.appendChild(J),J.click(),document.body.removeChild(J),n.emit("notification",{type:"success",message:`成功导出${i.value==="json"?"JSON":"文本"}格式文件`})}catch(C){c.value=`导出失败: ${C.message}`,n.emit("notification",{type:"error",message:`导出失败: ${C.message}`})}},re=()=>{try{if(!a.value)throw new Error("请选择目标库");if(!m.value)throw new Error("当前内容格式无效，无法保存");if(!p.value||typeof p.value!="object")throw new Error("库数据必须是有效的对象");const C=Object.keys(p.value);if(C.length===0)throw new Error("库数据必须至少包含一个分类");for(const pe of C)if(!Array.isArray(p.value[pe]))throw new Error(`分类 "${pe}" 的内容必须是数组`);const G=confirm(`您想要覆盖现有的标签库内容吗？

点击"确定"将完全覆盖当前库内容。
点击"取消"将合并内容(保留现有标签并添加新标签)。`);let ue=!1;if(G){if(s.setLibrary)ue=s.setLibrary(a.value,p.value);else if(s.addLibrary)ue=s.addLibrary(a.value,p.value);else throw new Error("缺少保存库的API，请确保标签库提供必要的方法");n.emit("notification",{type:"success",message:`已成功覆盖"${a.value}"库`})}else{if(s.extendLibrary)s.extendLibrary(a.value,p.value),ue=!0;else throw new Error("缺少合并库的API，请确保标签库提供extendLibrary方法");n.emit("notification",{type:"success",message:`已成功将内容合并到"${a.value}"库`})}if(!ue)throw new Error("保存库操作未成功完成，可能是因为数据格式问题");e("library-updated")}catch(C){c.value=`保存失败: ${C.message}`,n.emit("notification",{type:"error",message:`保存失败: ${C.message}`})}};return Qe(()=>t.currentLibrary,C=>{C&&(a.value=C)}),V(),{editorMode:i,jsonContent:l,textContent:o,editorTargetLibrary:a,editorError:c,isValid:m,categories:T,hasCategories:k,selectedCategory:g,filteredCategoryTags:Z,loadCurrentLibrary:F,validateJson:H,validateText:b,switchEditorMode:Te,convertFormat:q,getCategoryTags:se,exportEditorContent:W,saveEditorContent:re}}}),Gp={class:"editor-container"},Yp={class:"section"},qp={class:"section-header"},Qp={class:"header-actions"},Zp={class:"editor-toolbar"},Xp={class:"toolbar-group"},xp={class:"segmented-control"},ev={class:"toolbar-group"},tv=["value"],sv={class:"editor-main"},ov={key:0,class:"editor-wrapper"},nv={key:1,class:"editor-wrapper"},rv={class:"editor-footer"},iv={class:"editor-status"},lv={key:0,class:"error-message"},av={key:1,class:"success-message"},cv={class:"conversion-actions"},uv=["disabled"],dv={class:"section preview-section"},fv={class:"section-header"},gv={class:"header-actions"},pv=["disabled"],vv=["value"],yv={key:0,class:"preview-content"},hv={key:0,class:"category-preview"},mv={class:"tag-count"},bv={key:0,class:"tag-list"},$v={class:"tag-content"},wv={key:0,class:"tag-subtitles"},Cv={key:1,class:"empty-preview"},Tv={key:1,class:"all-categories-preview"},_v={class:"tag-count"},Lv={class:"tag-list"},Sv={class:"tag-content"},kv={key:0,class:"tag-subtitles"},Ev={key:0,class:"more-tags"},Av={key:1,class:"empty-preview"};function Iv(t,e,s,n,i,l){return v(),h("div",Gp,[r("div",Yp,[r("div",qp,[e[14]||(e[14]=r("div",{class:"header-title"},[r("h3",null,"标签库编辑器"),r("div",{class:"header-subtitle"},"按照格式编辑标签，完成后可以导出或保存")],-1)),r("div",Qp,[r("button",{onClick:e[0]||(e[0]=(...o)=>t.exportEditorContent&&t.exportEditorContent(...o)),class:"btn secondary-btn"},e[12]||(e[12]=[r("span",null,"导出JSON",-1)])),r("button",{onClick:e[1]||(e[1]=(...o)=>t.saveEditorContent&&t.saveEditorContent(...o)),class:"btn primary-btn"},e[13]||(e[13]=[r("span",null,"保存到库",-1)]))])]),r("div",Zp,[r("div",Xp,[e[15]||(e[15]=r("label",null,"编辑模式:",-1)),r("div",xp,[r("button",{class:ae({active:t.editorMode==="json"}),onClick:e[2]||(e[2]=o=>t.switchEditorMode("json"))},"JSON",2),r("button",{class:ae({active:t.editorMode==="text"}),onClick:e[3]||(e[3]=o=>t.switchEditorMode("text"))},"文本格式",2)])]),r("div",ev,[e[17]||(e[17]=r("label",null,"目标库:",-1)),B(r("select",{"onUpdate:modelValue":e[4]||(e[4]=o=>t.editorTargetLibrary=o),class:"form-control target-select"},[(v(!0),h(Q,null,ge(t.libraries,o=>(v(),h("option",{key:o.name,value:o.name},_(o.name),9,tv))),128))],512),[[Ne,t.editorTargetLibrary]]),r("button",{onClick:e[5]||(e[5]=(...o)=>t.loadCurrentLibrary&&t.loadCurrentLibrary(...o)),class:"btn secondary-btn small-btn",title:"加载当前库内容到编辑器"},e[16]||(e[16]=[r("span",null,"加载库内容",-1)]))])]),r("div",sv,[t.editorMode==="json"?(v(),h("div",ov,[B(r("textarea",{"onUpdate:modelValue":e[6]||(e[6]=o=>t.jsonContent=o),class:"editor-textarea",placeholder:"输入JSON格式的标签库内容...",onInput:e[7]||(e[7]=(...o)=>t.validateJson&&t.validateJson(...o))},null,544),[[Ee,t.jsonContent]])])):(v(),h("div",nv,[B(r("textarea",{"onUpdate:modelValue":e[8]||(e[8]=o=>t.textContent=o),class:"editor-textarea",placeholder:`按照以下格式输入标签:\r
分类1:\r
标签1\r
标签2|子标题1,子标题2\r
分类2:\r
标签3\r
标签4|子标题3`,onInput:e[9]||(e[9]=(...o)=>t.validateText&&t.validateText(...o))},null,544),[[Ee,t.textContent]])]))]),r("div",rv,[r("div",iv,[t.editorError?(v(),h("div",lv,_(t.editorError),1)):t.isValid?(v(),h("div",av,"格式正确")):x("",!0)]),r("div",cv,[r("button",{onClick:e[10]||(e[10]=(...o)=>t.convertFormat&&t.convertFormat(...o)),class:"btn secondary-btn",disabled:!t.isValid}," 转换为"+_(t.editorMode==="json"?"文本":"JSON")+"格式 ",9,uv)])])]),r("div",dv,[r("div",fv,[e[19]||(e[19]=r("div",{class:"header-title"},[r("h3",null,"预览"),r("div",{class:"header-subtitle"},"编辑内容后在此处预览")],-1)),r("div",gv,[B(r("select",{"onUpdate:modelValue":e[11]||(e[11]=o=>t.selectedCategory=o),class:"form-control",disabled:!t.isValid||!t.hasCategories},[e[18]||(e[18]=r("option",{value:""},"全部分类",-1)),(v(!0),h(Q,null,ge(t.categories,o=>(v(),h("option",{key:o,value:o},_(o),9,vv))),128))],8,pv),[[Ne,t.selectedCategory]])])]),t.isValid?(v(),h("div",yv,[t.selectedCategory?(v(),h("div",hv,[r("h4",null,[Ge(_(t.selectedCategory)+" ",1),r("span",mv,"("+_(t.filteredCategoryTags.length)+" 个标签)",1)]),t.filteredCategoryTags.length>0?(v(),h("ul",bv,[(v(!0),h(Q,null,ge(t.filteredCategoryTags,(o,a)=>(v(),h("li",{key:a,class:"tag-item"},[typeof o=="string"?(v(),h(Q,{key:0},[Ge(_(o),1)],64)):(v(),h(Q,{key:1},[r("div",$v,_(o.content),1),o.subTitles&&o.subTitles.length>0?(v(),h("div",wv,_(o.subTitles.join(", ")),1)):x("",!0)],64))]))),128))])):(v(),h("div",Cv,"该分类下没有标签"))])):(v(),h("div",Tv,[(v(!0),h(Q,null,ge(t.categories,o=>(v(),h("div",{key:o,class:"category-section"},[r("h4",null,[Ge(_(o)+" ",1),r("span",_v,"("+_(t.getCategoryTags(o).length)+" 个标签)",1)]),r("ul",Lv,[(v(!0),h(Q,null,ge(t.getCategoryTags(o).slice(0,5),(a,c)=>(v(),h("li",{key:c,class:"tag-item"},[typeof a=="string"?(v(),h(Q,{key:0},[Ge(_(a),1)],64)):(v(),h(Q,{key:1},[r("div",Sv,_(a.content),1),a.subTitles&&a.subTitles.length>0?(v(),h("div",kv,_(a.subTitles.join(", ")),1)):x("",!0)],64))]))),128))]),t.getCategoryTags(o).length>5?(v(),h("div",Ev," 还有 "+_(t.getCategoryTags(o).length-5)+" 个标签... ",1)):x("",!0)]))),128))]))])):(v(),h("div",Av,[r("p",null,_(t.editorError?"请先修正格式错误":"请输入有效内容以查看预览"),1)]))])])}const Mv=_e(Wp,[["render",Iv],["__scopeId","data-v-700cb0d3"]]);const Ov={name:"CategoryPanel",props:{categories:{type:Array,required:!0},selectedCategory:{type:String,default:""},getCategoryTagCount:{type:Function,required:!0}}},Dv={class:"category-panel"},Pv={class:"panel-header"},Hv={class:"category-list"},Rv=["onClick"],Nv={class:"category-name"},jv={class:"tag-count"},Fv={class:"category-actions"},Uv=["onClick"],Bv=["onClick"],Vv={key:0,class:"empty-message"};function Jv(t,e,s,n,i,l){return v(),h("div",Dv,[r("div",Pv,[e[2]||(e[2]=r("h4",null,"分类管理",-1)),r("button",{class:"btn-icon add-btn",onClick:e[0]||(e[0]=o=>t.$emit("add-category")),title:"添加分类"},e[1]||(e[1]=[r("i",{class:"fas fa-plus-circle"},null,-1)]))]),r("div",Hv,[(v(!0),h(Q,null,ge(s.categories,o=>(v(),h("div",{key:o,class:ae(["category-item",{active:s.selectedCategory===o}]),onClick:a=>t.$emit("select-category",o)},[r("span",Nv,_(o),1),r("span",jv,_(s.getCategoryTagCount(o)),1),r("div",Fv,[r("button",{class:"btn-icon edit-btn",onClick:Mt(a=>t.$emit("edit-category",o),["stop"]),title:"重命名"},e[3]||(e[3]=[r("i",{class:"fas fa-pencil-alt"},null,-1)]),8,Uv),r("button",{class:"btn-icon delete-btn",onClick:Mt(a=>t.$emit("delete-category",o),["stop"]),title:"删除"},e[4]||(e[4]=[r("i",{class:"fas fa-trash"},null,-1)]),8,Bv)])],10,Rv))),128)),s.categories.length===0?(v(),h("div",Vv," 没有分类，请添加一个新分类 ")):x("",!0)])])}const Kv=_e(Ov,[["render",Jv],["__scopeId","data-v-ea0b8f8b"]]);const zv={name:"TagPanel",props:{selectedCategory:{type:String,default:""},tags:{type:Array,default:()=>[]}},emits:["add-tag","edit-tag","delete-tag"],setup(t){const e=$("");let s=null;const n=Se(()=>{if(!e.value)return t.tags;const l=e.value.toLowerCase();return t.tags.filter(o=>{var u;const a=o.content.toLowerCase(),c=((u=o.subTitles)==null?void 0:u.join(" ").toLowerCase())||"";return a.includes(l)||c.includes(l)})});return{searchQuery:e,filteredTags:n,debouncedSearch:()=>{s&&clearTimeout(s),s=setTimeout(()=>{},300)}}}},Wv={class:"tags-panel"},Gv={key:0,class:"panel-header"},Yv={key:1,class:"tag-list"},qv={class:"search-box"},Qv={class:"tags-container"},Zv={class:"tag-content"},Xv={class:"tag-main-content"},xv={key:0,class:"tag-subtitle"},ey={class:"tag-actions"},ty=["onClick"],sy=["onClick"],oy={key:0,class:"empty-message"},ny={key:1,class:"empty-message"},ry={key:2,class:"empty-message"};function iy(t,e,s,n,i,l){return v(),h("div",Wv,[s.selectedCategory?(v(),h("div",Gv,[r("h4",null,_(s.selectedCategory)+" 中的标签",1),r("button",{class:"btn-icon add-btn",onClick:e[0]||(e[0]=o=>t.$emit("add-tag")),title:"添加标签"},e[3]||(e[3]=[r("i",{class:"fas fa-plus-circle"},null,-1)]))])):x("",!0),s.selectedCategory?(v(),h("div",Yv,[r("div",qv,[B(r("input",{type:"text","onUpdate:modelValue":e[1]||(e[1]=o=>n.searchQuery=o),class:"form-control",placeholder:"搜索标签...",onInput:e[2]||(e[2]=(...o)=>n.debouncedSearch&&n.debouncedSearch(...o))},null,544),[[Ee,n.searchQuery]]),e[4]||(e[4]=r("i",{class:"fas fa-search search-icon"},null,-1))]),r("div",Qv,[(v(!0),h(Q,null,ge(n.filteredTags,(o,a)=>(v(),h("div",{key:o.content+a,class:"tag-item"},[r("div",Zv,[r("div",Xv,_(o.content),1),o.subTitles&&o.subTitles.length>0?(v(),h("div",xv,_(o.subTitles.join(" / ")),1)):x("",!0)]),r("div",ey,[r("button",{class:"btn-icon edit-btn",onClick:c=>t.$emit("edit-tag",o,a),title:"编辑标签"},e[5]||(e[5]=[r("i",{class:"fas fa-pencil-alt"},null,-1)]),8,ty),r("button",{class:"btn-icon delete-btn",onClick:c=>t.$emit("delete-tag",o,a),title:"删除标签"},e[6]||(e[6]=[r("i",{class:"fas fa-trash"},null,-1)]),8,sy)])]))),128))]),s.tags.length===0?(v(),h("div",oy," 当前分类没有标签 ")):n.filteredTags.length===0?(v(),h("div",ny," 没有找到匹配的标签 ")):x("",!0)])):(v(),h("div",ry," 请从左侧选择一个分类 "))])}const ly=_e(zv,[["render",iy],["__scopeId","data-v-986c7eec"]]);const ay={name:"TagEditModal",props:{tag:{type:Object,required:!0},isEditing:{type:Boolean,default:!1},selectedCategory:{type:String,required:!0}},setup(t,{emit:e}){const s=$({content:"",subTitles:""});return Qe(()=>t.tag,i=>{s.value={content:i.content||"",subTitles:i.subTitles||""}},{immediate:!0}),{form:s,save:()=>{if(console.log("TagEditModal - 保存按钮点击，表单数据:",s.value),!s.value.content.trim()){console.error("TagEditModal - 标签内容为空，不执行保存");return}const i={content:s.value.content.trim(),subTitles:s.value.subTitles.trim()};console.log("TagEditModal - 发送保存事件，数据:",i),e("save",i)}}}},cy={class:"modal"},uy={class:"modal-content"},dy={class:"modal-header"},fy={class:"modal-body"},gy={class:"form-group"},py={class:"form-group"},vy={class:"modal-footer"};function yy(t,e,s,n,i,l){return v(),h("div",cy,[r("div",uy,[r("div",dy,[r("h4",null,_(s.isEditing?"编辑标签":"添加标签"),1),r("button",{class:"close-btn",onClick:e[0]||(e[0]=o=>t.$emit("close")),title:"关闭"},e[7]||(e[7]=[r("i",{class:"fas fa-times"},null,-1)]))]),r("div",fy,[r("div",gy,[e[8]||(e[8]=r("label",null,"标签内容:",-1)),B(r("input",{type:"text","onUpdate:modelValue":e[1]||(e[1]=o=>n.form.content=o),class:"form-control",placeholder:"输入标签内容",onKeyup:e[2]||(e[2]=Eo((...o)=>n.save&&n.save(...o),["enter"]))},null,544),[[Ee,n.form.content]])]),r("div",py,[e[9]||(e[9]=r("label",null,"子标题 (可选，用逗号分隔):",-1)),B(r("input",{type:"text","onUpdate:modelValue":e[3]||(e[3]=o=>n.form.subTitles=o),class:"form-control",placeholder:"子标题1,子标题2",onKeyup:e[4]||(e[4]=Eo((...o)=>n.save&&n.save(...o),["enter"]))},null,544),[[Ee,n.form.subTitles]])])]),r("div",vy,[r("button",{class:"btn btn-secondary",onClick:e[5]||(e[5]=o=>t.$emit("close"))},"取消"),r("button",{class:"btn btn-primary",onClick:e[6]||(e[6]=(...o)=>n.save&&n.save(...o))},"保存")])])])}const hy=_e(ay,[["render",yy],["__scopeId","data-v-f43b0ddb"]]);const my={name:"CategoryEditModal",props:{category:{type:Object,required:!0},isEditing:{type:Boolean,default:!1}},setup(t,{emit:e}){const s=$({name:"",originalName:""});return Qe(()=>t.category,i=>{s.value={name:i.name||"",originalName:i.originalName||""}},{immediate:!0}),{form:s,save:()=>{if(console.log("CategoryEditModal - 保存按钮点击，表单数据:",s.value),!s.value.name.trim()){console.error("CategoryEditModal - 分类名称为空，不执行保存");return}const i={name:s.value.name.trim(),originalName:s.value.originalName};console.log("CategoryEditModal - 发送保存事件，数据:",i),e("save",i)}}}},by={class:"modal"},$y={class:"modal-content"},wy={class:"modal-header"},Cy={class:"modal-body"},Ty={class:"form-group"},_y={class:"modal-footer"};function Ly(t,e,s,n,i,l){return v(),h("div",by,[r("div",$y,[r("div",wy,[r("h4",null,_(s.isEditing?"重命名分类":"添加分类"),1),r("button",{class:"close-btn",onClick:e[0]||(e[0]=o=>t.$emit("close")),title:"关闭"},e[5]||(e[5]=[r("i",{class:"fas fa-times"},null,-1)]))]),r("div",Cy,[r("div",Ty,[e[6]||(e[6]=r("label",null,"分类名称:",-1)),B(r("input",{type:"text","onUpdate:modelValue":e[1]||(e[1]=o=>n.form.name=o),class:"form-control",placeholder:"输入分类名称",onKeyup:e[2]||(e[2]=Eo((...o)=>n.save&&n.save(...o),["enter"]))},null,544),[[Ee,n.form.name]])])]),r("div",_y,[r("button",{class:"btn btn-secondary",onClick:e[3]||(e[3]=o=>t.$emit("close"))},"取消"),r("button",{class:"btn btn-primary",onClick:e[4]||(e[4]=(...o)=>n.save&&n.save(...o))},"保存")])])])}const Sy=_e(my,[["render",Ly],["__scopeId","data-v-a8cc6eac"]]);const ky={name:"ConfirmModal",props:{message:{type:String,required:!0}}},Ey={class:"modal"},Ay={class:"modal-content"},Iy={class:"modal-header"},My={class:"modal-body"},Oy={class:"confirm-message"},Dy={class:"modal-footer"};function Py(t,e,s,n,i,l){return v(),h("div",Ey,[r("div",Ay,[r("div",Iy,[e[4]||(e[4]=r("h4",null,"确认删除",-1)),r("button",{class:"close-btn",onClick:e[0]||(e[0]=o=>t.$emit("cancel")),title:"关闭"},e[3]||(e[3]=[r("i",{class:"fas fa-times"},null,-1)]))]),r("div",My,[r("p",Oy,_(s.message),1)]),r("div",Dy,[r("button",{class:"btn btn-secondary",onClick:e[1]||(e[1]=o=>t.$emit("cancel"))},"取消"),r("button",{class:"btn btn-danger",onClick:e[2]||(e[2]=o=>t.$emit("confirm"))},"删除")])])])}const Hy=_e(ky,[["render",Py],["__scopeId","data-v-52d7d4ba"]]);const Ry={name:"AdvancedEditor",components:{CategoryPanel:Kv,TagPanel:ly,TagEditModal:hy,CategoryEditModal:Sy,ConfirmModal:Hy},props:{show:{type:Boolean,required:!0}},emits:["close"],setup(t,{emit:e}){const s=ye("tagLibrary"),n=ye("emitter"),i=$(!1),l=$(""),o=$(""),a=$(!1),c=$(!1),u=$(!1),d=$(!1),g=$(!1),p=$(-1),m=$({content:"",subTitles:""}),T=$({name:"",originalName:""}),k=$(""),Z=$(""),V=$(null),F=$(0),H=$(!0),b=Se(()=>s.getLibraryNames?s.getLibraryNames():[]),D=Se(()=>{if(!l.value)return{};try{return s.getLibrary(l.value)||{}}catch(A){return console.error("获取库数据失败:",A),{}}}),te=Se(()=>{try{return D.value?Object.keys(D.value).sort():[]}catch(A){return console.error("获取分类列表失败:",A),[]}}),q=Se(()=>{try{if(!o.value||!D.value)return[];const A=D.value[o.value];return Array.isArray(A)?A.map(P=>typeof P=="string"?{content:P,subTitles:[]}:{content:P.content||"",subTitles:Array.isArray(P.subTitles)?P.subTitles:[]}):[]}catch(A){return console.error("获取当前分类标签失败:",A),[]}}),Te=A=>!D.value||!D.value[A]?0:Array.isArray(D.value[A])?D.value[A].length:0,se=async(A=!1)=>{if(l.value)try{if(i.value=!0,!s.getLibrary(l.value))throw new Error("无法加载库数据");o.value="",F.value++,A||n.emit("notification",{type:"success",message:"加载库成功"})}catch(P){console.error("加载库失败:",P),A||n.emit("notification",{type:"error",message:`加载库失败: ${P.message}`})}finally{i.value=!1}},W=()=>{if(!i.value)try{i.value=!0,s._loadFromStorage();const A=l.value;l.value="",Tt(()=>{l.value=A,n.emit("notification",{type:"success",message:"数据刷新成功"}),i.value=!1})}catch(A){console.error("刷新失败:",A),n.emit("notification",{type:"error",message:"刷新失败: "+(A.message||"未知错误")}),i.value=!1}},re=A=>{o.value=A},C=(A,P)=>{d.value=!0,p.value=P,m.value={content:A.content||"",subTitles:Array.isArray(A.subTitles)?A.subTitles.join(","):""},a.value=!0,console.log("开始编辑标签:",m.value)},G=async A=>{if(console.log("接收到保存标签请求，表单数据:",A),A&&typeof A=="object"&&(m.value={...A}),!m.value.content||!m.value.content.trim()){n.emit("notification",{type:"error",message:"标签内容不能为空"});return}if(!o.value||!l.value){n.emit("notification",{type:"error",message:"请先选择分类"});return}try{i.value=!0,console.log("处理标签表单数据:",m.value);const P={content:m.value.content.trim(),subTitles:m.value.subTitles.trim()?m.value.subTitles.split(",").map(R=>R.trim()).filter(R=>R):[]};console.log("准备保存标签:",P),console.log("TagLibrary emitter 状态:",s.hasEmitter());let de=!1;if(d.value&&p.value>=0){const R=q.value[p.value];console.log("编辑标签:",R,"->",P);const Y=s.removeTag(o.value,R.content,l.value);if(console.log("删除旧标签结果:",Y),Y)de=s.addTag(o.value,P,l.value),console.log("添加新标签结果:",de);else throw new Error("删除旧标签失败")}else console.log("添加新标签:",P),de=s.addTag(o.value,P,l.value),console.log("添加标签结果:",de);if(!de)throw new Error("保存操作未成功完成");n.emit("notification",{type:"success",message:d.value?"标签更新成功":"标签添加成功"}),a.value=!1}catch(P){console.error("保存标签失败:",P),n.emit("notification",{type:"error",message:`保存标签失败: ${P.message}`})}finally{i.value=!1}},ue=A=>{g.value=!0,T.value={name:A,originalName:A},c.value=!0,console.log("开始编辑分类:",T.value)},pe=async A=>{if(console.log("接收到保存分类请求，表单数据:",A),A&&typeof A=="object"&&(T.value={...A}),!T.value.name||!T.value.name.trim()){n.emit("notification",{type:"error",message:"分类名称不能为空"});return}if(!l.value){n.emit("notification",{type:"error",message:"请先选择库"});return}try{if(i.value=!0,console.log("处理分类表单数据:",T.value),g.value){console.log("准备重命名分类:",T.value.originalName,"->",T.value.name.trim());const P=s.renameCategory(l.value,T.value.originalName,T.value.name.trim());if(console.log("重命名分类结果:",P),P)n.emit("notification",{type:"success",message:"分类重命名成功"});else throw new Error("重命名分类失败")}else{console.log("准备添加新分类:",T.value.name.trim());const P=s.addCategory(l.value,T.value.name.trim());if(console.log("添加分类结果:",P),P)n.emit("notification",{type:"success",message:"分类添加成功"});else throw new Error("添加分类失败")}c.value=!1}catch(P){console.error("保存分类失败:",P),n.emit("notification",{type:"error",message:`保存分类失败: ${P.message}`})}finally{i.value=!1}},U=A=>{Z.value="category",V.value=A,k.value=`确定要删除分类 "${A}" 吗？此操作将删除该分类下的所有标签，且不可恢复。`,u.value=!0},J=(A,P)=>{Z.value="tag",V.value=P,k.value=`确定要删除标签 "${A.content}" 吗？此操作不可恢复。`,u.value=!0},ie=async()=>{try{if(i.value=!0,Z.value==="category"){console.log("准备删除分类:",V.value);const A=await s.deleteCategory(l.value,V.value);if(console.log("删除分类结果:",A),A)n.emit("notification",{type:"success",message:`分类 "${V.value}" 已删除`}),o.value===V.value&&(o.value="");else throw new Error("删除分类操作未成功完成")}else if(Z.value==="tag"){const A=q.value[V.value];if(A){console.log("准备删除标签:",A);const P=s.removeTag(o.value,A.content,l.value);if(console.log("删除标签结果:",P),P)n.emit("notification",{type:"success",message:"标签已删除"});else throw new Error("删除标签操作未成功完成")}else throw new Error("找不到要删除的标签")}u.value=!1,Z.value="",V.value=null,k.value=""}catch(A){console.error("删除失败:",A),n.emit("notification",{type:"error",message:`删除失败: ${A.message}`})}finally{i.value=!1}},ve=()=>{e("close"),l.value="",o.value="",a.value=!1,c.value=!1,u.value=!1,d.value=!1,g.value=!1,p.value=-1,m.value={content:"",subTitles:""},T.value={name:"",originalName:""},k.value="",Z.value="",V.value=null};Qe(()=>t.show,A=>{if(A){const P=s.getCurrentLibraryName();P&&(H.value||P!==l.value)&&(l.value=P,se(!0),H.value=!1)}}),Qe(()=>l.value,(A,P)=>{A&&A!==P&&!H.value&&se(!1)});let je,De=null,M=0;return Ke(()=>{je=n.on("tagLibraryUpdated",A=>{console.log("AdvancedEditor: 接收到 tagLibraryUpdated 事件",A);const de=Date.now()-M;if(de<1e3){console.log(`AdvancedEditor: 最近${de}ms内已刷新过，忽略本次事件`);return}De&&clearTimeout(De),De=setTimeout(()=>{console.log("AdvancedEditor: 执行防抖后的刷新"),i.value||(F.value++,M=Date.now()),De=null},300)})}),ks(()=>{je&&je()}),{isLoading:i,currentLibraryName:l,selectedCategory:o,showTagModal:a,showCategoryModal:c,showDeleteConfirmModal:u,isEditingTag:d,isEditingCategory:g,editingTagIndex:p,tagForm:m,categoryForm:T,deleteConfirmMessage:k,deleteType:Z,deleteTarget:V,refreshTrigger:F,libraryNames:b,libraryData:D,categoriesList:te,currentCategoryTags:q,getCategoryTagCount:Te,loadSelectedLibrary:se,selectCategory:re,startEditTag:C,saveTag:G,startEditCategory:ue,saveCategory:pe,confirmDeleteCategory:U,confirmDeleteTag:J,confirmDelete:ie,closeEditor:ve,triggerRefresh:W,startAddCategory:()=>{console.log("开始添加新分类"),g.value=!1,T.value={name:"",originalName:""},c.value=!0},startAddTag:()=>{console.log("开始添加新标签"),d.value=!1,m.value={content:"",subTitles:""},a.value=!0}}}},Ny={key:0,class:"advanced-editor"},jy={class:"modal-header"},Fy={class:"header-actions"},Uy=["disabled"],By={class:"modal-body"},Vy={class:"library-selector"},Jy=["disabled"],Ky=["value"],zy={key:0,class:"loading-indicator"},Wy={class:"editor-layout"};function Gy(t,e,s,n,i,l){const o=ke("CategoryPanel"),a=ke("TagPanel"),c=ke("TagEditModal"),u=ke("CategoryEditModal"),d=ke("ConfirmModal");return s.show?(v(),h("div",Ny,[r("div",{class:"modal-overlay",onClick:e[0]||(e[0]=(...g)=>n.closeEditor&&n.closeEditor(...g))}),r("div",{class:"modal-container",onClick:e[4]||(e[4]=Mt(()=>{},["stop"]))},[r("div",jy,[e[9]||(e[9]=r("h3",null,"高级编辑器",-1)),r("div",Fy,[r("button",{class:"refresh-btn",onClick:e[1]||(e[1]=(...g)=>n.triggerRefresh&&n.triggerRefresh(...g)),disabled:n.isLoading,title:"刷新数据"},[r("i",{class:ae(["fas fa-sync-alt",{refreshing:n.isLoading}])},null,2)],8,Uy),r("button",{class:"close-btn",onClick:e[2]||(e[2]=(...g)=>n.closeEditor&&n.closeEditor(...g)),title:"关闭"},e[8]||(e[8]=[r("i",{class:"fas fa-times"},null,-1)]))])]),r("div",By,[r("div",Vy,[e[11]||(e[11]=r("label",null,"选择标签库：",-1)),B(r("select",{"onUpdate:modelValue":e[3]||(e[3]=g=>n.currentLibraryName=g),class:"form-control",disabled:n.isLoading},[(v(!0),h(Q,null,ge(n.libraryNames,g=>(v(),h("option",{key:g,value:g},_(g),9,Ky))),128))],8,Jy),[[Ne,n.currentLibraryName]]),n.isLoading?(v(),h("div",zy,e[10]||(e[10]=[r("div",{class:"spinner"},null,-1)]))):x("",!0)]),r("div",Wy,[be(o,{categories:n.categoriesList,"selected-category":n.selectedCategory,"get-category-tag-count":n.getCategoryTagCount,onSelectCategory:n.selectCategory,onAddCategory:n.startAddCategory,onEditCategory:n.startEditCategory,onDeleteCategory:n.confirmDeleteCategory},null,8,["categories","selected-category","get-category-tag-count","onSelectCategory","onAddCategory","onEditCategory","onDeleteCategory"]),be(a,{"selected-category":n.selectedCategory,tags:n.currentCategoryTags,onAddTag:n.startAddTag,onEditTag:n.startEditTag,onDeleteTag:n.confirmDeleteTag},null,8,["selected-category","tags","onAddTag","onEditTag","onDeleteTag"])])])]),n.showTagModal?(v(),It(c,{key:0,tag:n.tagForm,"is-editing":n.isEditingTag,"selected-category":n.selectedCategory,onSave:n.saveTag,onClose:e[5]||(e[5]=g=>n.showTagModal=!1)},null,8,["tag","is-editing","selected-category","onSave"])):x("",!0),n.showCategoryModal?(v(),It(u,{key:1,category:n.categoryForm,"is-editing":n.isEditingCategory,onSave:n.saveCategory,onClose:e[6]||(e[6]=g=>n.showCategoryModal=!1)},null,8,["category","is-editing","onSave"])):x("",!0),n.showDeleteConfirmModal?(v(),It(d,{key:2,message:n.deleteConfirmMessage,onConfirm:n.confirmDelete,onCancel:e[7]||(e[7]=g=>n.showDeleteConfirmModal=!1)},null,8,["message","onConfirm"])):x("",!0)])):x("",!0)}const Yy=_e(Ry,[["render",Gy],["__scopeId","data-v-dcc6add1"]]);const qy=He({name:"TagLibraryPanel",components:{ImportPanel:kg,ManagePanel:sp,PreviewPanel:zp,EditorPanel:Mv,AdvancedEditor:Yy},setup(){const t=ye("tagLibrary"),e=ye("emitter"),s=$([]),n=$(""),i=$("manage"),l=$(!1),o=()=>{try{const u=t.getLibraryNames?t.getLibraryNames():[];s.value=u.map(d=>{const g=t.getTagCountByLibrary?t.getTagCountByLibrary(d):t.getAllTags?t.getAllTags(d).length:0;return{name:d,count:g}}),(!n.value||!s.value.some(d=>d.name===n.value))&&(s.value.length>0?n.value=s.value[0].name:n.value="")}catch(u){console.error("加载标签库列表失败:",u),e.emit("notification",{type:"error",message:`加载标签库列表失败: ${u.message}`})}},a=u=>{u&&u!==n.value&&(n.value=u,e.emit("libraryChanged",u))},c=()=>{l.value=!0};return Ke(()=>{o(),e.on("tagLibraryUpdated",()=>{o()})}),Qe(i,u=>{console.log(`切换到 ${u} 标签页`)}),{libraries:s,currentLibrary:n,activeTab:i,loadLibraries:o,switchLibrary:a,showAdvancedEditor:l,openAdvancedEditor:c}}}),Qy={class:"tag-library-panel"},Zy={class:"tab-container"},Xy={class:"tab-buttons"},xy={class:"section"},eh={class:"section-content"};function th(t,e,s,n,i,l){const o=ke("ImportPanel"),a=ke("ManagePanel"),c=ke("PreviewPanel"),u=ke("EditorPanel"),d=ke("AdvancedEditor");return v(),h(Q,null,[r("div",Qy,[e[8]||(e[8]=r("div",{class:"panel-header"},[r("h2",{class:"panel-title"},"Tag库管理")],-1)),r("div",Zy,[r("div",Xy,[r("button",{class:ae(["tab-btn",{active:t.activeTab==="import"}]),onClick:e[0]||(e[0]=g=>t.activeTab="import")},"导入",2),r("button",{class:ae(["tab-btn",{active:t.activeTab==="manage"}]),onClick:e[1]||(e[1]=g=>t.activeTab="manage")},"管理",2),r("button",{class:ae(["tab-btn",{active:t.activeTab==="preview"}]),onClick:e[2]||(e[2]=g=>t.activeTab="preview")},"预览",2),r("button",{class:ae(["tab-btn",{active:t.activeTab==="editor"}]),onClick:e[3]||(e[3]=g=>t.activeTab="editor")},"在线编辑",2)]),r("div",{class:ae(["tab-content",{active:t.activeTab==="import"}])},[be(o,{libraries:t.libraries,onLibraryUpdated:t.loadLibraries},null,8,["libraries","onLibraryUpdated"])],2),r("div",{class:ae(["tab-content",{active:t.activeTab==="manage"}])},[be(a,{libraries:t.libraries,"current-library":t.currentLibrary,onLibraryUpdated:t.loadLibraries,onSwitchLibrary:t.switchLibrary},null,8,["libraries","current-library","onLibraryUpdated","onSwitchLibrary"]),r("div",xy,[e[7]||(e[7]=r("div",{class:"section-header"},[r("h3",{class:"section-title"},"高级编辑器")],-1)),r("div",eh,[e[6]||(e[6]=r("p",{class:"description"},"使用高级编辑器可以直接编辑标签库的JSON结构或文本形式",-1)),r("button",{onClick:e[4]||(e[4]=(...g)=>t.openAdvancedEditor&&t.openAdvancedEditor(...g)),class:"primary-button"},"打开高级编辑器")])])],2),r("div",{class:ae(["tab-content",{active:t.activeTab==="preview"}])},[be(c,{"current-library":t.currentLibrary},null,8,["current-library"])],2),r("div",{class:ae(["tab-content",{active:t.activeTab==="editor"}])},[be(u,{libraries:t.libraries,"current-library":t.currentLibrary,onLibraryUpdated:t.loadLibraries},null,8,["libraries","current-library","onLibraryUpdated"])],2)])]),t.showAdvancedEditor?(v(),It(d,{key:0,show:t.showAdvancedEditor,onClose:e[5]||(e[5]=g=>t.showAdvancedEditor=!1)},null,8,["show"])):x("",!0)],64)}const sh=_e(qy,[["render",th],["__scopeId","data-v-ab0ea37b"]]);const oh=He({name:"NotificationSystem",setup(){const t=ye("emitter"),e=$([]),s=$(!0);let n=1;const i=u=>{if(!s.value)return;const d=u.duration||2e3,g=e.value.findIndex(p=>p.message===u.message&&p.type===u.type);if(g!==-1){const p=e.value[g];clearTimeout(p.timerId),p.count+=1,p.duration=d,p.timerId=setTimeout(()=>{l(p.id)},d),e.value=[...e.value]}else{const p=n++,m={id:p,message:u.message,type:u.type||"info",duration:d,count:1,timerId:null};m.timerId=setTimeout(()=>{l(p)},d),e.value.push(m)}},l=u=>{const d=e.value.findIndex(g=>g.id===u);d!==-1&&(clearTimeout(e.value[d].timerId),e.value.splice(d,1))},o=()=>{const u=localStorage.getItem("theme_settings");if(u)try{const d=JSON.parse(u);s.value=d.showNotifications!==!1}catch(d){console.error("加载通知设置失败:",d)}},a=t.on("notificationsSettingChanged",u=>{s.value=u,u||(e.value.forEach(d=>clearTimeout(d.timerId)),e.value=[])}),c=t.on("notification",u=>{i(u)});return Ke(()=>{o()}),Yt(()=>{e.value.forEach(u=>clearTimeout(u.timerId)),c(),a()}),Qe(e,u=>{if(u.length>5){for(let d=0;d<u.length-5;d++)u[d]&&u[d].timerId&&clearTimeout(u[d].timerId);e.value=u.slice(u.length-5)}},{deep:!0}),{notifications:e,showNotifications:s,removeNotification:l}}}),nh={key:0,class:"notification-container"},rh={class:"notification-content"},ih={class:"notification-icon"},lh={key:0},ah={key:1},ch={key:2},uh={key:3},dh={class:"notification-message"},fh={key:0,class:"notification-count"},gh=["onClick"];function ph(t,e,s,n,i,l){return t.showNotifications?(v(),h("div",nh,[be(va,{name:"notification"},{default:fr(()=>[(v(!0),h(Q,null,ge(t.notifications,o=>(v(),h("div",{key:o.id,class:ae(["notification",o.type])},[r("div",rh,[r("div",ih,[o.type==="success"?(v(),h("span",lh,"✓")):o.type==="error"?(v(),h("span",ah,"✕")):o.type==="warning"?(v(),h("span",ch,"!")):(v(),h("span",uh,"ℹ"))]),r("div",dh,[Ge(_(o.message)+" ",1),o.count>1?(v(),h("span",fh,"x"+_(o.count),1)):x("",!0)]),r("button",{onClick:a=>t.removeNotification(o.id),class:"close-btn"},"×",8,gh)]),r("div",{class:"notification-progress",style:Ot({animationDuration:`${o.duration}ms`})},null,4)],2))),128))]),_:1})])):x("",!0)}const vh=_e(oh,[["render",ph],["__scopeId","data-v-20368e03"]]);const yh=He({name:"LibrarySelector",props:{dropdownPosition:{type:String,default:"bottom",validator:t=>["top","bottom","auto"].includes(t)},showCount:{type:Boolean,default:!0}},emits:["library-changed"],setup(t,{emit:e}){const s=ye("tagLibrary"),n=ye("emitter"),i=$(!1),l=$(""),o=$(""),a=$([]),c=$(null),u=$(null),d=$({}),g=Se(()=>{const b=localStorage.getItem("recent_libraries");try{if(b)return JSON.parse(b).filter(D=>D!==o.value)}catch(D){console.error("解析最近使用的库时出错:",D)}return[]}),p=Se(()=>{if(!l.value)return a.value;const b=l.value.toLowerCase();return a.value.filter(D=>D.name.toLowerCase().includes(b))}),m=()=>{try{if(s&&s.getLibraryNames){const b=s.getLibraryNames();a.value=b.map(D=>{const te=s.getTagCountByLibrary?s.getTagCountByLibrary(D):s.getAllTags?s.getAllTags(D).length:0;return{name:D,count:te}}),!o.value&&a.value.length>0&&(o.value=s.getCurrentLibraryName())}}catch(b){console.error("加载库列表失败:",b)}},T=()=>{i.value=!i.value,i.value&&(m(),Z(),Tt(()=>{c.value&&a.value.length>5&&c.value.focus()}))},k=b=>{!b.target.closest(".library-selector-container")&&i.value&&(i.value=!1,l.value="")},Z=()=>{const b=t.dropdownPosition;b==="auto"?d.value={}:b==="top"?d.value={bottom:"100%",top:"auto"}:d.value={}},V=b=>{if(b===o.value){i.value=!1;return}o.value=b,F(b),s&&s.setCurrentLibrary&&s.setCurrentLibrary(b),e("library-changed",b),n.emit("library-changed",b),i.value=!1,l.value=""},F=b=>{try{let D=localStorage.getItem("recent_libraries"),te=D?JSON.parse(D):[];te=te.filter(q=>q!==b),te.unshift(b),te.length>5&&(te=te.slice(0,5)),localStorage.setItem("recent_libraries",JSON.stringify(te))}catch(D){console.error("更新最近使用库失败:",D)}},H=b=>{b!==o.value&&(o.value=b)};return Ke(()=>{document.addEventListener("click",k),s&&s.getCurrentLibraryName&&(o.value=s.getCurrentLibraryName()),n.on("library-changed",H),m()}),Yt(()=>{document.removeEventListener("click",k),n.off("library-changed",H)}),Qe(p,()=>{Tt(()=>{Z()})}),{isOpen:i,searchQuery:l,currentLibrary:o,libraries:a,filteredLibraries:p,recentLibraries:g,searchInput:c,libraryList:u,dropdownStyle:d,toggleDropdown:T,selectLibrary:V}}}),hh={class:"library-selector-container"},mh={class:"current-library"},bh={key:0,class:"search-box"},$h={class:"library-list",ref:"libraryList"},wh=["onClick"],Ch={class:"library-name"},Th={class:"library-count"},_h={key:0,class:"empty-message"},Lh={key:1,class:"recent-libraries"},Sh={class:"recent-items"},kh=["onClick"];function Eh(t,e,s,n,i,l){return v(),h("div",hh,[r("div",{class:"selector-header",onClick:e[0]||(e[0]=(...o)=>t.toggleDropdown&&t.toggleDropdown(...o))},[r("span",mh,_(t.currentLibrary),1),r("span",{class:ae(["dropdown-icon",{open:t.isOpen}])},"▼",2)]),t.isOpen?(v(),h("div",{key:0,class:"dropdown-menu",style:Ot(t.dropdownStyle)},[t.libraries.length>5?(v(),h("div",bh,[B(r("input",{type:"text","onUpdate:modelValue":e[1]||(e[1]=o=>t.searchQuery=o),placeholder:"搜索库...",onClick:e[2]||(e[2]=Mt(()=>{},["stop"])),ref:"searchInput"},null,512),[[Ee,t.searchQuery]]),e[3]||(e[3]=r("span",{class:"search-icon"},"🔍",-1))])):x("",!0),r("div",$h,[(v(!0),h(Q,null,ge(t.filteredLibraries,o=>(v(),h("div",{key:o.name,class:ae(["library-item",{active:o.name===t.currentLibrary}]),onClick:Mt(a=>t.selectLibrary(o.name),["stop"])},[r("span",Ch,_(o.name),1),r("span",Th,_(o.count)+"个标签",1)],10,wh))),128)),t.filteredLibraries.length===0?(v(),h("div",_h," 未找到匹配的库 ")):x("",!0)],512),t.recentLibraries.length&&!t.searchQuery?(v(),h("div",Lh,[e[4]||(e[4]=r("div",{class:"recent-header"},"最近使用",-1)),r("div",Sh,[(v(!0),h(Q,null,ge(t.recentLibraries,o=>(v(),h("div",{key:o,class:ae(["recent-item",{active:o===t.currentLibrary}]),onClick:Mt(a=>t.selectLibrary(o),["stop"])},_(o),11,kh))),128))])])):x("",!0)],4)):x("",!0)])}const qr=_e(yh,[["render",Eh],["__scopeId","data-v-ebb10760"]]);const Ah=He({name:"WeightAdder",components:{LibrarySelector:qr},setup(){const t=ye("tagLibrary"),e=ye("emitter"),s=$(1),n=$(3),i=$(.5),l=$(1.5),o=$(""),a=$(!1),c=$(""),u=$([]),d=$(!1),g=$(!0),p=$(""),m=$(!1),T=$(!1),k=$(1),Z=$(!1),V=$("brackets"),F=$(null),H=$(window.innerWidth<=768),b=$(""),D=$(""),te=$(!1),q=$(50),Te=$(["默认库","Stable Diffusion画师","Midjourney风格","NovelAI标签","常用特效标签"]),se=Se(()=>{const R=localStorage.getItem("recent_libraries");try{if(R)return JSON.parse(R).filter(Y=>Y!==D.value).slice(0,3)}catch(Y){console.error("解析最近使用的库时出错:",Y)}return[]}),W=Se(()=>{if(!c.value)return u.value;const R=c.value.toLowerCase();return u.value.filter(Y=>Y.toLowerCase().includes(R))}),re=async R=>{try{if(g.value=!0,R&&t){console.log(`从标签库加载: ${R}`);const Y=await t.getAllTags(R);console.log("加载到的标签:",Y),u.value=Y.map(X=>typeof X=="string"?X:typeof X=="object"&&X!==null&&X.content||"").filter(X=>X),console.log("处理后的画师列表:",u.value)}else{console.log("从本地JSON加载画师库");const Y=await fetch("/public/artists.json").then(X=>{if(!X.ok)throw new Error("无法加载画师库");return X.json()});if(Y&&Y.画师画风)u.value=Y.画师画风.map(X=>X.content),console.log("从本地JSON加载的画师列表:",u.value);else throw console.error("画师数据格式不正确"),new Error("画师数据格式不正确")}}catch(Y){console.error("加载画师数据失败:",Y),u.value=[],e.emit("notification",{type:"error",message:`加载画师数据失败: ${Y.message}`})}finally{g.value=!1}},C=()=>{s.value>1&&s.value--},G=()=>{s.value<n.value&&s.value<99&&s.value++},ue=()=>{n.value>s.value&&n.value>1&&n.value--},pe=()=>{n.value<99&&n.value++},U=async()=>{if(u.value.length===0){alert("画师库尚未加载完成，请稍后再试。");return}try{d.value=!0,await new Promise(y=>setTimeout(y,300));const R=Math.floor(Math.random()*(n.value-s.value+1))+Number(s.value),Y=[];let X=[];p.value.trim()&&(X=p.value.split(",").map(y=>y.trim().toLowerCase()));const Ae=X.length>0?u.value.filter(y=>!X.some(w=>y.toLowerCase().includes(w))):u.value;if(Ae.length===0)throw new Error("排除关键词后没有可用的画师，请调整排除条件");const Ze=new Set,f=20;for(let y=0;y<R;y++){let w,S,L=0;do if(S=Math.floor(Math.random()*Ae.length),w=Ae[S],L++,L>=f){console.warn("尝试获取不重复画师失败，可能是画师库太小或排除条件太严格");break}while(m.value&&Ze.has(S)&&L<f);if(Ze.add(S),!(Math.random()*100<=q.value)){Y.push(w);continue}let N;T.value?N=k.value.toFixed(1):N=(Math.random()*(l.value-i.value)+Number(i.value)).toFixed(1);let O;if(Z.value)switch(V.value){case"colon":O=`${w}:${N}`;break;case"space":O=`${w} ${N}`;break;case"only":O=w;break;case"brackets":default:O=`(${w}:${N})`;break}else O=`(${w}:${N})`;Y.push(O)}o.value=Y.join(", "),console.log("生成结果:",o.value),Tt(()=>{const y=document.querySelector(".result-panel");y&&y.scrollIntoView({behavior:"smooth",block:"nearest"})})}catch(R){console.error("生成画师权重时出错:",R),alert("生成失败: "+(R.message||"未知错误"))}finally{d.value=!1}},J=()=>{if(!o.value){alert("没有生成任何内容可供复制");return}navigator.clipboard.writeText(o.value).then(()=>alert("结果已复制到剪贴板")).catch(R=>{console.error("复制失败:",R),alert("复制失败，请手动复制。")})},ie=()=>{o.value=""},ve=()=>{if(u.value.length===0&&!g.value){alert("画师列表为空，请重新加载页面尝试。");return}a.value=!0},je=()=>{a.value=!1,c.value=""},De=R=>{let Y;T.value?Y=k.value.toFixed(1):Y=(Math.random()*(l.value-i.value)+Number(i.value)).toFixed(1);let X;if(Z.value)switch(V.value){case"colon":X=`${R}:${Y}`;break;case"space":X=`${R} ${Y}`;break;case"only":X=R;break;case"brackets":default:X=`(${R}:${Y})`;break}else X=`(${R}:${Y})`;o.value?o.value+=", "+X:o.value=X,je(),Tt(()=>{const Ae=document.querySelector(".result-panel");Ae&&Ae.scrollIntoView({behavior:"smooth",block:"nearest"})})},M=()=>{H.value=window.innerWidth<=768};Ke(()=>{if(t&&t.getCurrentLibraryName){const R=t.getCurrentLibraryName();D.value=R,re(R)}else re();window.addEventListener("resize",M),e.on("library-changed",P)}),Yt(()=>{window.removeEventListener("resize",M),e.off("library-changed",P)});const z=()=>{if(!b.value.trim()){alert("请先输入需要处理的Tag");return}d.value=!0;try{const R=fe(b.value);if(R.length===0){alert("未能识别到有效的Tag"),d.value=!1;return}const X=R.map(Ae=>{if(!(Math.random()*100<=q.value))return Ae;let f;T.value?f=k.value.toFixed(1):f=(Math.random()*(l.value-i.value)+Number(i.value)).toFixed(1);let y;if(Z.value)switch(V.value){case"colon":y=`${Ae}:${f}`;break;case"space":y=`${Ae} ${f}`;break;case"only":y=Ae;break;case"brackets":default:y=`(${Ae}:${f})`;break}else y=`(${Ae}:${f})`;return y}).join(", ");o.value?o.value+=", "+X:o.value=X,Tt(()=>{const Ae=document.querySelector(".result-panel");Ae&&Ae.scrollIntoView({behavior:"smooth",block:"nearest"})})}catch(R){console.error("处理Tag输入失败:",R),alert("处理失败: "+R.message)}finally{d.value=!1}},fe=R=>{if(!R.trim())return[];let Y=[];const X=/[\u4e00-\u9fa5]/.test(R),Ae=/[a-zA-Z]/.test(R);return X&&Ae?R.split(/[,，]/).forEach(f=>{if(!f.trim())return;const y=f.match(/[a-zA-Z][a-zA-Z\s\-_]*/g);y&&y.forEach(S=>{S.trim()&&Y.push(S.trim())});const w=f.match(/[\u4e00-\u9fa5]+/g);w&&w.forEach(S=>{S.trim()&&Y.push(S.trim())})}):X?Y=R.split(/[,，\s]/):Y=R.split(/[,\s]/),[...new Set(Y.filter(Ze=>Ze.trim()))]},A=()=>{b.value=""},P=R=>{!R||R===D.value||(D.value=R,te.value=!0,re(R).then(()=>{te.value=!1,e.emit("notification",{type:"success",message:`已切换到 ${R} 库`})}))};return{minCount:s,maxCount:n,minWeight:i,maxWeight:l,result:o,showModal:a,searchQuery:c,artists:u,filteredArtists:W,isGenerating:d,isLoadingArtists:g,generateArtists:U,copyToClipboard:J,clearResult:ie,showArtistLibrary:ve,closeModal:je,addArtistToResult:De,decreaseMinCount:C,increaseMinCount:G,decreaseMaxCount:ue,increaseMaxCount:pe,excludeKeywords:p,avoidDuplicates:m,fixedWeight:T,fixedWeightValue:k,useCustomFormat:Z,customFormat:V,artistListContainer:F,isMobile:H,tagInput:b,processTagInput:z,clearTagInput:A,selectedLibrary:D,recentLibraries:se,isLoadingLibrary:te,handleLibraryChange:P,selectLibrary:R=>{R&&R!==D.value&&P(R)},splitTagInput:fe,availableLibraries:Te,weightFrequency:q}}}),Ih={class:"weight-adder"},Mh={class:"weight-adder-content"},Oh={class:"form-content"},Dh={class:"section"},Ph={class:"tag-input-actions"},Hh={class:"section"},Rh={class:"library-bar"},Nh={class:"library-selector"},jh={key:0,class:"library-quick-select"},Fh={class:"recent-chips"},Uh=["onClick"],Bh={class:"section"},Vh={class:"number-control"},Jh=["disabled"],Kh={class:"number"},zh=["disabled"],Wh={class:"section"},Gh={class:"number-control"},Yh=["disabled"],qh={class:"number"},Qh=["disabled"],Zh={class:"section"},Xh={class:"slider-container"},xh={class:"slider-value"},em={class:"section"},tm={class:"slider-container"},sm={class:"slider-value"},om={class:"section"},nm={class:"advanced-content"},rm={class:"advanced-item"},im={class:"advanced-item checkbox"},lm={class:"advanced-item checkbox"},am={key:0,class:"advanced-item"},cm={class:"slider-container"},um={class:"slider-value"},dm={class:"advanced-item"},fm={class:"slider-container"},gm={class:"slider-value"},pm={class:"advanced-item checkbox"},vm={key:1,class:"advanced-item"},ym={class:"button-group"},hm=["disabled"],mm={key:0,class:"button-spinner"},bm={key:1,class:"button-icon"},$m=["disabled"],wm=["disabled"],Cm={key:0,class:"button-spinner"},Tm={key:1,class:"button-icon"},_m={class:"panel-header"},Lm={key:0,class:"panel-actions"},Sm={key:1,class:"empty-result"},km={class:"modal-header"},Em={class:"modal-actions"},Am={key:0,class:"artist-count"},Im={class:"library-bar"},Mm={class:"library-selector"},Om=["value"],Dm={key:0,class:"library-quick-select"},Pm={class:"recent-chips"},Hm=["onClick"],Rm={class:"search-container"},Nm={class:"modal-body",ref:"artistListContainer"},jm=["onClick"],Fm={key:1,class:"empty-artists"},Um={key:2,class:"empty-artists"},Bm={key:0},Vm={key:1};function Jm(t,e,s,n,i,l){const o=ke("library-selector");return v(),h("div",Ih,[r("div",Mh,[r("div",{class:ae(["control-panel",{mobile:t.isMobile}])},[e[41]||(e[41]=r("div",{class:"panel-header"},[r("h3",{class:"panel-title"},"权重设置")],-1)),r("div",Oh,[r("div",Dh,[e[26]||(e[26]=r("h3",null,"Tag输入与分割",-1)),B(r("textarea",{class:"tag-input","onUpdate:modelValue":e[0]||(e[0]=a=>t.tagInput=a),placeholder:"输入Tags，系统将自动分割中英文，并添加随机权重...",rows:"4"},null,512),[[Ee,t.tagInput]]),r("div",Ph,[r("button",{onClick:e[1]||(e[1]=(...a)=>t.processTagInput&&t.processTagInput(...a)),class:"secondary-button"},e[25]||(e[25]=[r("span",{class:"button-icon"},"✂️",-1),Ge(" 分割并添加权重 ")])),r("button",{onClick:e[2]||(e[2]=(...a)=>t.clearTagInput&&t.clearTagInput(...a)),class:"small-button"}," 清空 ")])]),r("div",Hh,[e[28]||(e[28]=r("h3",null,"选择库",-1)),r("div",Rh,[r("div",Nh,[e[27]||(e[27]=r("label",null,"选择库:",-1)),be(o,{onLibraryChanged:t.handleLibraryChange},null,8,["onLibraryChanged"])]),t.recentLibraries.length?(v(),h("div",jh,[r("div",Fh,[(v(!0),h(Q,null,ge(t.recentLibraries,a=>(v(),h("button",{key:a,onClick:c=>t.selectLibrary(a),class:ae(["library-chip",{active:t.selectedLibrary===a}])},_(a),11,Uh))),128))])])):x("",!0)])]),r("div",Bh,[e[29]||(e[29]=r("h3",null,"最小Tag数量",-1)),r("div",Vh,[r("button",{class:"control-btn",onClick:e[3]||(e[3]=(...a)=>t.decreaseMinCount&&t.decreaseMinCount(...a)),disabled:t.minCount<=1},"-",8,Jh),r("span",Kh,_(t.minCount),1),r("button",{class:"control-btn",onClick:e[4]||(e[4]=(...a)=>t.increaseMinCount&&t.increaseMinCount(...a)),disabled:t.minCount>=t.maxCount||t.minCount>=99},"+",8,zh)])]),r("div",Wh,[e[30]||(e[30]=r("h3",null,"最大Tag数量",-1)),r("div",Gh,[r("button",{class:"control-btn",onClick:e[5]||(e[5]=(...a)=>t.decreaseMaxCount&&t.decreaseMaxCount(...a)),disabled:t.maxCount<=t.minCount||t.maxCount<=1},"-",8,Yh),r("span",qh,_(t.maxCount),1),r("button",{class:"control-btn",onClick:e[6]||(e[6]=(...a)=>t.increaseMaxCount&&t.increaseMaxCount(...a)),disabled:t.maxCount>=99},"+",8,Qh)])]),r("div",Zh,[r("h3",null,"最小权重范围（"+_(t.minWeight)+"）",1),r("div",Xh,[B(r("input",{type:"range",min:"0.1",max:"1",step:"0.1","onUpdate:modelValue":e[7]||(e[7]=a=>t.minWeight=a),class:"slider"},null,512),[[Ee,t.minWeight]]),r("span",xh,_(t.minWeight),1)])]),r("div",em,[r("h3",null,"最大权重范围（"+_(t.maxWeight)+"）",1),r("div",tm,[B(r("input",{type:"range",min:"1",max:"2",step:"0.1","onUpdate:modelValue":e[8]||(e[8]=a=>t.maxWeight=a),class:"slider"},null,512),[[Ee,t.maxWeight]]),r("span",sm,_(t.maxWeight),1)])]),r("div",om,[e[39]||(e[39]=r("h3",null,"高级设置",-1)),r("div",nm,[r("div",rm,[e[31]||(e[31]=r("label",null,"排除关键词",-1)),B(r("input",{type:"text","onUpdate:modelValue":e[9]||(e[9]=a=>t.excludeKeywords=a),placeholder:"输入画师关键词，用逗号分隔",class:"form-input"},null,512),[[Ee,t.excludeKeywords]])]),r("div",im,[B(r("input",{type:"checkbox",id:"avoidDuplicates","onUpdate:modelValue":e[10]||(e[10]=a=>t.avoidDuplicates=a)},null,512),[[Ye,t.avoidDuplicates]]),e[32]||(e[32]=r("label",{for:"avoidDuplicates"},"避免重复画师",-1))]),r("div",lm,[B(r("input",{type:"checkbox",id:"fixedWeight","onUpdate:modelValue":e[11]||(e[11]=a=>t.fixedWeight=a)},null,512),[[Ye,t.fixedWeight]]),e[33]||(e[33]=r("label",{for:"fixedWeight"},"使用固定权重",-1))]),t.fixedWeight?(v(),h("div",am,[e[34]||(e[34]=r("label",null,"固定权重值",-1)),r("div",cm,[B(r("input",{type:"range",min:"0.1",max:"2",step:"0.1","onUpdate:modelValue":e[12]||(e[12]=a=>t.fixedWeightValue=a),class:"slider"},null,512),[[Ee,t.fixedWeightValue]]),r("span",um,_(t.fixedWeightValue),1)])])):x("",!0),r("div",dm,[r("label",null,"权重添加频率（"+_(t.weightFrequency)+"%）",1),r("div",fm,[B(r("input",{type:"range",min:"10",max:"100",step:"10","onUpdate:modelValue":e[13]||(e[13]=a=>t.weightFrequency=a),class:"slider"},null,512),[[Ee,t.weightFrequency]]),r("span",gm,_(t.weightFrequency)+"%",1)]),e[35]||(e[35]=r("div",{class:"setting-description"},"设置每个标签添加权重的概率，100%表示全部添加，10%表示每个标签有10%的概率添加权重",-1))]),r("div",pm,[B(r("input",{type:"checkbox",id:"useCustomFormat","onUpdate:modelValue":e[14]||(e[14]=a=>t.useCustomFormat=a)},null,512),[[Ye,t.useCustomFormat]]),e[36]||(e[36]=r("label",{for:"useCustomFormat"},"使用自定义格式",-1))]),t.useCustomFormat?(v(),h("div",vm,[e[38]||(e[38]=r("label",null,"自定义格式",-1)),B(r("select",{"onUpdate:modelValue":e[15]||(e[15]=a=>t.customFormat=a),class:"form-select"},e[37]||(e[37]=[r("option",{value:"brackets"},"(artist:weight)",-1),r("option",{value:"colon"},"artist:weight",-1),r("option",{value:"space"},"artist weight",-1),r("option",{value:"only"},"artist",-1)]),512),[[Ne,t.customFormat]])])):x("",!0)])]),r("div",ym,[r("button",{onClick:e[16]||(e[16]=(...a)=>t.generateArtists&&t.generateArtists(...a)),class:"primary-button",disabled:t.isGenerating},[t.isGenerating?(v(),h("span",mm)):(v(),h("span",bm,"🎲")),Ge(" "+_(t.isGenerating?"生成中...":"生成"),1)],8,hm),r("button",{onClick:e[17]||(e[17]=(...a)=>t.copyToClipboard&&t.copyToClipboard(...a)),class:"secondary-button",disabled:!t.result},e[40]||(e[40]=[r("span",{class:"button-icon"},"📋",-1),Ge(" 复制 ")]),8,$m),r("button",{onClick:e[18]||(e[18]=(...a)=>t.showArtistLibrary&&t.showArtistLibrary(...a)),class:"accent-button",disabled:t.isLoadingArtists},[t.isLoadingArtists?(v(),h("span",Cm)):(v(),h("span",Tm,"🎨")),Ge(" "+_(t.isLoadingArtists?"加载中...":"画师库"),1)],8,wm)])])],2),r("div",{class:ae(["result-panel",{mobile:t.isMobile}])},[r("div",_m,[e[43]||(e[43]=r("h3",{class:"panel-title"},"生成结果",-1)),t.result?(v(),h("div",Lm,[r("button",{onClick:e[19]||(e[19]=(...a)=>t.clearResult&&t.clearResult(...a)),class:"action-button",title:"清空结果"},e[42]||(e[42]=[r("span",{class:"action-icon"},"🗑️",-1)]))])):x("",!0)]),r("div",{class:ae(["result-content",{empty:!t.result}])},[t.result?(v(),h(Q,{key:0},[Ge(_(t.result),1)],64)):(v(),h("div",Sm,e[44]||(e[44]=[r("span",null,'点击"生成"按钮生成画师权重组合',-1)])))],2)],2)]),t.showModal?(v(),h("div",{key:0,class:"modal",onClick:e[24]||(e[24]=Mt((...a)=>t.closeModal&&t.closeModal(...a),["self"]))},[r("div",{class:ae(["modal-content",{mobile:t.isMobile}])},[r("div",km,[r("h2",null,"画师库 - "+_(t.selectedLibrary),1),r("div",Em,[t.filteredArtists.length?(v(),h("span",Am,"共 "+_(t.filteredArtists.length)+" 个画师",1)):x("",!0),r("button",{class:"close-button",onClick:e[20]||(e[20]=(...a)=>t.closeModal&&t.closeModal(...a)),title:"关闭"},"×")])]),r("div",Im,[r("div",Mm,[e[45]||(e[45]=r("label",null,"选择库:",-1)),B(r("select",{"onUpdate:modelValue":e[21]||(e[21]=a=>t.selectedLibrary=a),class:"modal-select",onChange:e[22]||(e[22]=(...a)=>t.handleLibraryChange&&t.handleLibraryChange(...a))},[(v(!0),h(Q,null,ge(t.availableLibraries,a=>(v(),h("option",{key:a,value:a},_(a),9,Om))),128))],544),[[Ne,t.selectedLibrary]])]),t.recentLibraries.length?(v(),h("div",Dm,[r("div",Pm,[(v(!0),h(Q,null,ge(t.recentLibraries,a=>(v(),h("button",{key:a,onClick:c=>t.selectLibrary(a),class:ae(["library-chip",{active:t.selectedLibrary===a}])},_(a),11,Hm))),128))])])):x("",!0)]),r("div",Rm,[B(r("input",{type:"text",class:"search-input",placeholder:"搜索画师...","onUpdate:modelValue":e[23]||(e[23]=a=>t.searchQuery=a)},null,512),[[Ee,t.searchQuery]]),e[46]||(e[46]=r("span",{class:"search-icon"},"🔍",-1))]),r("div",Nm,[t.filteredArtists.length?(v(!0),h(Q,{key:0},ge(t.filteredArtists,(a,c)=>(v(),h("span",{key:c,class:"artist-item",onClick:u=>t.addArtistToResult(a)},_(a),9,jm))),128)):t.isLoadingArtists||t.isLoadingLibrary?(v(),h("div",Fm,e[47]||(e[47]=[r("div",{class:"loading-spinner"},null,-1),r("span",null,"加载中...",-1)]))):(v(),h("div",Um,[t.searchQuery?(v(),h("span",Bm,'未找到匹配"'+_(t.searchQuery)+'"的画师',1)):(v(),h("span",Vm,"画师库为空或正在加载中..."))]))],512)],2)])):x("",!0)])}const Hn=_e(Ah,[["render",Jm],["__scopeId","data-v-23254a1e"]]);const Km=He({name:"ToolkitPanel",components:{WeightAdder:Hn},setup(){const t=$([{name:"权重添加器",description:"生成AI画师权重组合，快速创建绘画风格提示词",icon:"🎨",component:rr(Hn)}]),e=$(null),s=$(null);return{tools:t,activeTool:e,activeToolComponent:s,activateTool:l=>{e.value=l,s.value=l.component},closeActiveTool:()=>{e.value=null,s.value=null}}}}),zm={class:"toolkit-panel"},Wm={class:"toolkit-content"},Gm={class:"toolkit-grid"},Ym=["onClick"],qm={class:"tool-icon"},Qm={class:"tool-info"},Zm={class:"tool-title"},Xm={class:"tool-description"},xm={key:0,class:"active-tool-container"},eb={class:"active-tool-header"};function tb(t,e,s,n,i,l){return v(),h("div",zm,[e[1]||(e[1]=r("div",{class:"section-header"},[r("h3",{class:"panel-title"},"扩展工具箱"),r("div",{class:"toolkit-description"},"集成多种辅助创作的实用工具")],-1)),r("div",Wm,[r("div",Gm,[(v(!0),h(Q,null,ge(t.tools,(o,a)=>(v(),h("div",{key:a,class:"tool-card",onClick:c=>t.activateTool(o)},[r("div",qm,_(o.icon),1),r("div",Qm,[r("h4",Zm,_(o.name),1),r("div",Xm,_(o.description),1)])],8,Ym))),128))])]),t.activeToolComponent?(v(),h("div",xm,[r("div",eb,[r("h3",null,_(t.activeTool.name),1),r("button",{class:"close-button",onClick:e[0]||(e[0]=(...o)=>t.closeActiveTool&&t.closeActiveTool(...o))},"×")]),(v(),It(tl(t.activeToolComponent)))])):x("",!0)])}const sb=_e(Km,[["render",tb],["__scopeId","data-v-0a5446ee"]]);const ob=He({name:"HomeView",components:{DrawerPanel:Vc,HistoryPanel:pu,SettingsPanel:Sf,InfoPanel:Hf,TagLibraryPanel:sh,NotificationSystem:vh,ToolkitPanel:sb},setup(){const t=ye("emitter"),e=$(0),s=$(localStorage.getItem("darkMode")==="true"),n=[{name:"抽签工具"},{name:"标签库管理"},{name:"工具箱"},{name:"设置"},{name:"关于"}],i=()=>{s.value=!s.value,localStorage.setItem("darkMode",s.value),t.emit("settings-changed",{darkMode:s.value})};return Ke(()=>{s.value?document.body.classList.add("dark-mode"):document.body.classList.remove("dark-mode"),t.on("settings-changed",l=>{l.darkMode!==void 0&&(s.value=l.darkMode,l.darkMode?document.body.classList.add("dark-mode"):document.body.classList.remove("dark-mode"))})}),{activeTabIndex:e,isDarkMode:s,tabs:n,toggleDarkMode:i}}}),nb={class:"app-header"},rb={class:"nav-controls"},ib={key:0},lb={key:1},ab={class:"main-container"},cb={class:"left-menu"},ub=["onClick"],db={class:"right-content"},fb={class:"page-content"},gb={class:"draw-tool-container"},pb={class:"history-section"},vb={class:"history-content"},yb={class:"page-content"},hb={class:"page-content"},mb={class:"page-content"},bb={class:"settings-page-content"},$b={class:"page-content"},wb={class:"about-page-content"};function Cb(t,e,s,n,i,l){const o=ke("drawer-panel"),a=ke("history-panel"),c=ke("tag-library-panel"),u=ke("toolkit-panel"),d=ke("settings-panel"),g=ke("info-panel"),p=ke("notification-system");return v(),h("div",{class:ae(["app-wrapper",{"dark-mode":t.isDarkMode}])},[r("header",nb,[e[1]||(e[1]=r("div",{class:"logo"},[r("h1",null,"灵感提供机 - 分类Tag抽签工具"),r("div",{class:"subtitle"},"激发创意，打破思维定式")],-1)),r("div",rb,[r("button",{class:"theme-toggle",onClick:e[0]||(e[0]=(...m)=>t.toggleDarkMode&&t.toggleDarkMode(...m))},[t.isDarkMode?(v(),h("span",ib,"☀️")):(v(),h("span",lb,"🌙"))])])]),r("div",ab,[r("div",cb,[(v(!0),h(Q,null,ge(t.tabs,(m,T)=>(v(),h("div",{key:T,class:ae(["menu-item",{active:t.activeTabIndex===T}]),onClick:k=>t.activeTabIndex=T},_(m.name),11,ub))),128))]),r("div",db,[B(r("div",fb,[r("div",gb,[be(o)]),r("div",pb,[e[2]||(e[2]=r("div",{class:"section-header"},[r("h3",{class:"panel-title"},"历史记录")],-1)),r("div",vb,[be(a)])])],512),[[us,t.activeTabIndex===0]]),B(r("div",yb,[be(c)],512),[[us,t.activeTabIndex===1]]),B(r("div",hb,[be(u)],512),[[us,t.activeTabIndex===2]]),B(r("div",mb,[r("div",bb,[be(d)])],512),[[us,t.activeTabIndex===3]]),B(r("div",$b,[r("div",wb,[be(g)])],512),[[us,t.activeTabIndex===4]])])]),be(p)],2)}const Tb=_e(ob,[["render",Cb],["__scopeId","data-v-2a67235c"]]);const _b=He({name:"LibraryStatusBar",components:{LibrarySelector:qr},setup(){const t=ye("tagLibrary"),e=ye("emitter"),s=$(!1),n=$(""),i=$(null),l=()=>{try{if(!t)return;const u=t.getCurrentLibraryName();n.value=u;const d=t.getTagCountByLibrary?t.getTagCountByLibrary(u):t.getAllTags?t.getAllTags(u).length:0,g=t.getCategories?t.getCategories(u):[],p=Array.isArray(g)?g.length:0;i.value={name:u,count:d,categoryCount:p}}catch(u){console.error("加载当前库信息失败:",u),i.value=null}},o=()=>{e.emit("open-panel","tag-library")},a=async()=>{if(!s.value){s.value=!0;try{await new Promise(u=>setTimeout(u,800)),l(),e.emit("notification",{type:"success",message:`${n.value} 库已刷新`})}catch(u){console.error("刷新库数据失败:",u),e.emit("notification",{type:"error",message:"刷新库数据失败"})}finally{s.value=!1}}},c=u=>{u!==n.value&&(n.value=u,l())};return Ke(()=>{l(),e.on("library-changed",c)}),Yt(()=>{e.off("library-changed",c)}),{currentLibraryInfo:i,isRefreshing:s,openLibraryManager:o,refreshLibrary:a}}}),Lb={class:"library-status-bar"},Sb={class:"status-content"},kb={class:"library-info"},Eb={key:0,class:"library-stats"},Ab={class:"stat-item"},Ib={class:"stat-value"},Mb={key:0,class:"stat-item"},Ob={class:"stat-value"},Db={class:"action-buttons"};function Pb(t,e,s,n,i,l){const o=ke("library-selector");return v(),h("div",Lb,[r("div",Sb,[r("div",kb,[e[2]||(e[2]=r("span",{class:"library-label"},"当前库:",-1)),be(o,{class:"library-selector"})]),t.currentLibraryInfo?(v(),h("div",Eb,[r("div",Ab,[e[3]||(e[3]=r("span",{class:"stat-icon"},"📚",-1)),r("span",Ib,_(t.currentLibraryInfo.count),1),e[4]||(e[4]=r("span",{class:"stat-label"},"标签",-1))]),t.currentLibraryInfo.categoryCount!==void 0?(v(),h("div",Mb,[e[5]||(e[5]=r("span",{class:"stat-icon"},"📂",-1)),r("span",Ob,_(t.currentLibraryInfo.categoryCount),1),e[6]||(e[6]=r("span",{class:"stat-label"},"分类",-1))])):x("",!0)])):x("",!0),r("div",Db,[r("button",{class:"action-btn",title:"管理标签库",onClick:e[0]||(e[0]=(...a)=>t.openLibraryManager&&t.openLibraryManager(...a))},e[7]||(e[7]=[r("span",{class:"btn-icon"},"⚙️",-1)])),r("button",{class:ae(["action-btn",{"is-loading":t.isRefreshing}]),title:"刷新库数据",onClick:e[1]||(e[1]=(...a)=>t.refreshLibrary&&t.refreshLibrary(...a))},e[8]||(e[8]=[r("span",{class:"btn-icon"},"🔄",-1)]),2)])])])}const Hb=_e(_b,[["render",Pb],["__scopeId","data-v-fe2847d1"]]);const Rb=He({name:"App",components:{HomeView:Tb,LibraryStatusBar:Hb},setup(){const t=$(!1),e=ye("emitter"),s=$(!0),n=(l,o)=>{let a=parseInt(l.substr(1,2),16),c=parseInt(l.substr(3,2),16),u=parseInt(l.substr(5,2),16);return a=Math.floor(a*(100-o)/100),c=Math.floor(c*(100-o)/100),u=Math.floor(u*(100-o)/100),"#"+((1<<24)+(a<<16)+(c<<8)+u).toString(16).slice(1)},i=(l,o)=>{let a=parseInt(l.substr(1,2),16),c=parseInt(l.substr(3,2),16),u=parseInt(l.substr(5,2),16);return a=Math.floor(a+(255-a)*o/100),c=Math.floor(c+(255-c)*o/100),u=Math.floor(u+(255-u)*o/100),"#"+((1<<24)+(a<<16)+(c<<8)+u).toString(16).slice(1)};return Ke(()=>{t.value=localStorage.getItem("dark_mode")==="true";const l=localStorage.getItem("user_font_size");if(l){const a=parseInt(l),c=document.documentElement;c.style.setProperty("--font-size-base",`${a}px`),c.style.setProperty("--font-size-xs",`${a*.85}px`),c.style.setProperty("--font-size-sm",`${a*.95}px`),c.style.setProperty("--font-size-md",`${a}px`),c.style.setProperty("--font-size-lg",`${a*1.2}px`),c.style.setProperty("--font-size-xl",`${a*1.5}px`)}e.on("font-size-changed",a=>{const c=parseInt(a),u=document.documentElement;u.style.setProperty("--font-size-base",`${c}px`),u.style.setProperty("--font-size-xs",`${c*.85}px`),u.style.setProperty("--font-size-sm",`${c*.95}px`),u.style.setProperty("--font-size-md",`${c}px`),u.style.setProperty("--font-size-lg",`${c*1.2}px`),u.style.setProperty("--font-size-xl",`${c*1.5}px`),localStorage.setItem("user_font_size",c.toString())});const o=localStorage.getItem("user_theme_color");if(o){document.documentElement.style.setProperty("--primary-color",o);const a=n(o,15),c=i(o,85);document.documentElement.style.setProperty("--primary-hover-color",a),document.documentElement.style.setProperty("--primary-color-light",c),document.documentElement.style.setProperty("--action-color",o),document.documentElement.style.setProperty("--action-hover-color",a)}t.value&&document.body.classList.add("dark-mode"),e.on("settings-updated",a=>{a&&a.darkMode!==void 0&&(t.value=a.darkMode,t.value?document.body.classList.add("dark-mode"):document.body.classList.remove("dark-mode"))})}),{isDarkMode:t,showLibraryBar:s}}});function Nb(t,e,s,n,i,l){const o=ke("home-view"),a=ke("library-status-bar");return v(),h("div",{id:"app",class:ae({"dark-mode":t.isDarkMode})},[be(o),t.showLibraryBar?(v(),It(a,{key:0,class:"library-status-bar"})):x("",!0)],2)}const Rn=_e(Rb,[["render",Nb]]);const he={DEFAULTS:{LIBRARY_NAME:"default"},STORAGE_KEYS:{TAG_LIBRARIES:"tag_libraries",CURRENT_LIBRARY_NAME:"current_library_name",HISTORY:"drawn_history"}};class jb{constructor(e={},s=null){this.libraries={},this.currentLibraryName=he.DEFAULTS.LIBRARY_NAME,this.drawnHistory=[],this.emitter=s,this.categoryCache=new Map,this.libraryMetadata={},this.chunkedLibraries=new Set,this.pendingCategoryLoads=new Map,this._init()}_init(){try{this._loadLibraryMetadata(),Object.keys(this.libraries).length===0&&fetch("/default.json").then(e=>e.json()).then(e=>{this.libraries={default:e},this.currentLibraryName="default",this._saveToStorage()}).catch(e=>{console.error("加载默认标签库失败:",e),this.libraries={default:{}},this.currentLibraryName="default",this._saveToStorage()}),this.libraries.默认标签库&&(delete this.libraries.默认标签库,this._saveToStorage()),this.libraries[this.currentLibraryName]||(this.currentLibraryName="default",this._saveToStorage())}catch(e){console.error("初始化标签库失败:",e),this.emitter&&this.emitter.emit("notification",{type:"error",message:"初始化标签库失败: "+e.message})}}_loadLibraryMetadata(){try{localStorage.getItem(`${he.STORAGE_KEYS.TAG_LIBRARIES}_mode`)==="chunked"?(console.log("使用分块存储模式加载标签库元数据"),this._loadChunkedLibraryMetadata()):(console.log("使用常规存储模式加载标签库数据"),this._loadFromStorage())}catch(e){console.error("加载库元数据失败:",e),this.libraries={},this.libraries[he.DEFAULTS.LIBRARY_NAME]=this.exampleTags,this.currentLibraryName=he.DEFAULTS.LIBRARY_NAME,this.drawnHistory=[]}}_loadChunkedLibraryMetadata(){console.log("尝试从分块存储加载数据");try{const s=localStorage.getItem(he.STORAGE_KEYS.HISTORY);if(s)try{const n=JSON.parse(s);Array.isArray(n)?(this.drawnHistory=n,console.log("分块存储: 从HISTORY键加载历史记录成功，数量:",this.drawnHistory.length)):(console.warn("分块存储: HISTORY键中的数据不是数组"),this.drawnHistory=[])}catch(n){console.error("分块存储: 解析HISTORY键数据失败:",n),this.drawnHistory=[]}else{console.log("分块存储: HISTORY键中没有数据，尝试从备份加载");const n=localStorage.getItem(`${he.STORAGE_KEYS.TAG_LIBRARIES}_history`);if(n)try{const{drawnHistory:i}=JSON.parse(n);Array.isArray(i)?(this.drawnHistory=i,console.log("分块存储: 从备份加载历史记录成功，数量:",this.drawnHistory.length),localStorage.setItem(he.STORAGE_KEYS.HISTORY,JSON.stringify(this.drawnHistory))):(console.warn("分块存储: 备份中的历史记录不是数组"),this.drawnHistory=[])}catch(i){console.error("分块存储: 解析备份历史记录失败:",i),this.drawnHistory=[]}else console.log("分块存储: 没有找到历史记录数据，使用空数组"),this.drawnHistory=[]}}catch(s){console.error("分块存储: 加载历史记录失败:",s),this.drawnHistory=[]}const e=localStorage.getItem(`${he.STORAGE_KEYS.TAG_LIBRARIES}_libNames`);if(!e)return console.warn("未找到库名列表，切换回非分块模式"),this._loadFromStorage();try{const{libraryNames:s}=JSON.parse(e),n=localStorage.getItem(`${he.STORAGE_KEYS.TAG_LIBRARIES}_meta`);if(n){const{currentLibraryName:i}=JSON.parse(n);this.currentLibraryName=i||he.DEFAULTS.LIBRARY_NAME}else this.currentLibraryName=he.DEFAULTS.LIBRARY_NAME;for(const i of s)this.libraries[i]=null,this.chunkedLibraries.add(i),this._loadLibraryCategoriesMetadata(i);return this.libraries[he.DEFAULTS.LIBRARY_NAME]||(this.libraries[he.DEFAULTS.LIBRARY_NAME]=this.exampleTags),this.libraries[this.currentLibraryName]||(this.currentLibraryName=he.DEFAULTS.LIBRARY_NAME),console.log("分块存储数据加载完成"),!0}catch(s){return console.error("解析分块存储元数据失败:",s),this._loadFromStorage()}}_loadLibraryCategoriesMetadata(e){try{const s=localStorage.getItem(`${he.STORAGE_KEYS.TAG_LIBRARIES}_lib_${e}_categories`);if(s){const{categories:n}=JSON.parse(s);if(this.libraryMetadata[e]||(this.libraryMetadata[e]={}),this.libraryMetadata[e].categories=n,this.libraries[e]===null){this.libraries[e]={};for(const i of n)this.libraries[e][i]=null}}}catch(s){console.error(`加载库 "${e}" 分类元数据失败:`,s)}}async _loadCategoryOnDemand(e,s){const n=`${e}:${s}`;if(this.categoryCache.has(n))return this.categoryCache.get(n);if(this.pendingCategoryLoads.has(n))return this.pendingCategoryLoads.get(n);const i=new Promise((l,o)=>{try{if(this.chunkedLibraries.has(e)){const a=localStorage.getItem(`${he.STORAGE_KEYS.TAG_LIBRARIES}_lib_${e}_cat_${s}`);if(a){const{tags:c}=JSON.parse(a);this.libraries[e]&&(this.libraries[e][s]=c),this.categoryCache.set(n,c),l(c)}else{const c=[];this.categoryCache.set(n,c),l(c)}}else if(this.libraries[e]&&this.libraries[e][s]){const a=this.libraries[e][s];this.categoryCache.set(n,a),l(a)}else{const a=[];this.categoryCache.set(n,a),l(a)}}catch(a){console.error(`加载分类 "${s}" 失败:`,a),o(a)}finally{this.pendingCategoryLoads.delete(n)}});return this.pendingCategoryLoads.set(n,i),i}getCategories(e=null){const s=e||this.currentLibraryName;if(this.libraryMetadata[s]&&this.libraryMetadata[s].categories)return[...this.libraryMetadata[s].categories];const n=this.libraries[s];return n?n===null?[]:Object.keys(n):[]}async getCategoryTags(e,s=null){const n=s||this.currentLibraryName;if(!this.libraries[n])return[];if(this.libraries[n]&&typeof this.libraries[n]=="object"&&e in this.libraries[n])if(this.libraries[n][e]===null||this.chunkedLibraries.has(n)&&!Array.isArray(this.libraries[n][e]))try{return await this._loadCategoryOnDemand(n,e)||[]}catch(i){return console.error(`获取分类 "${e}" 的标签失败:`,i),[]}else return this.libraries[n][e]||[];return[]}async preloadLibrary(e=null){const s=e||this.currentLibraryName;if(!this.libraries[s])return;const n=this.getCategories(s),i=3;for(let l=0;l<n.length;l+=i){const o=n.slice(l,l+i);await Promise.all(o.map(a=>this._loadCategoryOnDemand(s,a))),l+i<n.length&&await new Promise(a=>setTimeout(a,50))}console.log(`库 "${s}" 预加载完成`)}async setCurrentLibrary(e){return this.libraries[e]?(this.currentLibraryName=e,this.chunkedLibraries.has(e)&&(this._loadLibraryCategoriesMetadata(e),setTimeout(()=>{this.preloadLibrary(e).catch(s=>console.error(`预加载库 "${e}" 失败:`,s))},100)),this._saveToStorage(),!0):!1}_loadFromStorage(){try{try{const s=localStorage.getItem(he.STORAGE_KEYS.HISTORY);s?(this.drawnHistory=JSON.parse(s),console.log("从单独存储加载历史记录成功，数量:",this.drawnHistory.length)):this.drawnHistory=[]}catch(s){console.error("从单独存储加载历史记录失败:",s),this.drawnHistory=[]}const e=localStorage.getItem(he.STORAGE_KEYS.TAG_LIBRARIES);if(e){const s=JSON.parse(e);if(this.libraries=s.libraries||{},this.libraries.默认标签库&&delete this.libraries.默认标签库,this.libraries.default||fetch("/default.json").then(n=>n.json()).then(n=>{this.libraries.default=n,this._saveToStorage()}).catch(n=>{console.error("加载默认标签库失败:",n),this.libraries.default={},this._saveToStorage()}),this.currentLibraryName=s.currentLibraryName||"default",this.libraries[this.currentLibraryName]||(this.currentLibraryName="default"),(!this.drawnHistory||this.drawnHistory.length===0)&&s.drawnHistory){this.drawnHistory=s.drawnHistory,console.log("从主数据中恢复历史记录，数量:",this.drawnHistory.length);try{localStorage.setItem(he.STORAGE_KEYS.HISTORY,JSON.stringify(this.drawnHistory))}catch(n){console.error("将恢复的历史记录保存到单独存储失败:",n)}}}else fetch("/default.json").then(s=>s.json()).then(s=>{this.libraries={default:s},this.currentLibraryName="default",this.drawnHistory=[],this._saveToStorage()}).catch(s=>{console.error("加载默认标签库失败:",s),this.libraries={default:{}},this.currentLibraryName="default",this.drawnHistory=[],this._saveToStorage()});return this._saveToStorage(),this.emitter&&this.emitter.emit("tagLibraryUpdated"),!0}catch(e){return console.error("加载标签库数据失败:",e),this.emitter&&this.emitter.emit("notification",{type:"error",message:"加载标签库数据失败: "+e.message}),fetch("/default.json").then(s=>s.json()).then(s=>{this.libraries={default:s},this.currentLibraryName="default",this.drawnHistory=[],this._saveToStorage()}).catch(s=>{console.error("加载默认标签库失败:",s),this.libraries={default:{}},this.currentLibraryName="default",this.drawnHistory=[],this._saveToStorage()}),!1}}_saveToStorage(){try{console.time("保存标签库数据到存储");try{this.drawnHistory&&Array.isArray(this.drawnHistory)&&(localStorage.setItem(he.STORAGE_KEYS.HISTORY,JSON.stringify(this.drawnHistory)),console.log("历史记录已单独保存，数量:",this.drawnHistory.length))}catch(i){console.error("保存历史记录失败:",i)}const e={libraries:this.libraries,currentLibraryName:this.currentLibraryName};this._updateRecentLibraries(this.currentLibraryName);const s=JSON.stringify(e),n=new Blob([s]).size/(1024*1024);return n>4?(console.warn(`标签库数据较大 (${n.toFixed(2)}MB)，正在尝试优化存储...`),this._optimizeStorage(e)):localStorage.setItem(he.STORAGE_KEYS.TAG_LIBRARIES,s),console.timeEnd("保存标签库数据到存储"),this._notifyLibraryUpdated(),!0}catch(e){if(console.error("保存标签库数据到存储失败:",e),e.name==="QuotaExceededError"||e.name==="NS_ERROR_DOM_QUOTA_REACHED"){console.warn("存储空间不足，尝试优化存储...");try{const s={libraries:this.libraries,currentLibraryName:this.currentLibraryName};return this._optimizeStorage(s),this._notifyLibraryUpdated(),!0}catch(s){console.error("存储优化失败:",s)}}return typeof window<"u"&&window.dispatchEvent&&window.dispatchEvent(new CustomEvent("tagLibrary-save-error",{detail:{error:e.message}})),!1}}_notifyLibraryUpdated(){console.log("TagLibrary._notifyLibraryUpdated 被调用，准备发送更新通知"),this._lastUpdateTime=Date.now(),typeof window<"u"&&window.dispatchEvent?(this._updateTimer&&(console.log("TagLibrary: 清除之前的更新定时器"),clearTimeout(this._updateTimer)),this._updateTimer=setTimeout(()=>{const e=Date.now()-this._lastUpdateTime;if(e<450){console.log(`TagLibrary: 在防抖期间有新更新(${e}ms前)，跳过本次通知`);return}console.log("TagLibrary: 触发全局标签库更新事件 (延迟后)"),window.dispatchEvent(new CustomEvent("tagLibraryUpdated",{detail:{timestamp:Date.now()}})),this.emitter?(console.log("TagLibrary: 通过 emitter 发送 tagLibraryUpdated 事件"),this.emitter.emit("tagLibraryUpdated",{timestamp:Date.now()})):console.warn("TagLibrary: emitter 未定义，无法发送事件"),this._isLibraryModified=!0,this._updateTimer=null},500)):this.emitter?(console.log("TagLibrary: 在非浏览器环境通过 emitter 发送 tagLibraryUpdated 事件"),this._updateTimer&&clearTimeout(this._updateTimer),this._updateTimer=setTimeout(()=>{this.emitter.emit("tagLibraryUpdated",{timestamp:Date.now()}),this._updateTimer=null},500)):console.warn("TagLibrary: 无法发送更新通知，window.dispatchEvent 和 emitter 均不可用")}_optimizeStorage(e){console.log("开始执行存储优化");try{this.drawnHistory&&Array.isArray(this.drawnHistory)&&(localStorage.setItem(he.STORAGE_KEYS.HISTORY,JSON.stringify(this.drawnHistory)),console.log("分块存储: 历史记录已单独保存到HISTORY键"))}catch(s){console.error("分块存储: 保存历史记录失败:",s)}try{localStorage.setItem(`${he.STORAGE_KEYS.TAG_LIBRARIES}_history`,JSON.stringify({drawnHistory:this.drawnHistory})),console.log("分块存储: 历史记录已备份到TAG_LIBRARIES_history键")}catch(s){console.error("分块存储: 备份历史记录失败:",s)}localStorage.setItem(`${he.STORAGE_KEYS.TAG_LIBRARIES}_meta`,JSON.stringify({currentLibraryName:e.currentLibraryName}));for(const s in e.libraries)try{localStorage.setItem(`${he.STORAGE_KEYS.TAG_LIBRARIES}_lib_${s}`,JSON.stringify({library:e.libraries[s]}))}catch(n){console.error(`存储库 "${s}" 失败:`,n),(n.name==="QuotaExceededError"||n.name==="NS_ERROR_DOM_QUOTA_REACHED")&&this._storeLibraryInChunks(s,e.libraries[s])}localStorage.setItem(`${he.STORAGE_KEYS.TAG_LIBRARIES}_libNames`,JSON.stringify({libraryNames:Object.keys(e.libraries)})),localStorage.setItem(`${he.STORAGE_KEYS.TAG_LIBRARIES}_mode`,"chunked"),console.log("存储优化完成，使用分块存储模式")}_storeLibraryInChunks(e,s){const n=Object.keys(s);localStorage.setItem(`${he.STORAGE_KEYS.TAG_LIBRARIES}_lib_${e}_categories`,JSON.stringify({categories:n}));for(const i of n)try{localStorage.setItem(`${he.STORAGE_KEYS.TAG_LIBRARIES}_lib_${e}_cat_${i}`,JSON.stringify({tags:s[i]}))}catch(l){console.error(`存储分类 "${i}" 失败:`,l)}}_updateRecentLibraries(e){try{let s=[];const n=localStorage.getItem("recent_libraries");n&&(s=JSON.parse(n)),s=s.filter(i=>i!==e),s.unshift(e),s.length>5&&(s=s.slice(0,5)),localStorage.setItem("recent_libraries",JSON.stringify(s))}catch(s){console.error("更新最近使用的库记录失败:",s)}}getRecentLibraries(){try{const e=localStorage.getItem("recent_libraries");if(e)return JSON.parse(e).filter(n=>this.libraries[n])}catch(e){console.error("获取最近使用的库记录失败:",e)}return[]}getCurrentLibrary(){return this.libraries[this.currentLibraryName]||{}}getCurrentLibraryName(){return this.currentLibraryName}getLibraryNames(){return Object.keys(this.libraries).filter(e=>e!=="默认标签库").sort((e,s)=>e==="default"?-1:s==="default"?1:e.localeCompare(s))}getLibrary(e,s=!1){return s&&this._loadFromStorage(),this.libraries[e]||{}}addLibrary(e,s){return e&&s&&typeof s=="object"?(this.libraries[e]=s,this._saveToStorage(),!0):!1}setLibrary(e,s){return!e||!s||typeof s!="object"?!1:(this.libraries[e]=s,this._saveToStorage(),!0)}deleteLibrary(e){return e&&this.libraries[e]&&e!==he.DEFAULTS.LIBRARY_NAME?(delete this.libraries[e],this.currentLibraryName===e&&(this.currentLibraryName=he.DEFAULTS.LIBRARY_NAME),this._saveToStorage(),!0):!1}getCategories(){return Object.keys(this.getCurrentLibrary())}getTotalTagCount(){const e=this.getCurrentLibrary();let s=0;for(const n in e)Array.isArray(e[n])&&(s+=e[n].length);return s}getTagCountByLibrary(e){const s=this.libraries[e]||{};let n=0;for(const i in s)Array.isArray(s[i])&&(n+=s[i].length);return n}addToHistory(e,s={}){if(Array.isArray(e)&&e.length>0){console.log("添加历史记录，标签数量:",e.length);const n={id:`hist_${Date.now()}_${Math.floor(Math.random()*1e3)}`,timestamp:Date.now(),tags:e,libraryName:this.currentLibraryName,options:s};Array.isArray(this.drawnHistory)||(console.warn("历史记录不是数组，重置为空数组"),this.drawnHistory=[]),this.drawnHistory.unshift(n),console.log("添加后历史记录数量:",this.drawnHistory.length);const i=s.maxHistoryCount||20;this.drawnHistory.length>i&&(this.drawnHistory=this.drawnHistory.slice(0,i)),Array.isArray(this.drawnHistory)||(console.error("保存前发现drawnHistory不是数组，修正为空数组"),this.drawnHistory=[]);try{localStorage.setItem(he.STORAGE_KEYS.HISTORY,JSON.stringify(this.drawnHistory)),console.log("历史记录已直接保存到localStorage，键名:",he.STORAGE_KEYS.HISTORY)}catch(l){console.error("直接保存历史记录失败:",l)}if(this._saveToStorage(),console.log("正在发送历史记录更新通知"),typeof window<"u"&&window.dispatchEvent){const l=new CustomEvent("history-updated");window.dispatchEvent(l),console.log("已发送CustomEvent: history-updated")}return this.emitter?(this.emitter.emit("history-updated"),console.log("已通过emitter发送通知: history-updated")):console.warn("emitter不存在，无法发送事件通知"),console.log("历史记录添加完成"),!0}else return console.warn("添加历史记录失败：标签数组为空或无效"),!1}getHistory(){var e;if(console.log("获取历史记录，当前数量:",((e=this.drawnHistory)==null?void 0:e.length)||0),!this.drawnHistory||this.drawnHistory.length===0)try{console.log("尝试从localStorage加载历史记录，键名:",he.STORAGE_KEYS.HISTORY);const s=localStorage.getItem(he.STORAGE_KEYS.HISTORY);if(s){console.log("从localStorage找到历史数据，长度:",s.length);try{const n=JSON.parse(s);console.log("历史数据解析成功，条目数:",n.length),Array.isArray(n)?(this.drawnHistory=n,console.log("从localStorage重新加载历史记录成功，条目数:",this.drawnHistory.length)):(console.error("解析的历史记录不是数组，重置为空数组"),this.drawnHistory=[])}catch(n){console.error("解析历史记录数据失败:",n,"原始数据:",s),this.drawnHistory=[]}}else console.log("localStorage中没有找到历史记录数据"),this.drawnHistory=[]}catch(s){console.error("尝试重新加载历史记录失败:",s),this.drawnHistory=[]}if(!Array.isArray(this.drawnHistory))console.error("返回前发现drawnHistory仍然不是数组，修正为空数组"),this.drawnHistory=[];else{const s=this.drawnHistory.filter(n=>n&&typeof n=="object"&&Array.isArray(n.tags)&&n.tags.length>0);s.length!==this.drawnHistory.length&&(console.warn(`过滤掉了${this.drawnHistory.length-s.length}条无效的历史记录`),this.drawnHistory=s,this._saveToStorage())}return[...this.drawnHistory]}setHistory(e){Array.isArray(e)&&(this.drawnHistory=e,this._saveToStorage())}removeHistoryItem(e){if(!e)throw new Error("历史记录ID不能为空");const s=this.drawnHistory.length;return this.drawnHistory=this.drawnHistory.filter(n=>n.id!==e),this.drawnHistory.length<s?(this._saveToStorage(),typeof window<"u"&&window.dispatchEvent&&window.dispatchEvent(new CustomEvent("history-updated")),this.emitter&&this.emitter.emit("history-updated"),!0):!1}clearHistory(){try{return this.drawnHistory=[],this._saveToStorage(),typeof window<"u"&&window.dispatchEvent&&window.dispatchEvent(new CustomEvent("history-updated")),this.emitter&&this.emitter.emit("history-updated"),!0}catch(e){return console.error("清空历史记录失败:",e),!1}}isTagInHistory(e,s){return this.drawnHistory.some(n=>n.tags.some(i=>i.category===e&&i.tagContent===s))}getAllTags(e=null){const s=e?this.libraries[e]:this.getCurrentLibrary();if(!s)return[];const n=[];for(const i in s)Array.isArray(s[i])&&s[i].forEach(l=>{typeof l=="object"?l.content?n.push({category:i,content:l.content,subTitles:l.subTitles||[]}):l.text&&n.push({category:i,content:l.text,subTitles:l.subTitle?l.subTitle.split(","):[]}):n.push({category:i,content:l,subTitles:[]})});return n}getLibraries(){return Object.keys(this.libraries)}switchLibrary(e){return this.libraries[e]?(this.currentLibraryName=e,this._saveToStorage(),this._notifyLibraryUpdated(),!0):!1}createEmptyLibrary(e){if(!e)throw new Error("库名称不能为空");if(this.libraries[e])throw new Error(`库 "${e}" 已存在`);return this.libraries[e]={},this._saveToStorage(),!0}importLibrary(e,s){if(!e||!s)throw new Error("库名称和数据不能为空");if(this.libraries[e])throw new Error(`库 "${e}" 已存在`);this.libraries[e]=s,this._saveToStorage()}extendLibrary(e,s){if(!e||!s)throw new Error("库名称和数据不能为空");if(!this.libraries[e])throw new Error(`库 "${e}" 不存在`);const n=this.libraries[e];if(Array.isArray(s)){const i={};s.forEach(l=>{!l.category||!l.content||(i[l.category]||(i[l.category]=[]),i[l.category].push({content:l.content,subTitles:l.subTitles||[]}))});for(const l in i){n[l]||(n[l]=[]),Array.isArray(n[l])||(n[l]=[]);const o=new Set(n[l].map(a=>typeof a=="string"?a:a.content||a.text));i[l].forEach(a=>{o.has(a.content)||n[l].push(a)})}}else if(typeof s=="object"){for(const i in s)if(n[i]||(n[i]=[]),Array.isArray(n[i])||(n[i]=[]),Array.isArray(s[i])){const l=new Set(n[i].map(o=>typeof o=="string"?o:o.content||o.text));s[i].forEach(o=>{const a=typeof o=="string"?o:o.content||o.text;a&&!l.has(a)&&n[i].push(o)})}}this._saveToStorage()}renameLibrary(e,s){if(!e||!s)throw new Error("原库名称和新库名称不能为空");if(!this.libraries[e])throw new Error(`库 "${e}" 不存在`);if(this.libraries[s])throw new Error(`库 "${s}" 已存在`);return this.libraries[s]=this.libraries[e],delete this.libraries[e],this.currentLibraryName===e&&(this.currentLibraryName=s),this._saveToStorage(),!0}duplicateLibrary(e,s){if(!e||!s)throw new Error("源库名称和目标库名称不能为空");if(!this.libraries[e])throw new Error(`源库 "${e}" 不存在`);if(this.libraries[s])throw new Error(`目标库 "${s}" 已存在`);return this.libraries[s]=JSON.parse(JSON.stringify(this.libraries[e])),this._saveToStorage(),!0}mergeLibraries(e,s){if(!e||!s)throw new Error("源库名称和目标库名称不能为空");if(!this.libraries[e])throw new Error(`源库 "${e}" 不存在`);if(!this.libraries[s])throw new Error(`目标库 "${s}" 不存在`);return this.extendLibrary(s,this.libraries[e]),!0}cleanEmptyCategories(e=null){const s=e?this.libraries[e]:this.getCurrentLibrary(),n=e||this.currentLibraryName;if(!s)throw new Error(`库 "${n}" 不存在`);let i=0;for(const l in s)(!Array.isArray(s[l])||s[l].length===0)&&(delete s[l],i++);return i>0&&this._saveToStorage(),i}cleanDuplicateTags(e=null){const s=e?this.libraries[e]:this.getCurrentLibrary(),n=e||this.currentLibraryName;if(!s)throw new Error(`库 "${n}" 不存在`);let i=0;for(const l in s){if(!Array.isArray(s[l]))continue;const o=new Set,a=[];s[l].forEach(c=>{const u=typeof c=="string"?c:c.content||c.text;u&&!o.has(u)?(o.add(u),a.push(c)):i++}),s[l]=a}return i>0&&this._saveToStorage(),i}moveCategory(e,s,n=null){if(!e||!s)throw new Error("分类名称不能为空");const i=n?this.libraries[n]:this.getCurrentLibrary(),l=n||this.currentLibraryName;if(!i)throw new Error(`库 "${l}" 不存在`);if(!i[e]||!Array.isArray(i[e]))throw new Error(`分类 "${e}" 不存在或不是有效的标签数组`);return i[s]||(i[s]=[]),Array.isArray(i[s])||(i[s]=[]),i[s]=[...i[s],...i[e]],delete i[e],this._saveToStorage(),!0}removeTag(e,s,n=null){console.log("TagLibrary.removeTag 被调用:",{category:e,content:s,libraryName:n});const i=n||this.currentLibraryName,l=this.libraries[i];if(!l)return console.error(`移除标签失败: 库 "${i}" 不存在`),!1;if(!l[e]||!Array.isArray(l[e]))return console.error(`移除标签失败: 分类 "${e}" 不存在或不是数组`),!1;const o=l[e].length;return l[e]=l[e].filter(a=>typeof a=="string"?a!==s:(a.content||a.text||"")!==s),l[e].length<o?(console.log(`成功从分类 "${e}" 移除标签 "${s}"`),this._saveToStorage(),this._notifyLibraryUpdated(),!0):(console.log(`未能从分类 "${e}" 移除标签 "${s}"，可能不存在该标签`),!1)}addTag(e,s,n=null){console.log("TagLibrary.addTag 被调用:",{category:e,tag:s,libraryName:n});const i=n||this.currentLibraryName,l=this.libraries[i];if(!l)return console.error(`添加标签失败: 库 "${i}" 不存在`),!1;if(!l[e]||!Array.isArray(l[e]))return console.error(`添加标签失败: 分类 "${e}" 不存在或不是数组`),!1;let o=s;if(typeof s=="string")o={content:s,subTitles:[]};else if(!s||typeof s!="object")return console.error("添加标签失败: 标签必须是字符串或对象"),!1;if(!o.content&&o.content!=="")return console.error("添加标签失败: 标签对象缺少content属性"),!1;const a=o.content.trim();if(a==="")return console.error("添加标签失败: 标签内容不能为空"),!1;let c=[];return o.subTitles&&(Array.isArray(o.subTitles)?c=o.subTitles.filter(d=>d&&typeof d=="string"):typeof o.subTitles=="string"&&(c=o.subTitles.split(",").map(d=>d.trim()).filter(d=>d))),l[e].some(d=>typeof d=="string"?d===a:(d.content||d.text||"")===a)?(console.error(`添加标签失败: 分类 "${e}" 中已存在相同内容的标签`),!1):(l[e].push({content:a,subTitles:c}),console.log(`成功添加标签 "${a}" 到分类 "${e}"`),this._saveToStorage(),this._notifyLibraryUpdated(),!0)}addCategory(e,s){if(console.log("TagLibrary.addCategory 被调用:",{libraryName:e,categoryName:s}),!e||!s)throw console.error("添加分类失败: 库名称或分类名称为空"),new Error("库名称和分类名称不能为空");if(!this.libraries[e])throw console.error(`添加分类失败: 库 "${e}" 不存在`),new Error(`库 "${e}" 不存在`);if(this.libraries[e][s])throw console.error(`添加分类失败: 分类 "${s}" 已存在于库 "${e}" 中`),new Error(`分类 "${s}" 已存在于库 "${e}" 中`);return this.libraries[e][s]=[],console.log(`成功添加分类 "${s}" 到库 "${e}"`),this._saveToStorage(),this._notifyLibraryUpdated(),!0}renameCategory(e,s,n){if(console.log("TagLibrary.renameCategory 被调用:",{libraryName:e,oldCategoryName:s,newCategoryName:n}),!e||!s||!n)throw console.error("重命名分类失败: 库名称、原分类名称或新分类名称为空"),new Error("库名称、原分类名称和新分类名称不能为空");if(!this.libraries[e])throw console.error(`重命名分类失败: 库 "${e}" 不存在`),new Error(`库 "${e}" 不存在`);if(!this.libraries[e][s])throw console.error(`重命名分类失败: 分类 "${s}" 不存在于库 "${e}" 中`),new Error(`分类 "${s}" 不存在于库 "${e}" 中`);if(this.libraries[e][n])throw console.error(`重命名分类失败: 分类 "${n}" 已存在于库 "${e}" 中`),new Error(`分类 "${n}" 已存在于库 "${e}" 中`);return this.libraries[e][n]=this.libraries[e][s],delete this.libraries[e][s],console.log(`成功将分类 "${s}" 重命名为 "${n}" 在库 "${e}" 中`),this._saveToStorage(),this._notifyLibraryUpdated(),!0}deleteCategory(e,s){if(console.log("TagLibrary.deleteCategory 被调用:",{libraryName:e,categoryName:s}),!e||!s)throw console.error("删除分类失败: 库名称或分类名称为空"),new Error("库名称和分类名称不能为空");if(!this.libraries[e])throw console.error(`删除分类失败: 库 "${e}" 不存在`),new Error(`库 "${e}" 不存在`);if(!this.libraries[e][s])throw console.error(`删除分类失败: 分类 "${s}" 不存在于库 "${e}" 中`),new Error(`分类 "${s}" 不存在于库 "${e}" 中`);return delete this.libraries[e][s],console.log(`成功从库 "${e}" 中删除分类 "${s}"`),this._saveToStorage(),this._notifyLibraryUpdated(),!0}clearCache(e){if(e){for(const s of this.categoryCache.keys())s.startsWith(`${e}:`)&&this.categoryCache.delete(s);this.chunkedLibraries.has(e)&&this._loadLibraryCategoriesMetadata(e)}else{this.categoryCache.clear();for(const s of this.chunkedLibraries)this._loadLibraryCategoriesMetadata(s)}this._notifyLibraryUpdated()}hasEmitter(){const e=!!this.emitter;if(console.log("TagLibrary.hasEmitter 被调用, 结果:",e),e)try{this.emitter.emit("test",{message:"emitter 测试消息"}),console.log("成功通过 emitter 发送测试消息")}catch(s){console.error("通过 emitter 发送测试消息失败:",s)}return e}setLibraries(e,s=!0){return!e||typeof e!="object"?!1:(this.libraries=e,s&&this._saveToStorage(),!0)}}class Fb{constructor(e){this.tagLibrary=e,this.usageCount=this._loadUsageCount()}_loadUsageCount(){try{const e=localStorage.getItem("tagDrawer_usageCount");return e?JSON.parse(e):{}}catch(e){return console.error("加载标签使用统计失败:",e),{}}}_saveUsageCount(){try{localStorage.setItem("tagDrawer_usageCount",JSON.stringify(this.usageCount))}catch(e){console.error("保存标签使用统计失败:",e)}}_updateUsageCount(e){!e||!e.length||(e.forEach(s=>{const n=`${s.category}:${s.tagContent}`;this.usageCount[n]||(this.usageCount[n]=0),this.usageCount[n]++}),this._saveUsageCount())}async drawTags(e,s="all",n=[],i=!1,l={}){let o=[],a={};const c=l.library||this.tagLibrary.getCurrentLibraryName();if(!this.tagLibrary.getLibrary(c))return{success:!1,message:`找不到标签库 "${c}" 或该库为空`};const d=l.ensureEachCategory===!0&&Array.isArray(s)&&s.length>1;console.log("抽取参数:",{count:e,categoryType:Array.isArray(s)?"array":typeof s,categoryLength:Array.isArray(s)?s.length:0,ensureEachCategory:d,libraryName:c});try{if(s==="all"){const p=this.tagLibrary.getCategories(c);for(const m of p)await this._addTagsToPoolAsync(c,m,o,n,i)}else if(Array.isArray(s)&&s.length>0)for(const p of s)await this._addTagsToPoolAsync(c,p,o,n,i),d&&(a[p]=[],await this._addTagsToPoolAsync(c,p,a[p],n,i));else typeof s=="string"&&s!=="all"&&await this._addTagsToPoolAsync(c,s,o,n,i);if(o.length===0)return{success:!1,message:"没有可用的标签可抽取，请尝试更改分类或减少排除标签"};const g=[];if(d){console.log("执行多分类平衡抽取");const p=[];for(const T of s)(!a[T]||a[T].length===0)&&p.push(T);if(p.length>0)return{success:!1,message:`分类 "${p.join(", ")}" 中没有可用的标签可抽取`};for(const T of s)if(a[T]&&a[T].length>0){const k=Math.floor(Math.random()*a[T].length),Z=a[T][k];g.push(Z);for(let V=0;V<o.length;V++)if(o[V].category===Z.category&&o[V].tagContent===Z.tagContent){o.splice(V,1);break}}console.log(`已从${s.length}个分类中各抽取一个标签，当前已抽取标签数: ${g.length}`);const m=Math.max(0,e-g.length);m>0&&o.length>0&&(console.log(`继续从剩余标签池抽取${m}个标签`),this._drawRandomTags(o,g,m,l.useWeights===!0))}else{const p=Math.min(e,o.length);this._drawRandomTags(o,g,p,l.useWeights===!0)}return this._updateUsageCount(g),{success:!0,drawnTags:g}}catch(g){return console.error("抽取标签时发生错误:",g),{success:!1,message:`抽取失败: ${g.message}`}}}async _addTagsToPoolAsync(e,s,n,i,l){try{const o=await this.tagLibrary.getCategoryTags(s,e);if(!Array.isArray(o)||o.length===0)return;o.forEach(a=>{let c,u,d;typeof a=="object"?a.content?(c=a.content,u=a.subTitles||[],d=a.category||s):a.text&&(c=a.text,u=a.subTitle?a.subTitle.split(","):[],d=s):(c=a,u=[],d=s);const g=i.some(m=>c.toLowerCase().includes(m.toLowerCase())),p=l&&this.tagLibrary.isTagInHistory(d,c);!g&&!p&&n.push({category:d,tagContent:c,tagSubTitles:u})})}catch(o){throw console.error(`从分类 "${s}" 加载标签失败:`,o),o}}async draw(e={}){const s=e.count||3,n=e.category||"all",i=e.excludeKeywords||[],l=e.noDuplicates!==!1;console.log("TagDrawer.draw接收到的选项:",{count:s,category:n,excludeKeywordCount:i.length,noDuplicates:l,ensureEachCategory:e.ensureEachCategory});try{const o=await this.drawTags(s,n,i,l,e);if(!o.success)throw new Error(o.message);return o.drawnTags.map(a=>({category:a.category,content:a.tagContent,subTitles:a.tagSubTitles}))}catch(o){throw console.error("抽取标签失败:",o),o}}getHistory(){return this.tagLibrary.getHistory()}clearHistory(){this.tagLibrary.clearHistory()}removeHistoryItem(e){const s=this.getHistory();if(e>=0&&e<s.length)s.splice(e,1),this.tagLibrary.setHistory(s);else throw new Error("无效的历史记录索引")}_drawRandomTags(e,s,n,i){if(i){const l=e.map(o=>{const a=`${o.category}:${o.tagContent}`,c=this.usageCount[a]||0,u=Math.min(c*.2+1,5);return{tag:o,weight:u}});for(let o=0;o<n&&l.length!==0;o++){const a=l.reduce((d,g)=>d+g.weight,0);let c=Math.random()*a,u=0;for(let d=0;d<l.length;d++)if(c-=l[d].weight,c<=0){u=d;break}s.push(l[u].tag),l.splice(u,1)}}else for(let l=0;l<n&&e.length!==0;l++){const o=Math.floor(Math.random()*e.length);s.push(e[o]),e.splice(o,1)}}}class Ub{constructor(){this.basePath="/Inspiration-Provider/",console.log("当前部署的基础路径:",this.basePath)}async loadDefaultTags(){try{return await this._tryLoadJsonFile([`${this.basePath}default.json`,`${this.basePath}public/default.json`,"/default.json","/public/default.json","/Inspiration-Provider/default.json","/Inspiration-Provider/public/default.json"],"默认标签库")}catch(e){return console.error("加载默认标签库失败:",e),{}}}async loadArtistTags(){try{return await this._tryLoadJsonFile([`${this.basePath}artists.json`,`${this.basePath}public/artists.json`,"/artists.json","/public/artists.json","/Inspiration-Provider/artists.json","/Inspiration-Provider/public/artists.json"],"画师标签库")}catch(e){return console.error("加载画师标签库失败:",e),{}}}async loadLawTags(){try{return await this._tryLoadJsonFile([`${this.basePath}所长常规法典.json`,`${this.basePath}public/所长常规法典.json`,"/所长常规法典.json","/public/所长常规法典.json","/Inspiration-Provider/所长常规法典.json","/Inspiration-Provider/public/所长常规法典.json"],"所长常规法典")}catch(e){return console.error("加载所长常规法典失败:",e),{}}}async _tryLoadJsonFile(e,s){console.log(`尝试加载${s}...`);let n=null,i=!1,l=[];for(const a of e)try{if(console.log(`尝试从路径加载: ${a}`),n=await fetch(a,{cache:"no-cache"}),n.ok){console.log(`成功找到并加载: ${a}`),i=!0;break}else{const c=`状态码: ${n.status}`;console.warn(`无法从 ${a} 加载: ${c}`),l.push({path:a,error:c})}}catch(c){console.warn(`无法从 ${a} 加载: ${c.message}`),l.push({path:a,error:c.message})}if(!i||!n)return console.error(`所有${s}路径尝试均失败:`,l),s==="所长常规法典"||s==="默认标签库"?(console.log(`使用内置基本标签作为${s}备选...`),this._createBasicTags()):{};const o=await n.json();return console.log(`${s}加载成功`),o}_createBasicTags(){console.log("创建内置基本标签");const e={人物特质:[{content:"勇敢",subTitles:["无畏","坚强"]},{content:"聪明",subTitles:["智慧","机智"]},{content:"善良",subTitles:["仁慈","富有同情心"]},{content:"忠诚",subTitles:["忠实","可靠"]}],故事背景:[{content:"中世纪",subTitles:["城堡","骑士"]},{content:"未来世界",subTitles:["科技","太空"]},{content:"现代都市",subTitles:["城市","生活"]},{content:"奇幻世界",subTitles:["魔法","异域"]}],情节元素:[{content:"冒险",subTitles:["探索","挑战"]},{content:"爱情",subTitles:["浪漫","感情"]},{content:"神秘",subTitles:["谜团","悬疑"]},{content:"冲突",subTitles:["矛盾","对抗"]}],创作主题:[{content:"成长",subTitles:["蜕变","进步"]},{content:"自我发现",subTitles:["觉醒","领悟"]},{content:"友谊",subTitles:["情谊","互助"]},{content:"生存",subTitles:["求生","挣扎"]}]};return console.log("内置基本标签创建成功"),e}async loadExampleTags(){return this.loadDefaultTags()}}function Bb(t){return{all:t=t||new Map,on:function(e,s){var n=t.get(e);n?n.push(s):t.set(e,[s])},off:function(e,s){var n=t.get(e);n&&(s?n.splice(n.indexOf(s)>>>0,1):t.set(e,[]))},emit:function(e,s){var n=t.get(e);n&&n.slice().map(function(i){i(s)}),(n=t.get("*"))&&n.slice().map(function(i){i(e,s)})}}}console.log("应用初始化中...");const Ns=Bb();console.log("事件总线(mitt)已创建");const Vt=new jb({},Ns);async function Vb(){try{const t=new Ub,e=await t.loadDefaultTags(),s=await t.loadArtistTags(),n=await t.loadLawTags();console.log("所有预设标签库数据加载完成"),Vt.addLibrary("默认标签库",e),Vt.addLibrary("画师标签库",s),Vt.addLibrary("所长常规法典库",n),Vt.setCurrentLibrary("默认标签库");const i=new Fb(Vt);console.log("标签库和抽取器已初始化");const l=Pn(Rn);console.log("Vue应用实例已创建"),l.provide("emitter",Ns),l.provide("tagLibrary",Vt),l.provide("tagDrawer",i),console.log("所有依赖已注入到应用中"),window.addEventListener("history-updated",()=>{console.log("全局事件: history-updated 被触发")}),window.addEventListener("tags-drawn",()=>{console.log("全局事件: tags-drawn 被触发")});let o=!1;window.addEventListener("tagLibraryUpdated",()=>{if(o){console.log("全局事件: 忽略重复的 tagLibraryUpdated 事件");return}o=!0,console.log("全局事件: tagLibraryUpdated 被触发"),setTimeout(()=>{Ns.emit("tagLibraryUpdated"),o=!1},10)}),l.mount("#app"),console.log("应用已挂载到DOM")}catch(t){console.error("应用初始化失败:",t);const e=Pn(Rn);e.provide("emitter",Ns),e.provide("tagLibrary",Vt),e.mount("#app"),console.log("Vue应用已挂载(标签库数据加载失败)")}}Vb();
